<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-54137818-11"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-54137818-11', {'anonymize_ip': true});
</script>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Oxygen+Mono|Roboto+Slab:500,700&display=swap" rel="stylesheet">
    <meta property="og:title" content="JavalinVue Plugin - Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:site_name" content="Javalin">
    <meta property="og:url" content="https://javalin.io">
    <meta property="og:description" content="Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:image" content="https://javalin.io/img/javalin.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="liMtSlffOZROWLqoiOZdSx-luH9_Siq5-Ot6xqHZwq8">
    <title>
        JavalinVue Plugin - Javalin - A lightweight Java and Kotlin web framework
    </title>
    <meta name="description" content="Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <link rel="canonical" href="https://zugazagoitia.github.io/plugins/javalinvue">
    <link rel="shortcut icon" type="image/png" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/main.css">
    <style>/* Styles that affect the length of the document */
p code,
li code {
    font-size: 90%;
    letter-spacing: -0.5px;
    border: 1px solid #ccd;
    background: #f5f5f7;
    padding: 1px 3px;
}

.multitab-code pre {
    margin-top: 0;
    border-radius: 0 0 5px 5px;
}

.multitab-code div[data-tab] {
    display: none;
}

:target {
    scroll-margin-top: 108px;
}

.anchorjs-link {
    transition: all .25s linear;
  }
  
*:hover > .anchorjs-link {
    margin-left: -1.125em !important;
 }</style>
</head>
<body>
    <a id="fork-me" href="https://github.com/javalin/javalin" target="_blank">
    <img style="position:fixed;top:0;right:0;border:0;z-index:99999" src="data:image/png;base64,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" alt="Fork me on GitHub">
</a>
    <header class="top-nav-header">
        <nav class="width-limit">
            <a id="logo" href="/" aria-label="Javalin">
                <img src="/img/logo.svg" alt="Javalin">
            </a>
            <ul>
                <li><a href="/documentation">Docs</a></li>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/plugins">Plugins</a></li>
                <li><a href="/community">Community</a></li>
            </ul>
        </nav>
    </header>
    <main class="width-limit has-right-menu">
                <div id="spy-nav" class="right-menu">
  <ul>
    <li><a href="#how-does-it-work">How does it work?</a></li>
    <li><a href="#getting-started">Getting Started</a>
      <ul>
        <li><a href="#creating-a-layout">Creating a layout</a></li>
        <li><a href="#creating-a-component">Creating a component</a></li>
        <li><a href="#binding-to-a-route">Binding to a route</a></li>
      </ul>
    </li>
    <li><a href="#configuration-options">Configuration options</a>
      <ul>
        <li><a href="#rootdirectory">rootDirectory</a></li>
        <li><a href="#vueversion">vueVersion</a></li>
        <li><a href="#statefunction">stateFunction</a></li>
        <li><a href="#isdevfunction">isDevFunction</a></li>
        <li><a href="#optimizedependencies">optimizeDependencies</a></li>
        <li><a href="#cachecontrol">cacheControl</a></li>
      </ul>
    </li>
    <li><a href="#layout-macros">Layout macros</a>
      <ul>
        <li><a href="#cdnwebjar">@cdnWebjar</a></li>
      </ul>
    </li>
    <li><a href="#loadabledata">LoadableData</a></li>
    <li><a href="#good-to-know">Good to know</a>
      <ul>
        <li><a href="#local-state">Local state</a></li>
      </ul>
    </li>
  </ul>
</div>

<h1 class="no-margin-top">JavalinVue Plugin</h1>

<p>The JavalinVue plugin provides a very clever integration with <a href="https://vuejs.org/">Vue.js</a>.
As with most clever programming tricks, you will probably either love it or hate it.
These docs are only valid for Javalin 4.X.</p>

<h2 id="how-does-it-work">How does it work?</h2>
<p>The JavalinVue plugin is basically a very specialized templating engine.
It finds <code class="language-plaintext highlighter-rouge">.vue</code> (and optionally <code class="language-plaintext highlighter-rouge">.js</code> and <code class="language-plaintext highlighter-rouge">.css</code>) files and glues them together,
and serves it all as one big HTML file. You start by creating a layout file:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/webjars/vue/2.6.10/dist/vue.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;style&gt;</span><span class="k">@inlineFile</span><span class="p">(</span><span class="s1">"/vue/styles.css"</span><span class="p">)</span><span class="nt">&lt;/style&gt;</span> <span class="c">&lt;!-- You can inline specific js/css files --&gt;</span>
    @componentRegistration <span class="c">&lt;!-- JavalinVue will find required vue files and inline them here --&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;main</span> <span class="na">id=</span><span class="s">"main-vue"</span> <span class="na">v-cloak</span><span class="nt">&gt;</span>
    @routeComponent <span class="c">&lt;!-- Your route component will be inlined here (app.get("/my-page", VueComponent("my-page"))) --&gt;</span>
<span class="nt">&lt;/main&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span><span class="na">el</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#main-vue</span><span class="dl">"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div></div>

<p>When a user tries to access <code class="language-plaintext highlighter-rouge">/my-page</code> in their browser, JavalinVue will serve the following HTML:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/webjars/vue/2.6.10/dist/vue.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;style&gt;body</span><span class="p">{</span><span class="nl">background</span><span class="p">:</span><span class="no">red</span><span class="p">}</span><span class="nt">&lt;/style&gt;</span> <span class="c">&lt;!-- whatever was in styles.css --&gt;</span>
    <span class="c">&lt;!-- &lt;my-page&gt;&lt;/my-page&gt; component and all of its dependencies --&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;main</span> <span class="na">id=</span><span class="s">"main-vue"</span> <span class="na">v-cloak</span><span class="nt">&gt;</span>
    <span class="nt">&lt;my-page&gt;&lt;/my-page&gt;</span> <span class="c">&lt;!-- this was defined in app.get("/my-page", VueComponent("my-page")) --&gt;</span>
<span class="nt">&lt;/main&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span><span class="na">el</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#main-vue</span><span class="dl">"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div></div>

<p>You don’t need any frontend build tool (like Webpack, Parcel, Grunt, etc) – JavalinVue takes care of all that.
As a consequence import/export of ES modules is not needed (and not supported as of now).</p>

<p>There is a longer tutorial which includes the motivation behind creating this
integration, as well as some discussion about pros and cons:
<a href="/tutorials/simple-frontends-with-javalin-and-vue">/tutorials/simple-frontends-with-javalin-and-vue</a></p>

<h2 id="getting-started">Getting Started</h2>

<h3 id="creating-a-layout">Creating a layout</h3>

<p>Create a root directory for your vue files and place your <code class="language-plaintext highlighter-rouge">layout.html</code> in it.
By default, JavalinVue will look in <code class="language-plaintext highlighter-rouge">src/main/resources/vue</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>src
└───main
    └───resources
        └───vue
            └───layout.html
</code></pre></div></div>

<p>Your <code class="language-plaintext highlighter-rouge">layout.html</code> file will be responsible for initializing Vue and including all your dependencies.
The snippet below shows all the available macros (<code class="language-plaintext highlighter-rouge">@macroName</code>):</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"@cdnWebjar/vue/2.6.10/dist/vue.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;style&gt;</span><span class="k">@inlineFile</span><span class="p">(</span><span class="s1">"/vue/styles.css"</span><span class="p">)</span><span class="nt">&lt;/style&gt;</span> <span class="c">&lt;!-- always included --&gt;</span>
    <span class="nt">&lt;script&gt;</span><span class="p">@</span><span class="nd">inlineFileDev</span><span class="p">(</span><span class="dl">"</span><span class="s2">/vue/scripts-dev.js</span><span class="dl">"</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span> <span class="c">&lt;!-- only included in dev --&gt;</span>
    <span class="nt">&lt;script&gt;</span><span class="p">@</span><span class="nd">inlineFileNotDev</span><span class="p">(</span><span class="dl">"</span><span class="s2">/vue/scripts-not-dev.js</span><span class="dl">"</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span> <span class="c">&lt;!-- only included in not dev --&gt;</span>
    @componentRegistration <span class="c">&lt;!-- JavalinVue will find required vue files and inline them here --&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;main</span> <span class="na">id=</span><span class="s">"main-vue"</span> <span class="na">v-cloak</span><span class="nt">&gt;</span>
    @routeComponent <span class="c">&lt;!-- Your route component will be inlined here (app.get("/my-page", VueComponent("my-page"))) --&gt;</span>
<span class="nt">&lt;/main&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="k">new</span> <span class="nx">Vue</span><span class="p">({</span><span class="na">el</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#main-vue</span><span class="dl">"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</code></pre></div></div>

<h3 id="creating-a-component">Creating a component</h3>
<p>Components will be inlined where the <code class="language-plaintext highlighter-rouge">@componentRegistration</code> macro is present in your <code class="language-plaintext highlighter-rouge">layout.html</code>,
which means you have to register them as global Vue components:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"my-component"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="c">&lt;!-- Component code goes here --&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="dl">"</span><span class="s2">my-component</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#my-component</span><span class="dl">"</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>This component will now be available to be called from any other component you make,
or as a <code class="language-plaintext highlighter-rouge">@routeComponent</code>.</p>

<h3 id="binding-to-a-route">Binding to a route</h3>
<p>Routing is done server side, so you bind a component to a route by declaring a GET endpoint in Javalin:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/my-path"</span><span class="o">,</span> <span class="nc">VueComponent</span><span class="o">(</span><span class="s">"my-component"</span><span class="o">))</span>
</code></pre></div></div>

<p>This means that you can use the same <code class="language-plaintext highlighter-rouge">AccessManager</code> for frontend routes as you use for your API:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/my-path"</span><span class="o">,</span> <span class="nc">VueComponent</span><span class="o">(</span><span class="s">"my-component"</span><span class="o">),</span> <span class="n">roles</span><span class="o">(</span><span class="nc">Role</span><span class="o">.</span><span class="na">LOGGED_IN</span><span class="o">))</span>
</code></pre></div></div>

<h2 id="configuration-options">Configuration options</h2>

<h3 id="rootdirectory">rootDirectory</h3>

<p>By default, JavalinVue will set the root directory based on the first request it serves.</p>

<ul>
  <li>When <code class="language-plaintext highlighter-rouge">isDev</code> is true, the root dir will be set to the <code class="language-plaintext highlighter-rouge">src/main/resources/vue</code> (external location)</li>
  <li>When <code class="language-plaintext highlighter-rouge">isDev</code> is false, the root dir will be set to <code class="language-plaintext highlighter-rouge">/vue</code> (classpath location)</li>
</ul>

<p>This is done to make development fast locally, and requests fast in production.
If you set the root dir explicitly, Javalin won’t try to guess what to do:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">classpathPath</span><span class="o">(</span><span class="s">"/path"</span><span class="o">));</span> <span class="c1">// use the path on the same classpath as Javalin</span>
<span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">classpathPath</span><span class="o">(</span><span class="s">"/path"</span><span class="o">,</span> <span class="nc">MyClass</span><span class="o">.</span><span class="na">class</span><span class="o">));</span> <span class="c1">// use the path on the classpath of provided Class</span>
<span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">externalPath</span><span class="o">(</span><span class="s">"/path"</span><span class="o">));</span> <span class="c1">// use an external path</span>
<span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">explicitPath</span><span class="o">(</span><span class="n">path</span><span class="o">));</span> <span class="c1">// use an explicit Path object</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">rootDirectory</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">classpathPath</span><span class="p">(</span><span class="s">"/path"</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// use the path on the same classpath as Javalin</span>
<span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">rootDirectory</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">classpathPath</span><span class="p">(</span><span class="s">"/path"</span><span class="p">,</span> <span class="nc">MyClass</span><span class="p">.</span><span class="k">class</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// use the path on the classpath of provided Class</span>
<span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">rootDirectory</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">externalPath</span><span class="p">(</span><span class="s">"/path"</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// use an external path</span>
<span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">rootDirectory</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">explicitPath</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="p">}</span> <span class="c1">// use an explicit Path object</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="vueversion">vueVersion</h3>

<p>By default, version is set to Vue 2. If you’re using Vue 3 you can configure that:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">vueVersion</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">vue2</span><span class="o">());</span>
<span class="nc">JavalinVue</span><span class="o">.</span><span class="na">vueVersion</span><span class="o">(</span><span class="n">c</span> <span class="o">-&gt;</span> <span class="n">c</span><span class="o">.</span><span class="na">vue3</span><span class="o">(</span><span class="s">"VueAppName"</span><span class="o">));</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">vueVersion</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">vue2</span><span class="p">()</span> <span class="p">}</span>
<span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">vueVersion</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="nf">vue3</span><span class="p">(</span><span class="s">"VueAppName"</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="statefunction">stateFunction</h3>

<p>If you want to share state from your server with Vue, you can provide JavalinVue with a state function:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">stateFunction</span> <span class="o">=</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">Map</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"user"</span><span class="o">,</span> <span class="n">getUser</span><span class="o">(</span><span class="n">ctx</span><span class="o">));</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="p">.</span><span class="n">stateFunction</span> <span class="p">=</span> <span class="p">{</span> <span class="nf">mapOf</span><span class="p">(</span><span class="s">"user"</span> <span class="n">to</span> <span class="nf">getUser</span><span class="p">(</span><span class="n">it</span><span class="p">))</span> <span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>This can then be accessed from the <code class="language-plaintext highlighter-rouge">state</code> variable:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"user-template"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>{{ $javalin.state.user }}<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre></div></div>

<p>The function runs for every request, so the state is always up to
date when the user navigates or refreshes the page.</p>

<h3 id="isdevfunction">isDevFunction</h3>

<p>By default, this <code class="language-plaintext highlighter-rouge">isDevFunction</code> is set to check if the request host is <code class="language-plaintext highlighter-rouge">"localhost"</code> or  <code class="language-plaintext highlighter-rouge">"127.0.0.1"</code>.
This function is called once on the first request JavalinVue sees, and is used to set an <code class="language-plaintext highlighter-rouge">isDev</code> property,
which is then used to make decisions on how to build the HTML for a request.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">isDevFunction</span> <span class="o">=</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="c1">// your code here</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="p">.</span><span class="nf">isDevFunction</span> <span class="p">{</span> <span class="cm">/* Your code here */</span> <span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="optimizedependencies">optimizeDependencies</h3>

<p>By default, this is set to <code class="language-plaintext highlighter-rouge">true</code>. If you set it to <code class="language-plaintext highlighter-rouge">false</code>, every <code class="language-plaintext highlighter-rouge">.vue</code>
file that JavalinVue finds will be inlined in <code class="language-plaintext highlighter-rouge">@componentRegistration</code>.
If you leave it as true, only required <code class="language-plaintext highlighter-rouge">.vue</code> files will be included.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JavalinVue.optimizeDependencies = true/false;
</code></pre></div></div>

<h3 id="cachecontrol">cacheControl</h3>

<p>By default, JavalinVue sets the <code class="language-plaintext highlighter-rouge">"Cache-Control"</code> header to <code class="language-plaintext highlighter-rouge">"no-cache, no-store, must-revalidate"</code>.
This can be configured:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">cacheControl</span> <span class="o">=</span> <span class="s">"..."</span><span class="o">;</span>
</code></pre></div></div>

<h2 id="layout-macros">Layout macros</h2>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@inlineFile</span><span class="o">(</span><span class="s">"/path/to/file.ext"</span><span class="o">)</span>        <span class="c1">// this file will always be inlined</span>
<span class="nd">@inlineFileDev</span><span class="o">(</span><span class="s">"/path/to/file.ext"</span><span class="o">)</span>     <span class="c1">// this file will be inlined if JavalinVue.isDev is true</span>
<span class="nd">@inlineFileNotDev</span><span class="o">(</span><span class="s">"/path/to/file.ext"</span><span class="o">)</span>  <span class="c1">// this file will be inlined if JavalinVue.isDev is false</span>
<span class="nd">@componentRegistration</span>                  <span class="c1">// all required components will be inlined here</span>
<span class="nd">@routeComponent</span>                         <span class="c1">// the current route component will be inlined here</span>
<span class="nd">@cdnWebjar</span>                              <span class="c1">// will resolve to webjar path if dev, cdn if not dev</span>
</code></pre></div></div>

<h3 id="cdnwebjar">@cdnWebjar</h3>
<p>You can reference your WebJars with <code class="language-plaintext highlighter-rouge">@cdnWebjar/</code> instead of the normal <code class="language-plaintext highlighter-rouge">/webjars/</code>.
If you do this, the path will resolve to <code class="language-plaintext highlighter-rouge">/webjars/</code> on when <code class="language-plaintext highlighter-rouge">isDevFunction</code> returns true, and <code class="language-plaintext highlighter-rouge">https//cdn.jsdelivr.net/.../</code>
on non-localhost. <strong>Note that this only works with NPM webjars.</strong></p>

<h2 id="loadabledata">LoadableData</h2>

<p>The JavalinVue plugin includes a small class for making HTTP get-requests
to your backend, it can be used like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"books-component"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"books.loading"</span><span class="nt">&gt;</span>Loading books ...<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"books.loadError"</span><span class="nt">&gt;</span>Failed to load books! ({{books.loadError.text}})<span class="nt">&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">v-if=</span><span class="s">"books.loaded"</span> <span class="na">v-for=</span><span class="s">"book in books.data"</span><span class="nt">&gt;</span>{{book}}<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="dl">"</span><span class="s2">books-component</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#books-component</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">data</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
            <span class="na">books</span><span class="p">:</span> <span class="k">new</span> <span class="nx">LoadableData</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/books</span><span class="dl">"</span><span class="p">),</span>
        <span class="p">}),</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<p>The class automatically caches the request in <code class="language-plaintext highlighter-rouge">localStorage</code>,
so subsequent requests will appear to load instantly.
All configuration options and methods are shown below:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">useCache</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">errorCallback</span> <span class="o">=</span> <span class="nx">error</span> <span class="o">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">`An error occurred! Code: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">code</span><span class="p">}</span><span class="s2">, text: </span><span class="p">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>

<span class="c1">// Create a new instance with config options</span>
<span class="kd">const</span> <span class="nx">loadableData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoadableData</span><span class="p">(</span><span class="dl">"</span><span class="s2">/api/books</span><span class="dl">"</span><span class="p">,</span> <span class="nx">useCache</span><span class="p">,</span> <span class="nx">errorCallback</span><span class="p">);</span>
</code></pre></div></div>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Refresh data (can use cache to avoid flickering)</span>
<span class="nx">loadableData</span><span class="p">.</span><span class="nx">refresh</span><span class="p">(</span><span class="nx">useCache</span><span class="p">,</span> <span class="nx">errorCallback</span><span class="p">);</span>

<span class="c1">// Refresh data for other instances which uses the same endpoint</span>
<span class="kd">let</span> <span class="nx">users</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoadableData</span><span class="p">(</span><span class="dl">"</span><span class="s2">/users</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">sameUsers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">LoadableData</span><span class="p">(</span><span class="dl">"</span><span class="s2">/users</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// this variable could be in a different component</span>
<span class="nx">users</span><span class="p">.</span><span class="nx">refreshAll</span><span class="p">();</span> <span class="c1">// sameUsers will also be refreshed, since they share the same URL</span>

<span class="c1">// Refresh data via static method</span>
<span class="nx">LoadableData</span><span class="p">.</span><span class="nx">refreshAll</span><span class="p">(</span><span class="dl">"</span><span class="s2">/users</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// all instances with this URL will refresh themselves</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">loadError</code> object contains the HTTP status and error message,
and is available in both the template and in the error callback function.</p>

<h2 id="good-to-know">Good to know</h2>

<p>JavalinVue will also put path-parameters in the Vue instance,
which you can access like this:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"thread-view"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>{{ $javalin.pathParams["user"] }}<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
    <span class="nx">Vue</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="dl">"</span><span class="s2">thread-view</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">template</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#thread-view</span><span class="dl">"</span>
    <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>

<h3 id="local-state">Local state</h3>
<p>This feature came to life because someone was abusing <code class="language-plaintext highlighter-rouge">JavalinVue.stateFunction</code>
by overwriting it for every request. If you find yourself doing this, you should
either rewrite your app to fetch data using <code class="language-plaintext highlighter-rouge">LoadableData</code> (recommended), or use
local state for <code class="language-plaintext highlighter-rouge">VueComponent</code> (usually not recommended).</p>

<p>Every <code class="language-plaintext highlighter-rouge">VueComponent</code> can take a state object as a second parameter. This state overwrites the state from
<code class="language-plaintext highlighter-rouge">stateFunction</code>. You can either add it directly in a route declaration:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/specific-state"</span><span class="p">,</span> <span class="nc">VueComponent</span><span class="p">(</span><span class="s">"test-component"</span><span class="p">,</span> <span class="nf">mapOf</span><span class="p">(</span><span class="s">"test"</span> <span class="n">to</span> <span class="s">"tast"</span><span class="p">)))</span>
</code></pre></div></div>

<p>Or inside a handler:</p>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/specific-state"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="kd">val</span> <span class="py">myState</span> <span class="p">=</span> <span class="nf">mapOf</span><span class="p">(</span><span class="s">"test"</span> <span class="n">to</span> <span class="s">"tast"</span><span class="p">)</span>
    <span class="nc">VueComponent</span><span class="p">(</span><span class="s">"test-component"</span><span class="p">,</span> <span class="n">myState</span><span class="p">).</span><span class="nf">handle</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Note that this is something that you CAN do it, not something that you SHOULD do.
Only do this if you have thought hard about it, and it solves a real problem for you.</p>

        <script src="/js/anchor.min.js"></script>
        <script>
            anchors.options.placement = 'left';
            anchors.add();
        </script>

    </main>
    <footer>
        Javalin is a Java and Kotlin web framework, open sourced under the
        <a href="https://tldrlegal.com/license/apache-license-2.0-(apache-2.0)">Apache 2</a> license
        | <a href="/download">Download</a>
        | <a href="/about">About</a>
        | <a href="/news">News</a>
        | <a href="/about#contact">Contact</a>
        | <a href="/for-educators">For educators</a>
    </footer>
    <div id="star-begging">
    <style>
        #star-begging {
            transition: transform .25s;
            transform: scale(0);
            border-radius: 8px;
            position: fixed;
            bottom: 32px;
            right: 32px;
            padding: 20px 40px 16px 20px;
            background: #fff;
            box-shadow: 0 1px 20px rgba(0, 0, 0, 0.15);
            z-index: 9999998;
        }
        #star-begging.in {
            transform: scale(1);
        }
        #star-begging.out {
            transform: translateX(400px);
        }
        #star-begging p {
            font-size: 16px;
            margin: 0 0 15px;
        }
        #star-begging .close {
            position: absolute;
            right: 20px;
            top: 20px;
            height: 40px;
            width: 40px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-family: arial, sans-serif;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }
    </style>
    <p>
        Like Javalin?
        <br>Star us 😊
    </p>
    <span class="close">×</span>
    <iframe id="starFrame" class="githubStar" title="github-stars"
            src="https://ghbtns.com/github-btn.html?user=javalin&amp;repo=javalin&amp;type=star&amp;count=true&size=large"
            frameborder="0" scrolling="0" width="150px" height="30px">
    </iframe>
    <script>
        if (localStorage.getItem("dismissed") !== "true" && document.getElementById("notification-banner") === null) {
            setTimeout(function () {
                document.querySelector("#star-begging").classList.add("in");
            }, 15000);
            document.querySelector("#star-begging .close").addEventListener("click", function () {
                document.querySelector("#star-begging").classList.add("out");
                localStorage.setItem("dismissed", "true");
            });
        }
    </script>
</div>

    <script src="/js/scripts.js"></script>
</body>
</html>
