<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-54137818-11"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-54137818-11', {'anonymize_ip': true});
</script>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Oxygen+Mono|Roboto+Slab:500,700&display=swap" rel="stylesheet">
    <meta property="og:title" content="Jetty session handling - Persisting, caching and clustering - Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:site_name" content="Javalin">
    <meta property="og:url" content="https://javalin.io">
    <meta property="og:description" content="What you will learnIn this tutorial we’ll have at look at Sessions. We’ll learn about what they’re used for,as well as different ways of persisting, caching ...">
    <meta property="og:image" content="https://javalin.io/img/javalin.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="liMtSlffOZROWLqoiOZdSx-luH9_Siq5-Ot6xqHZwq8">
    <title>
        Jetty session handling - Persisting, caching and clustering - Javalin - A lightweight Java and Kotlin web framework
    </title>
    <meta name="description" content="What you will learnIn this tutorial we’ll have at look at Sessions. We’ll learn about what they’re used for,as well as different ways of persisting, caching ...">
    <link rel="canonical" href="5//tutorials/jetty-session-handling">
    <link rel="shortcut icon" type="image/png" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/main.css">
    <style>/* Styles that affect the length of the document */
p code,
li code {
    font-size: 90%;
    letter-spacing: -0.5px;
    border: 1px solid #ccd;
    background: #f5f5f7;
    padding: 1px 3px;
}

.multitab-code pre {
    margin-top: 0;
    border-radius: 0 0 5px 5px;
}

.multitab-code div[data-tab] {
    display: none;
}

:target {
    scroll-margin-top: 108px;
}

.anchorjs-link {
    transition: all .25s linear;
  }
  
*:hover > .anchorjs-link {
    margin-left: -1.125em !important;
 }</style>
</head>
<body>
    <a id="fork-me" href="https://github.com/javalin/javalin" target="_blank">
    <img style="position:fixed;top:0;right:0;border:0;z-index:99999" src="data:image/png;base64,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" alt="Fork me on GitHub">
</a>
    <header class="top-nav-header">
        <nav class="width-limit">
            <a id="logo" href="/" aria-label="Javalin">
                <img src="/img/logo.svg" alt="Javalin">
            </a>
            <ul>
                <li><a href="/documentation">Docs</a></li>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/plugins">Plugins</a></li>
                <li><a href="/community">Community</a></li>
            </ul>
        </nav>
    </header>
    <main class="width-limit">
        <article class="tutorial" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="tutorial-header">
        <h1 class="no-margin-top" itemprop="name headline">Jetty session handling - Persisting, caching and clustering</h1>
        <p class="notification">
            <time datetime="2018-09-02T00:00:00+00:00" itemprop="datePublished">Sep 2, 2018</time>
             
                • Written by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="https://www.linkedin.com/in/davidaase" target="_blank">David Åse</a></span></span>
            
            <span id="timeToRead">Reading time: <b>0-0 min</b></span>
             
            <br>
            <em class="github-link">
                The source code for this tutorial can be found on 
                <a href="https://github.com/javalin/javalin-samples/tree/main/javalin5/javalin-jetty-sessions-example" target="_blank">GitHub</a>.
                Please fork/clone and look while you read.
            </em>
            
        </p>
        
    </div>
    <div class="post-content" itemprop="articleBody">
        <h2 id="what-you-will-learn">What you will learn</h2>
<p>In this tutorial we’ll have at look at Sessions. We’ll learn about what they’re used for,
as well as different ways of persisting, caching and clustering sessions using Jetty.</p>

<h2 id="what-is-a-session">What is a session?</h2>
<p>When a user visits a website (or opens a webapp), the server usually creates a <code class="highlighter-rouge">Session</code> object for the user.
Users are usually linked to their <code class="highlighter-rouge">Session</code> by cookie with a <code class="highlighter-rouge">sessionId</code> value.
This <code class="highlighter-rouge">Session</code> object can be used to store information about the current, well, session, like if the
user is logged in.</p>

<p>The architecture of session management changed significantly in Jetty 9.4, and this tutorial
is intended to get you up to speed. You can view the
<a href="https://www.eclipse.org/jetty/documentation/jetty-9/index.html#session-management">documentation</a>
on Jetty’s website if you need all the details.</p>

<h2 id="persisting-sessions">Persisting sessions</h2>
<p>By default Jetty will store all its session information in a <code class="highlighter-rouge">HashMap</code>, which is stored in memory (RAM).
When the Jetty server restarts all of the sessions are cleared. Restarts can happen for example if you’re
making changes on localhost, or if you’re deploying a new version of your app to your cloud provider.</p>

<p><strong>Please note:</strong> In order for Jetty to successfully persist your sessions,
all objects in your session attributes must implement the <code class="highlighter-rouge">Serializable</code> interface.
This is usually as simple as adding <code class="highlighter-rouge">implements Serializable</code> to your classes.</p>

<h3 id="persisting-to-the-file-system">Persisting to the file system</h3>
<p>The simplest way to persist a <code class="highlighter-rouge">Session</code> is to store the <code class="highlighter-rouge">Session</code>s as files on the file system.
This can be done using a <code class="highlighter-rouge">FileSessionDataStore</code>.</p>

<p>This approach is well suited for a dev environment, since it’s easy to set up and has no dependencies.
You need to create a <code class="highlighter-rouge">SessionHandler</code> with a <code class="highlighter-rouge">SessionCache</code>, and attach a <code class="highlighter-rouge">FileSessionDataStore</code>:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">SessionHandler</span> <span class="nf">fileSessionHandler</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SessionHandler</span> <span class="n">sessionHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SessionHandler</span><span class="o">();</span>
    <span class="n">SessionCache</span> <span class="n">sessionCache</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultSessionCache</span><span class="o">(</span><span class="n">sessionHandler</span><span class="o">);</span>
    <span class="n">sessionCache</span><span class="o">.</span><span class="na">setSessionDataStore</span><span class="o">(</span><span class="n">fileSessionDataStore</span><span class="o">());</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setSessionCache</span><span class="o">(</span><span class="n">sessionCache</span><span class="o">);</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setHttpOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="c1">// make additional changes to your SessionHandler here</span>
    <span class="k">return</span> <span class="n">sessionHandler</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="n">FileSessionDataStore</span> <span class="nf">fileSessionDataStore</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">FileSessionDataStore</span> <span class="n">fileSessionDataStore</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileSessionDataStore</span><span class="o">();</span>
    <span class="n">File</span> <span class="n">baseDir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="s">"java.io.tmpdir"</span><span class="o">));</span>
    <span class="n">File</span> <span class="n">storeDir</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">baseDir</span><span class="o">,</span> <span class="s">"javalin-session-store"</span><span class="o">);</span>
    <span class="n">storeDir</span><span class="o">.</span><span class="na">mkdir</span><span class="o">();</span>
    <span class="n">fileSessionDataStore</span><span class="o">.</span><span class="na">setStoreDir</span><span class="o">(</span><span class="n">storeDir</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">fileSessionDataStore</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">fileSessionHandler</span><span class="p">()</span> <span class="p">=</span> <span class="n">SessionHandler</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
    <span class="n">sessionCache</span> <span class="p">=</span> <span class="n">DefaultSessionCache</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">apply</span> <span class="p">{</span>
        <span class="n">sessionDataStore</span> <span class="p">=</span> <span class="n">FileSessionDataStore</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">baseDir</span> <span class="p">=</span> <span class="n">File</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">getProperty</span><span class="p">(</span><span class="s">"java.io.tmpdir"</span><span class="p">))</span>
            <span class="k">this</span><span class="p">.</span><span class="n">storeDir</span> <span class="p">=</span> <span class="n">File</span><span class="p">(</span><span class="n">baseDir</span><span class="p">,</span> <span class="s">"javalin-session-store"</span><span class="p">).</span><span class="n">apply</span> <span class="p">{</span> <span class="n">mkdir</span><span class="p">()</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">httpOnly</span> <span class="p">=</span> <span class="k">true</span>
    <span class="c1">// make additional changes to your SessionHandler here
</span><span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<p>This approach can also work on a remote server, but some cloud providers wipe all files when
you redeploy your service, so be careful. File IO can also be slow, depending on your hardware.
If you want your sessions to be a bit more persistent, and faster, you can use a database.</p>

<h3 id="persisting-to-a-database">Persisting to a database</h3>
<p>Programmatically, persisting to a database is not very different from persisting to the file system.
You need to create a <code class="highlighter-rouge">SessionHandler</code> with a <code class="highlighter-rouge">SessionCache</code>, but instead of using a <code class="highlighter-rouge">FileSessionDataStore</code> you
need to use a datastore specific for your database. Here is an example using JDBC:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">SessionHandler</span> <span class="nf">sqlSessionHandler</span><span class="o">(</span><span class="n">String</span> <span class="n">driver</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SessionHandler</span> <span class="n">sessionHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SessionHandler</span><span class="o">();</span>
    <span class="n">SessionCache</span> <span class="n">sessionCache</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultSessionCache</span><span class="o">(</span><span class="n">sessionHandler</span><span class="o">);</span>
    <span class="n">sessionCache</span><span class="o">.</span><span class="na">setSessionDataStore</span><span class="o">(</span>
        <span class="n">jdbcDataStoreFactory</span><span class="o">(</span><span class="n">driver</span><span class="o">,</span> <span class="n">url</span><span class="o">).</span><span class="na">getSessionDataStore</span><span class="o">(</span><span class="n">sessionHandler</span><span class="o">)</span>
    <span class="o">);</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setSessionCache</span><span class="o">(</span><span class="n">sessionCache</span><span class="o">);</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setHttpOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="c1">// make additional changes to your SessionHandler here</span>
    <span class="k">return</span> <span class="n">sessionHandler</span><span class="o">;</span>
<span class="o">}</span>

<span class="kd">private</span> <span class="kd">static</span> <span class="n">JDBCSessionDataStoreFactory</span> <span class="nf">jdbcDataStoreFactory</span><span class="o">(</span><span class="n">String</span> <span class="n">driver</span><span class="o">,</span> <span class="n">String</span> <span class="n">url</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">DatabaseAdaptor</span> <span class="n">databaseAdaptor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DatabaseAdaptor</span><span class="o">();</span>
    <span class="n">databaseAdaptor</span><span class="o">.</span><span class="na">setDriverInfo</span><span class="o">(</span><span class="n">driver</span><span class="o">,</span> <span class="n">url</span><span class="o">);</span>
    <span class="c1">// databaseAdaptor.setDatasource(myDataSource); // you can set data source here (for connection pooling, etc)</span>
    <span class="n">JDBCSessionDataStoreFactory</span> <span class="n">jdbcSessionDataStoreFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JDBCSessionDataStoreFactory</span><span class="o">();</span>
    <span class="n">jdbcSessionDataStoreFactory</span><span class="o">.</span><span class="na">setDatabaseAdaptor</span><span class="o">(</span><span class="n">databaseAdaptor</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">jdbcSessionDataStoreFactory</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">sqlSessionHandler</span><span class="p">(</span><span class="n">driver</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span> <span class="p">=</span> <span class="n">SessionHandler</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
    <span class="n">sessionCache</span> <span class="p">=</span> <span class="n">DefaultSessionCache</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">apply</span> <span class="p">{</span> <span class="c1">// create the session handler
</span>        <span class="n">sessionDataStore</span> <span class="p">=</span> <span class="n">JDBCSessionDataStoreFactory</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span> <span class="c1">// attach a cache to the handler
</span>            <span class="n">setDatabaseAdaptor</span><span class="p">(</span><span class="n">DatabaseAdaptor</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span> <span class="c1">// attach a store to the cache
</span>                <span class="n">setDriverInfo</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
                <span class="c1">// setDatasource(myDataSource) // you can set data source here (for connection pooling, etc)
</span>            <span class="p">})</span>
        <span class="p">}.</span><span class="n">getSessionDataStore</span><span class="p">(</span><span class="n">sessionHandler</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">httpOnly</span> <span class="p">=</span> <span class="k">true</span>
    <span class="c1">// make additional changes to your SessionHandler here
</span><span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<p>If you want to use MongoDB you can just switch the data store:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="n">MongoSessionDataStoreFactory</span> <span class="nf">mongoDataStoreFactory</span><span class="o">(</span><span class="n">String</span> <span class="n">url</span><span class="o">,</span> <span class="n">String</span> <span class="n">dbName</span><span class="o">,</span> <span class="n">String</span> <span class="n">collectionName</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">MongoSessionDataStoreFactory</span> <span class="n">mongoSessionDataStoreFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MongoSessionDataStoreFactory</span><span class="o">();</span>
    <span class="n">mongoSessionDataStoreFactory</span><span class="o">.</span><span class="na">setConnectionString</span><span class="o">(</span><span class="n">url</span><span class="o">);</span>
    <span class="n">mongoSessionDataStoreFactory</span><span class="o">.</span><span class="na">setDbName</span><span class="o">(</span><span class="n">dbName</span><span class="o">);</span>
    <span class="n">mongoSessionDataStoreFactory</span><span class="o">.</span><span class="na">setCollectionName</span><span class="o">(</span><span class="n">collectionName</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">mongoSessionDataStoreFactory</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">sessionDataStore</span> <span class="p">=</span> <span class="n">MongoSessionDataStoreFactory</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
    <span class="n">connectionString</span> <span class="p">=</span> <span class="s">"..."</span>
    <span class="n">dbName</span> <span class="p">=</span> <span class="s">"..."</span>
    <span class="n">collectionName</span> <span class="p">=</span> <span class="s">"..."</span>
<span class="p">}.</span><span class="n">getSessionDataStore</span><span class="p">(</span><span class="n">sessionHandler</span><span class="p">)</span>
</code></pre>
    </div>
  </div>
</div>

<p>Jetty supports JDBC, MongoDB, Inifinspan, Hazelcast, and Google Cloud DataStore.
JDBC is included with in the core jetty-server dependency, while MongoDB and others require
additional dependencies.</p>

<p>If you’re using a SQL database, Jetty will create a <code class="highlighter-rouge">jettysessions</code> table. If you’re using MongoDB it will create
a document. They both contain the same data:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="o">{</span>
    <span class="s">"_id"</span><span class="o">:</span> <span class="o">{</span>
        <span class="s">"$oid"</span><span class="o">:</span> <span class="s">"5b858d527d3c0f8722173292"</span>
    <span class="o">},</span>
    <span class="s">"id"</span><span class="o">:</span> <span class="s">"node0j4ii2zxu01i91g5f8odup78c30"</span><span class="o">,</span>
    <span class="s">"accessed"</span><span class="o">:</span> <span class="mi">1535479586876</span><span class="o">,</span>
    <span class="s">"context"</span><span class="o">:</span> <span class="o">{</span>
        <span class="s">"0_0_0_0:"</span><span class="o">:</span> <span class="o">{</span>
            <span class="s">"__metadata__"</span><span class="o">:</span> <span class="o">{</span>
                <span class="s">"lastNode"</span><span class="o">:</span> <span class="s">"node0"</span><span class="o">,</span>
                <span class="s">"lastSaved"</span><span class="o">:</span> <span class="mi">1535479586879</span><span class="o">,</span>
                <span class="s">"version"</span><span class="o">:</span> <span class="mi">78</span>
            <span class="o">},</span>
            <span class="s">"signed-in-user"</span><span class="o">:</span> <span class="s">"tipsy"</span> <span class="c1">// custom data</span>
        <span class="o">}</span>
    <span class="o">},</span>
    <span class="s">"created"</span><span class="o">:</span> <span class="mi">1535479122617</span><span class="o">,</span>
    <span class="s">"expiry"</span><span class="o">:</span> <span class="mi">0</span><span class="o">,</span>
    <span class="s">"lastAccessed"</span><span class="o">:</span> <span class="mi">1535479585053</span><span class="o">,</span>
    <span class="s">"maxIdle"</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span>
    <span class="s">"valid"</span><span class="o">:</span> <span class="kc">true</span>
<span class="o">}</span>
</code></pre>
</div>

<p>For performance and security reasons, it’s advised to create a separate database (on the database instance)
with credentials unique to Jetty.</p>

<h2 id="session-cache-and-clustering">Session cache and clustering</h2>
<p>Since database and file systems operations are relatively slow, caching data in memory can increase the performance
of your application. In both the previous examples we attached a <code class="highlighter-rouge">SessionCache</code> to our <code class="highlighter-rouge">SessionHandler</code>. There are
two implementations of the <code class="highlighter-rouge">SessionCache</code> included in Jetty, <code class="highlighter-rouge">DefaultSessionCache</code> and <code class="highlighter-rouge">NullSessionCache</code>.</p>

<h3 id="defaultsessioncache">DefaultSessionCache</h3>
<p>We used the <code class="highlighter-rouge">DefaultSessionCache</code> in our previous examples, and it caches sessions in memory.
This is great if you have one instance of your app running, but it can lead to trouble if you
have two instances behind a load-balancer. Jetty recommends you always use sticky-sessions
with the <code class="highlighter-rouge">DefaultSessionCache</code>, but even with sticky sessions you can run into inconsistencies.
If an instance goes down or gets overloaded, traffic will be routed to the other instance which won’t
have the same session in its cache. This is where the <code class="highlighter-rouge">NullSessionCache</code> is useful.</p>

<h3 id="nullsessioncache">NullSessionCache</h3>
<p>The <code class="highlighter-rouge">NullSessionCache</code> doesn’t actually do any caching at all. Every time a <code class="highlighter-rouge">Session</code> is needed
it’s fetched from the <code class="highlighter-rouge">SessionDataStore</code>. This means that all instances share the same source of truth, and there
won’t be any inconsistencies. Jetty recommends this approach for clustering without sticky-sessions, but
it’s the safer choice even if sticky-sessions are enabled.</p>

<p>There is a performance penalty to not caching, but if you’re running a dedicated database on the same network
with small sessions, it should just be ~10ms per request. Using an external hosted MongoDB such
as <a href="https://mlab.com/">mlab</a> it seems to be around 40ms.</p>

<h3 id="samesite-session-cookie-settings">SameSite session cookie settings</h3>
<p>By default, Jetty uses lenient cookie security settings. In order to harden and to mitigate
cross-site request forgery (<a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery">CSRF</a>) attacks, it is useful
to set the <code class="highlighter-rouge">SameSite=strict</code> cookie flag. This is particularly recommended if the <code class="highlighter-rouge">JSESSIONID</code> cookie is also used
directly or indirectly for authentication purposes.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kd">static</span> <span class="n">SessionHandler</span> <span class="nf">customSessionHandler</span><span class="o">()</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">SessionHandler</span> <span class="n">sessionHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SessionHandler</span><span class="o">();</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setHttpOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setSecureRequestOnly</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
    <span class="n">sessionHandler</span><span class="o">.</span><span class="na">setSameSite</span><span class="o">(</span><span class="n">HttpCookie</span><span class="o">.</span><span class="na">SameSite</span><span class="o">.</span><span class="na">STRICT</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">sessionHandler</span><span class="o">;</span>
<span class="o">}</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">fun</span> <span class="nf">customSessionHandler</span><span class="p">()</span> <span class="p">=</span> <span class="n">SessionHandler</span><span class="p">().</span><span class="n">apply</span> <span class="p">{</span>
    <span class="n">httpOnly</span> <span class="p">=</span> <span class="k">true</span>
    <span class="n">isSecureRequestOnly</span> <span class="p">=</span> <span class="k">true</span>
    <span class="n">sameSite</span> <span class="p">=</span> <span class="n">HttpCookie</span><span class="p">.</span><span class="n">SameSite</span><span class="p">.</span><span class="n">STRICT</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<h2 id="summary">Summary</h2>
<ul>
  <li>Session handling in Jetty requires a <code class="highlighter-rouge">SessionHandler</code>, <code class="highlighter-rouge">SessionCache</code>, and a <code class="highlighter-rouge">SessionDataStore</code></li>
  <li>A <code class="highlighter-rouge">FileSessionDataStore</code> is well suited for development environments</li>
  <li>The <code class="highlighter-rouge">DefaultSessionCache</code> works well if you only run one instance of your app</li>
  <li>The <code class="highlighter-rouge">NullSessionCache</code> is suitable for multiple instances running behind a loadbalancer</li>
</ul>

<h2 id="usage-in-javalin">Usage in Javalin</h2>
<p>Since you are currently on <a href="/">javalin.io</a>, it should be mentioned how to use this knowledge in your Javalin app.
Since Javalin relies on Jetty for session handling can, you simply pass your <code class="highlighter-rouge">SessionHandler</code>:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">sessionHandler</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">fileSessionHandler</span><span class="o">());</span>
<span class="o">}).</span><span class="na">start</span><span class="o">(</span><span class="mi">7000</span><span class="o">);</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="n">Javalin</span><span class="p">.</span><span class="n">create</span> <span class="p">{</span>
    <span class="n">it</span><span class="p">.</span><span class="n">sessionHandler</span> <span class="p">{</span> <span class="n">fileSessionHandler</span><span class="p">()</span> <span class="p">}</span>
<span class="p">}.</span><span class="n">start</span><span class="p">(</span><span class="m">7000</span><span class="p">)</span>
</code></pre>
    </div>
  </div>
</div>

<p>As we saw earlier, the <code class="highlighter-rouge">SessionHandler</code> has a <code class="highlighter-rouge">SessionCache</code> which again has a <code class="highlighter-rouge">SessionDataStore</code>,
so no further configuration is required.  All session configuration happens through Jetty classes.</p>

<p>N.B. some browsers (see e.g. <a href="https://blog.chromium.org/2020/02/samesite-cookie-changes-in-february.html">here</a>)
will eventually further restrict cookies to first-party access by default in case the <code class="highlighter-rouge">SameSite</code> and <code class="highlighter-rouge">secure</code>
cookie settings are not being set.</p>

<h3 id="working-with-sessions">Working with sessions</h3>
<p>Sessions are a great way to keep a trusted state for your connected clients.
If you use a session database, values stored in the session store can be retrieved by each of your running instances.</p>

<h4 id="writing-values">Writing values</h4>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/write"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// values written to the session will be available on all your instances if you use a session db</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="s">"my-key"</span><span class="o">,</span> <span class="s">"My value"</span><span class="o">);</span>
<span class="o">});</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/write"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// values written to the session will be available on all your instances if you use a session db
</span>    <span class="n">ctx</span><span class="p">.</span><span class="n">sessionAttribute</span><span class="p">(</span><span class="s">"my-key"</span><span class="p">,</span> <span class="s">"My value"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<h4 id="reading-values">Reading values</h4>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/read"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// values on the session will be available on all your instances if you use a session db</span>
    <span class="n">String</span> <span class="n">myValue</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="s">"my-key"</span><span class="o">);</span>
<span class="o">});</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/read"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// values on the session will be available on all your instances if you use a session db
</span>    <span class="kd">val</span> <span class="py">myValue</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">sessionAttribute</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;(</span><span class="s">"my-key"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<h4 id="invalidating-sessions">Invalidating sessions</h4>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/invalidate"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// if you want to invalidate a session, jetty will clean everything up for you</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">req</span><span class="o">.</span><span class="na">getSession</span><span class="o">().</span><span class="na">invalidate</span><span class="o">();</span>
<span class="o">});</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/invalidate"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// if you want to invalidate a session, jetty will clean everything up for you
</span>    <span class="n">ctx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">session</span><span class="p">.</span><span class="n">invalidate</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<h4 id="changing-session-ids">Changing session ids</h4>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/change-id"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// it could be wise to change the session id on login, to protect against session fixation attacks</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">req</span><span class="o">.</span><span class="na">changeSessionId</span><span class="o">();</span>
<span class="o">});</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/change-id"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// it could be wise to change the session id on login, to protect against session fixation attacks
</span>    <span class="n">ctx</span><span class="p">.</span><span class="n">req</span><span class="p">.</span><span class="n">changeSessionId</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<h4 id="access-management">Access management</h4>
<p>Sessions work well with the Javalin <a href="https://javalin.io/documentation#access-manager">AccessManager</a>.
You can check the session store to see if the user is logged in:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">accessManager</span><span class="o">((</span><span class="n">handler</span><span class="o">,</span> <span class="n">ctx</span><span class="o">,</span> <span class="n">roles</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">currentUser</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="s">"current-user"</span><span class="o">);</span> <span class="c1">// retrieve user stored during login</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">currentUser</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">redirectToLogin</span><span class="o">(</span><span class="n">ctx</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">userHasValidRole</span><span class="o">(</span><span class="n">ctx</span><span class="o">,</span> <span class="n">roles</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">handler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">ctx</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">UnauthorizedResponse</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="n">accessManager</span> <span class="p">{</span> <span class="n">handler</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">roles</span> <span class="p">-&gt;</span>
    <span class="kd">val</span> <span class="py">currentUser</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">sessionAttribute</span><span class="p">&lt;</span><span class="n">String</span><span class="p">?&gt;(</span><span class="s">"current-user"</span><span class="p">)</span> <span class="c1">// retrieve user stored during login
</span>    <span class="k">when</span> <span class="p">{</span>
        <span class="n">currentUser</span> <span class="p">==</span> <span class="k">null</span> <span class="p">-&gt;</span> <span class="n">redirectToLogin</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="n">currentUser</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">userHasValidRole</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">roles</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="n">handler</span><span class="p">.</span><span class="n">handle</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">-&gt;</span> <span class="k">throw</span> <span class="n">UnauthorizedResponse</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
    </div>
  </div>
</div>

<p>The source code for these examples is available in the
<a href="https://github.com/javalin/javalin-samples/tree/main/javalin5/javalin-jetty-sessions-example">tutorial repo</a>.</p>

    </div>
    <h3>Thanks for reading</h3>
    If you find any errors, please <a href="https://github.com/javalin/javalin.github.io/blob/master/_posts/tutorials/2018-09-02-jetty-session-handling-java.md">edit this page on GitHub</a>.
    <br>
    
        The full source code for this tutorial can also be found on <a href="https://github.com/javalin/javalin-samples/tree/main/javalin5/javalin-jetty-sessions-example">GitHub</a>.
    
</article>
<style>
    .social {
        margin: 30px 0;
        display: flex;
    }
    .social-btn {
        text-align: center;
        min-width: 240px;
        padding: 10px 16px 8px;
        font-size: 14px;
        font-family: 'Roboto Slab', sans-serif;
        font-weight: 600;
        color: #fff;
        background: #000;
        border-radius: 50px;
        box-shadow: 2px 2px red, -2px -2px cyan;
    }
    .social-btn + .social-btn {
        margin-left: 24px;
    }
    .social-btn:hover {
        background: #008ab4;
    }
    .social-btn img {
        width: 24px;
        display: inline;
        vertical-align: middle;
        margin-right: 12px;
    }
    @media (max-width: 480px) {
        .social {
            justify-content: space-between;
        }
        .social-btn {
            min-width: 0;
            width: calc(50% - 12px);
            text-align: left;
            display: flex;
            align-items: center;
        }
        .social-btn + .social-btn {
            margin-left: 0;
        }
    }
</style>
<div class="social">
    <a class="social-btn" href="https://twitter.com/intent/tweet?text=Jetty session handling - Persisting, caching and clustering&url=/tutorials/jetty-session-handling&via=javalin_io&related=javalin_io"
       rel="nofollow"
       title="Share on Twitter">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMA8BDQwKCAMOBwYECwUCCQ27fl2AAAAW1JREFUWMPtltuOwyAMRLG5QxL8/1+7G6lKFApMaJ5W2/NIPCPAnlL15R+xRSM7ZPMnci5yYvxrNRt3VMRtpPdBLqR9MWkhPkpI80BPUpFy2dfiUbKK9B02kjbmrCkycNAdfeCqpuOQOnrye2teRS9LrxqEjn4tQSS/io7Fxg1Kn/MWjxX7dgw30NvGNkO9CQP1O8v7oGEDq07i9Uu+YxAvs1J91GmDBtdQLVKjYz6/YINNWujiVgsMet3CqAr7yICKn3XQF4N9gizJDAsIDMSBLkIyyDzkmjqmWb0GoYUUBVKLWFUF6yk9gccDYtU7bKabWBNv9yKoDunmTcSW2Im+uwNi1cBP5+DjUSAGrzgiVcLZSBmlHjnQBv7L4AOMYEdwiAGcFgK/A5BN9/WsMCs90nsjT/SrGd0fI3UJIIIdovtlAUnWftA5KwiKakg2Y7ljfPn9tzWkUw5GsHV059UEOVpDR2wXl1l9+RP8AHA4c7ljId3mAAAAAElFTkSuQmCC">Share on Twitter
    </a>
    <a class="social-btn" href="https://facebook.com/sharer.php?u=/tutorials/jetty-session-handling"
       rel="nofollow"
       title="Share on Facebook">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAMFBMVEUAAAD///////////////////////////////////////////////////////////87TQQwAAAAD3RSTlMAwIDwEEDgMKBgINBwUJA4su2wAAAAy0lEQVRIx2MYJICr+T9WkOQAVTD/Pw5gDpHn/I8TXAAriMetwAqsQB63gh9gBf/xgAFT8E0QCPJxK/ixACTqj1PB5wCwKD9OBbsY8Cv4XEBAwU8GAgoECCmYABTB5QuEUI2S0n4cCn6DRBzxhORHkMh5Qgr0h7eCjw6I/BiPTcEnBgRgxKbgK5ICPkIKmGij4C+yIwn5gg2bgm9ICuIHa2SNKqCZgs9gBf2YClBTkDNuBSlgBeyYCtDKzGJcCtKhyY+lH7sCIweGwQEAY2jNUu1+zZgAAAAASUVORK5CYII=">Share on Facebook
    </a>
</div>


    </main>
    <footer>
        Javalin is a Java and Kotlin web framework, open sourced under the
        <a href="https://tldrlegal.com/license/apache-license-2.0-(apache-2.0)">Apache 2</a> license
        | <a href="/download">Download</a>
        | <a href="/about">About</a>
        | <a href="/news">News</a>
        | <a href="/about#contact">Contact</a>
        | <a href="/for-educators">For educators</a>
    </footer>
    <div id="star-begging">
    <style>
        #star-begging {
            transition: transform .25s;
            transform: scale(0);
            border-radius: 8px;
            position: fixed;
            bottom: 32px;
            right: 32px;
            padding: 20px 40px 16px 20px;
            background: #fff;
            box-shadow: 0 1px 20px rgba(0, 0, 0, 0.15);
            z-index: 9999998;
        }
        #star-begging.in {
            transform: scale(1);
        }
        #star-begging.out {
            transform: translateX(400px);
        }
        #star-begging p {
            font-size: 16px;
            margin: 0 0 15px;
        }
        #star-begging .close {
            position: absolute;
            right: 20px;
            top: 20px;
            height: 40px;
            width: 40px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-family: arial, sans-serif;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }
    </style>
    <p>
        Like Javalin?
        <br>Star us 😊
    </p>
    <span class="close">×</span>
    <iframe id="starFrame" class="githubStar" title="github-stars"
            src="https://ghbtns.com/github-btn.html?user=javalin&amp;repo=javalin&amp;type=star&amp;count=true&size=large"
            frameborder="0" scrolling="0" width="150px" height="30px">
    </iframe>
    <script>
        if (localStorage.getItem("dismissed") !== "true" && document.getElementById("notification-banner") === null) {
            setTimeout(function () {
                document.querySelector("#star-begging").classList.add("in");
            }, 15000);
            document.querySelector("#star-begging .close").addEventListener("click", function () {
                document.querySelector("#star-begging").classList.add("out");
                localStorage.setItem("dismissed", "true");
            });
        }
    </script>
</div>

    <script src="/js/scripts.js"></script>
</body>
</html>
