<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-54137818-11"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-54137818-11', {'anonymize_ip': true});
</script>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Oxygen+Mono|Roboto+Slab:500,700&display=swap" rel="stylesheet">
    <meta property="og:title" content="Clean Vue frontends without the hassle - Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:site_name" content="Javalin">
    <meta property="og:url" content="https://javalin.io">
    <meta property="og:description" content="In this tutorial you’ll learn how to create simple frontends with Javalin and Vue.The tutorial is quite extensive, and covers single-file components, routing...">
    <meta property="og:image" content="https://javalin.io/img/javalin.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="liMtSlffOZROWLqoiOZdSx-luH9_Siq5-Ot6xqHZwq8">
    <title>
        Clean Vue frontends without the hassle - Javalin - A lightweight Java and Kotlin web framework
    </title>
    <meta name="description" content="In this tutorial you’ll learn how to create simple frontends with Javalin and Vue.The tutorial is quite extensive, and covers single-file components, routing...">
    <link rel="canonical" href="5//tutorials/simple-frontends-with-javalin-and-vue">
    <link rel="shortcut icon" type="image/png" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/main.css">
    <style>/* Styles that affect the length of the document */
p code,
li code {
    font-size: 90%;
    letter-spacing: -0.5px;
    border: 1px solid #ccd;
    background: #f5f5f7;
    padding: 1px 3px;
}

.multitab-code pre {
    margin-top: 0;
    border-radius: 0 0 5px 5px;
}

.multitab-code div[data-tab] {
    display: none;
}

:target {
    scroll-margin-top: 108px;
}

.anchorjs-link {
    transition: all .25s linear;
  }
  
*:hover > .anchorjs-link {
    margin-left: -1.125em !important;
 }</style>
</head>
<body>
    <a id="fork-me" href="https://github.com/javalin/javalin" target="_blank">
    <img style="position:fixed;top:0;right:0;border:0;z-index:99999" src="data:image/png;base64,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" alt="Fork me on GitHub">
</a>
    <header class="top-nav-header">
        <nav class="width-limit">
            <a id="logo" href="/" aria-label="Javalin">
                <img src="/img/logo.svg" alt="Javalin">
            </a>
            <ul>
                <li><a href="/documentation">Docs</a></li>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/plugins">Plugins</a></li>
                <li><a href="/community">Community</a></li>
            </ul>
        </nav>
    </header>
    <main class="width-limit">
        <article class="tutorial" itemscope itemtype="http://schema.org/BlogPosting">
    <div class="tutorial-header">
        <h1 class="no-margin-top" itemprop="name headline">Clean Vue frontends without the hassle</h1>
        <p class="notification">
            <time datetime="2019-07-31T00:00:00+00:00" itemprop="datePublished">Jul 31, 2019</time>
             
                • Written by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="https://www.linkedin.com/in/davidaase" target="_blank">David Åse</a></span></span>
            
            <span id="timeToRead">Reading time: <b>0-0 min</b></span>
             
            <br>
            <em class="github-link">
                The source code for this tutorial can be found on 
                <a href="https://github.com/javalin/javalin-samples/tree/main/javalin5/javalinvue-example/javalinvue3-example" target="_blank">GitHub</a>.
                Please fork/clone and look while you read.
            </em>
            
        </p>
        
    </div>
    <div class="post-content" itemprop="articleBody">
        <p>In this tutorial you’ll learn how to create simple frontends with Javalin and Vue.
The tutorial is quite extensive, and covers single-file components, routing, error handling,
application layouts, access management (plus authentication), and state sharing between server and client.</p>

<p>The tutorial is a bit different from what I normally write, as it will be pretty opinionated.
The background section gives a bit of insight as to how I’ve come up with the approach
used in the tutorial, but if you’re just here to learn how to write simple frontends,
you can skip ahead to <a href="#setup">setup</a> section.</p>

<h2 id="background">Background</h2>
<p>I’ve been doing web development for roughly ten years. For server side rendering,
I started with pure HTML (framesets!), then PHP, JSP, JSTL, Twirl (Scala) and finally, Velocity templates (Java).
On the frontend I’ve used jQuery/Zepto, then Knockout, Angular, Meteor, and finally, Vue.
For styling I’ve used Less, SASS (SCSS), and finally CSS variables.
For building I’ve used Bower, NPM and Yarn, Grunt and Gulp, and I’ve configured a total of one Webpack project.</p>

<p>Frontend has come a long way in the last ten years, and declarative/reactive view libraries
are much nicer to work with than the DOM manipulation mess of the past.</p>

<p>But modern frontend architecture is also often hugely (and unnecessarily) complex.
I won’t go into a rant about this, as I won’t move any people in either camp, but this
tutorial will show an alternative approach for creating clean and modern frontends in pure Vue,
without most of the complexity that would normally follow along with it.
There will be no Node, NPM, or Webpack, no state management, reducers, or sagas. No rehydration, no tree shaking,
no code splitting, or endless transitive dependencies. No boilerplate or plumbing code of any kind.</p>

<p>Just business logic.</p>

<h2 id="setup">Setup</h2>
<p>Our backend will be Kotlin, and we’ll be using Maven to build.
We need to bring in Javalin (web server framework).<br />
We’ll also add Vue (view library) for our frontend:</p>

<pre><code class="language-markup">&lt;dependency&gt;
    &lt;groupId&gt;io.javalin&lt;/groupId&gt;
    &lt;artifactId&gt;javalin-bundle&lt;/artifactId&gt;
    &lt;version&gt;5.0.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.webjars.npm&lt;/groupId&gt;
    &lt;artifactId&gt;vue&lt;/artifactId&gt;
    &lt;version&gt;3.2.37&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<div class="comment">
  <p>You can add all frontend dependencies as <a href="https://www.webjars.org/">Webjars</a>, which can be built directly from NPM.
If something is available on NPM, it’s also available as a Webjar, but as a prebuilt dist version (it has no dependencies).</p>
</div>

<p>Now that we have all our dependencies in order, we need to configure our web server.<br />
Let’s create <code class="highlighter-rouge">/src/main/kotlin/javalinvue/JavalinVueExampleApp.kt</code>:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.Javalin</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Javalin</span><span class="p">.</span><span class="n">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
        <span class="n">config</span><span class="p">.</span><span class="n">staticFiles</span><span class="p">.</span><span class="n">enableWebjars</span><span class="p">()</span>
    <span class="p">}.</span><span class="n">start</span><span class="p">(</span><span class="m">7070</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>
</div>

<p>We also need an HTML file to load our frontend dependencies and to initialize Vue.<br />
Let’s create <code class="highlighter-rouge">/src/main/resources/vue/layout.html</code>:</p>

<pre><code class="language-markup">&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="utf8"&gt;
    &lt;script src="/webjars/vue/3.2.37/dist/vue.global.prod.js"&gt;&lt;/script&gt;
    &lt;script&gt;
      const app = Vue.createApp({});
    &lt;/script&gt;
    @componentRegistration
  &lt;/head&gt;
  &lt;body&gt;
  &lt;main id="main-vue" v-cloak&gt;
    @routeComponent
  &lt;/main&gt;
  &lt;script&gt;
    app.mount("#main-vue");
  &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>There are two Javalin specific things here: <code class="highlighter-rouge">@componentRegistration</code> and <code class="highlighter-rouge">@routeComponent</code>.
Javalin’s Vue plugin will scan your <code class="highlighter-rouge">/resources/vue</code> folder and put all your Vue components
into <code class="highlighter-rouge">@componentRegistration</code>, similar to how libraries are loaded via <code class="highlighter-rouge">&lt;script&gt;</code> tags.
Javalin will also let you choose one component to mount based on the current URL,
this is the <code class="highlighter-rouge">@routeComponent</code>.</p>

<h2 id="hello-world">Hello World</h2>
<p>Now that we have a layout file, let’s create <code class="highlighter-rouge">/resources/vue/views/hello-world.vue</code>:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"hello-world"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"hello-world"</span><span class="nt">&gt;</span>Hello, World!<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"hello-world"</span><span class="p">,</span> <span class="p">{</span><span class="na">template</span><span class="p">:</span> <span class="s2">"#hello-world"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.hello-world</span> <span class="p">{</span>
    <span class="nl">color</span><span class="p">:</span> <span class="no">goldenrod</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre>
</div>

<p>We’re telling Vue that we want to register a <code class="highlighter-rouge">hello-world</code> component, and to use the template with the id <code class="highlighter-rouge">hello-world</code>.
We’re also giving the <code class="highlighter-rouge">Hello, World!</code> message a color. Notice how we have all HTML, JavaScript and CSS
for our component encapsulated in the same file.</p>

<p>To display our component to the user, we need to tell Javalin when to show it. Let’s expand our web server with a new route:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.Javalin</span>
<span class="k">import</span> <span class="nn">io.javalin.vue.VueComponent</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="n">Javalin</span><span class="p">.</span><span class="n">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
        <span class="n">config</span><span class="p">.</span><span class="n">staticFiles</span><span class="p">.</span><span class="n">enableWebjars</span><span class="p">()</span>
    <span class="p">}.</span><span class="n">start</span><span class="p">(</span><span class="m">7070</span><span class="p">)</span>

    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"hello-world"</span><span class="p">))</span>
<span class="p">}</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge">@routeComponent</code> that we added in <code class="highlighter-rouge">layout.html</code> earlier will be replaced by the String inside of <code class="highlighter-rouge">VueComponent</code>.
This means a call to <code class="highlighter-rouge">/</code> will load the layout and display our <code class="highlighter-rouge">&lt;hello-world&gt;&lt;/hello-world&gt;</code> component.</p>

<p>Restart the server, go to <code class="highlighter-rouge">http://localhost:7070/</code>, and you’ll see <code class="highlighter-rouge">Hello, World!</code> in a nice goldenrod color.</p>

<div class="comment">
  <p>Note that you don’t have to restart the server when making changes to <code class="highlighter-rouge">.vue</code> files,
Javalin will pick up on those automatically.<br />
The reason we needed to restart now was because we added a new route in the <code class="highlighter-rouge">main</code> function.</p>
</div>

<h2 id="routing-and-error-handling">Routing and error handling</h2>
<p>Now that we know how to create components, let’s look at a very common scenario:
creating an admin interface. Our admin interface should be able to display an overview
of users, and also additional details for one specific user.
This will require two views, and we should probably also include a “Page not found” (404) page.</p>

<p>Let’s change the server by adding the following lines:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/users"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"user-overview"</span><span class="p">))</span>
<span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/users/{user-id}"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"user-profile"</span><span class="p">))</span>
<span class="n">app</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="n">NOT_FOUND</span><span class="p">,</span> <span class="s">"html"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"not-found"</span><span class="p">))</span>

<span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/api/users"</span><span class="p">,</span> <span class="n">UserController</span><span class="o">::</span><span class="n">getAll</span><span class="p">)</span>
<span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/api/users/{user-id}"</span><span class="p">,</span> <span class="n">UserController</span><span class="o">::</span><span class="n">getOne</span><span class="p">)</span>
</code></pre>
</div>

<p>We’ve referenced <code class="highlighter-rouge">UserController</code> in the previous snippet, but that doesn’t exist yet.<br />
So, let’s create <code class="highlighter-rouge">/src/main/kotlin/javalinvue/UserController.kt</code>:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.http.Context</span>
<span class="k">import</span> <span class="nn">io.javalin.http.NotFoundResponse</span>

<span class="kd">data class</span> <span class="nc">User</span><span class="p">(</span><span class="kd">val</span> <span class="py">id</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">name</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">email</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">userDetails</span><span class="p">:</span> <span class="n">UserDetails</span><span class="p">?)</span>
<span class="kd">data class</span> <span class="nc">UserDetails</span><span class="p">(</span><span class="kd">val</span> <span class="py">dateOfBirth</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="kd">val</span> <span class="py">salary</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span>

<span class="kd">val</span> <span class="py">users</span> <span class="p">=</span> <span class="n">setOf</span><span class="p">(</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"1"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"John"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"john@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"21.02.1964"</span><span class="p">,</span> <span class="s">"2773 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"2"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Mary"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"mary@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"12.05.1994"</span><span class="p">,</span> <span class="s">"1222 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"3"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Dave"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"dave@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"01.05.1984"</span><span class="p">,</span> <span class="s">"1833 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"4"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Jane"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"jane@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"30.12.1989"</span><span class="p">,</span> <span class="s">"1532 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"5"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Eric"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"eric@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"14.09.1973"</span><span class="p">,</span> <span class="s">"2131 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"6"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Gina"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"gina@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"16.08.1977"</span><span class="p">,</span> <span class="s">"1982 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"7"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Ryan"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"ryan@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"07.11.1988"</span><span class="p">,</span> <span class="s">"1638 JB"</span><span class="p">)),</span>
    <span class="n">User</span><span class="p">(</span><span class="n">id</span> <span class="p">=</span> <span class="s">"8"</span><span class="p">,</span> <span class="n">name</span> <span class="p">=</span> <span class="s">"Judy"</span><span class="p">,</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"judy@fake.co"</span><span class="p">,</span> <span class="n">userDetails</span> <span class="p">=</span> <span class="n">UserDetails</span><span class="p">(</span><span class="s">"05.01.1959"</span><span class="p">,</span> <span class="s">"2983 JB"</span><span class="p">))</span>
<span class="p">)</span>

<span class="kd">object</span> <span class="nc">UserController</span> <span class="p">{</span>

    <span class="k">fun</span> <span class="nf">getAll</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">ctx</span><span class="p">.</span><span class="n">json</span><span class="p">(</span><span class="n">users</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">userDetails</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">})</span> <span class="c1">// remove sensitive information
</span>    <span class="p">}</span>

    <span class="k">fun</span> <span class="nf">getOne</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">user</span> <span class="p">=</span> <span class="n">users</span><span class="p">.</span><span class="n">find</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">id</span> <span class="p">==</span> <span class="n">ctx</span><span class="p">.</span><span class="n">pathParam</span><span class="p">(</span><span class="s">"user-id"</span><span class="p">)</span> <span class="p">}</span> <span class="o">?:</span> <span class="k">throw</span> <span class="n">NotFoundResponse</span><span class="p">()</span>
        <span class="n">ctx</span><span class="p">.</span><span class="n">json</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre>
</div>

<p>This completes our backend, let’s move on to the frontend. We want three views (user-overview, user-profile, and not-found), so
we should create three separate files in <code class="highlighter-rouge">/src/main/resources/vue/views</code>.<br />
Let’s create <code class="highlighter-rouge">/src/main/resources/vue/views/user-overview.vue</code> first:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"user-overview"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"user-overview-list"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;li</span> <span class="na">v-for=</span><span class="s">"user in users"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;a</span> <span class="na">:href=</span><span class="s">"`/users/${user.id}`"</span><span class="nt">&gt;</span>{{user.name}} ({{user.email}})<span class="nt">&lt;/a&gt;</span>
      <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"user-overview"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">template</span><span class="p">:</span> <span class="s2">"#user-overview"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">users</span><span class="p">:</span> <span class="p">[],</span>
    <span class="p">}),</span>
    <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">fetch</span><span class="p">(</span><span class="s2">"/api/users"</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">users</span> <span class="o">=</span> <span class="nx">res</span><span class="p">)</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Error while fetching users"</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
  <span class="nt">ul</span><span class="nc">.user-overview-list</span> <span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">list-style</span><span class="p">:</span> <span class="nb">none</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">ul</span><span class="nc">.user-overview-list</span> <span class="nt">a</span> <span class="p">{</span>
    <span class="nl">display</span><span class="p">:</span> <span class="nb">block</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">16px</span><span class="p">;</span>
    <span class="nl">border-bottom</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ddd</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">ul</span><span class="nc">.user-overview-list</span> <span class="nt">a</span><span class="nd">:hover</span> <span class="p">{</span>
    <span class="nl">background</span><span class="p">:</span> <span class="m">#00000010</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre>
</div>

<p>It’s a simple component which performs one GET request to the server to fetch the list of users,
then sets the component state. Vue loops through the users and creates a list of links that we can
click to view additional information for one user. We’ve also included a few CSS rules to pretty things up.</p>

<p>Open <code class="highlighter-rouge">http://localhost:7070/users/</code> to view the list of users. If you click on one, a blank page will show.<br />
Let’s fix this by creating <code class="highlighter-rouge">/src/main/resources/vue/views/user-profile.vue</code>:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"user-profile"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;dl</span> <span class="na">v-if=</span><span class="s">"user"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;dt&gt;</span>User ID<span class="nt">&lt;/dt&gt;</span>
      <span class="nt">&lt;dd&gt;</span>{{user.id}}<span class="nt">&lt;/dd&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Name<span class="nt">&lt;/dt&gt;</span>
      <span class="nt">&lt;dd&gt;</span>{{user.name}}<span class="nt">&lt;/dd&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Email<span class="nt">&lt;/dt&gt;</span>
      <span class="nt">&lt;dd&gt;</span>{{user.email}}<span class="nt">&lt;/dd&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Birthday<span class="nt">&lt;/dt&gt;</span>
      <span class="nt">&lt;dd&gt;</span>{{user.userDetails.dateOfBirth}}<span class="nt">&lt;/dd&gt;</span>
      <span class="nt">&lt;dt&gt;</span>Salary<span class="nt">&lt;/dt&gt;</span>
      <span class="nt">&lt;dd&gt;</span>{{user.userDetails.salary}}<span class="nt">&lt;/dd&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"user-profile"</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">template</span><span class="p">:</span> <span class="s2">"#user-profile"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
      <span class="na">user</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">created</span><span class="p">()</span> <span class="p">{</span>
      <span class="kr">const</span> <span class="nx">userId</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$javalin</span><span class="p">.</span><span class="nx">pathParams</span><span class="p">[</span><span class="s2">"user-id"</span><span class="p">];</span>
      <span class="nx">fetch</span><span class="p">(</span><span class="err">`</span><span class="o">/</span><span class="nx">api</span><span class="o">/</span><span class="nx">users</span><span class="o">/</span><span class="nx">$</span><span class="p">{</span><span class="nx">userId</span><span class="p">}</span><span class="err">`</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
        <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">res</span><span class="p">)</span>
        <span class="p">.</span><span class="k">catch</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">"Error while fetching user"</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
</div>

<p>This is pretty similar to our user-overview, but since this is a dynamic route,
we have to ask our router what the current user-id is.
JavalinVue includes path parameters on <code class="highlighter-rouge">$javalin</code> by default
(it also has an optional state parameter we will look at later).</p>

<p>Let’s finish up our views with <code class="highlighter-rouge">/src/main/resources/vue/views/not-found.vue</code>:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"not-found"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;h1&gt;</span>Page not found (error 404)<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"not-found"</span><span class="p">,</span> <span class="p">{</span><span class="na">template</span><span class="p">:</span> <span class="s2">"#not-found"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
</div>

<p>Great, we have all our views ready! …but they don’t look very consistent.<br />
While not strictly related to JavalinVue, let’s add <code class="highlighter-rouge">/src/main/resources/vue/components/app-frame.vue</code>:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"app-frame"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"app-frame"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;header&gt;</span>
      <span class="nt">&lt;span&gt;</span>JavalinVue demo app<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;slot&gt;&lt;/slot&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"app-frame"</span><span class="p">,</span> <span class="p">{</span><span class="na">template</span><span class="p">:</span> <span class="s2">"#app-frame"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;style&gt;</span>
  <span class="nc">.app-frame</span> <span class="o">&gt;</span> <span class="nt">header</span> <span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">background</span><span class="p">:</span> <span class="m">#b6e2ff</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
    <span class="nl">justify-content</span><span class="p">:</span> <span class="n">space-between</span><span class="p">;</span>
    <span class="nl">align-items</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
</code></pre>
</div>

<p>You can use this app-frame by adding <code class="highlighter-rouge">&lt;app-frame&gt;...&lt;/app-frame&gt;</code> as the first child of your component.
The <code class="highlighter-rouge">&lt;slot&gt;&lt;/slot&gt;</code> element will be replaced by the content of the current page.<br />
Here is an example showing the 404 page using the app-frame:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"not-found"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;app-frame&gt;</span>
    <span class="nt">&lt;h1&gt;</span>Page not found (error 404)<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;/app-frame&gt;</span>
<span class="nt">&lt;/template&gt;</span>
<span class="nt">&lt;script&gt;</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s2">"not-found"</span><span class="p">,</span> <span class="p">{</span><span class="na">template</span><span class="p">:</span> <span class="s2">"#not-found"</span><span class="p">});</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre>
</div>

<p>We could have put this frame in <code class="highlighter-rouge">layout.html</code>, but creating a dedicated component for it
gives us the option to have different styles, and keeps the main layout clean.</p>

<p>Now that both the frontend and backend are done, it’s time to make things
more complicated by adding access management to the mix.</p>

<h2 id="access-management">Access Management</h2>
<p>Access management in Javalin is handled by the aptly named <code class="highlighter-rouge">AccessManager</code>. This is a functional interface which takes
a handler function, a HTTP context, and a set of roles. It’s up to the developer to determine if a request is valid.
We will be securing our application using basic-auth for simplicity, but you can use any technique and
identity provider you want with the <code class="highlighter-rouge">AccessManager</code> interface.</p>

<p>First we need to define roles. Some parts of the app should be accessible to everyone (the user-overview and the 404 page), while
other parts should only be available if you log in (the user-profile).<br />
Two roles should be enough: <code class="highlighter-rouge">ANYONE</code> and <code class="highlighter-rouge">LOGGED_IN</code>. We add those roles to the endpoints
(both for the views and the APIs, and create an <code class="highlighter-rouge">AccessManager</code>:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.Javalin</span>
<span class="k">import</span> <span class="nn">io.javalin.security.RouteRole</span>
<span class="k">import</span> <span class="nn">io.javalin.http.Header</span>
<span class="k">import</span> <span class="nn">io.javalin.http.Context</span>
<span class="k">import</span> <span class="nn">io.javalin.http.HttpStatus</span>
<span class="k">import</span> <span class="nn">io.javalin.http.staticfiles.Location</span>
<span class="k">import</span> <span class="nn">io.javalin.vue.JavalinVue</span>
<span class="k">import</span> <span class="nn">io.javalin.vue.VueComponent</span>

<span class="k">enum</span> <span class="kd">class</span> <span class="nc">Role</span> <span class="p">:</span> <span class="n">RouteRole</span> <span class="p">{</span> <span class="n">ANYONE</span><span class="p">,</span> <span class="n">LOGGED_IN</span> <span class="p">}</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

    <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="n">Javalin</span><span class="p">.</span><span class="n">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
        <span class="n">config</span><span class="p">.</span><span class="n">staticFiles</span><span class="p">.</span><span class="n">enableWebjars</span><span class="p">()</span>
        <span class="n">config</span><span class="p">.</span><span class="n">core</span><span class="p">.</span><span class="n">accessManager</span> <span class="p">{</span> <span class="n">handler</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">permittedRoles</span> <span class="p">-&gt;</span>
            <span class="k">when</span> <span class="p">{</span>
                <span class="n">Role</span><span class="p">.</span><span class="n">ANYONE</span> <span class="k">in</span> <span class="n">permittedRoles</span> <span class="p">-&gt;</span> <span class="n">handler</span><span class="p">.</span><span class="n">handle</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                <span class="n">Role</span><span class="p">.</span><span class="n">LOGGED_IN</span> <span class="k">in</span> <span class="n">permittedRoles</span> <span class="p">&amp;&amp;</span> <span class="n">currentUser</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">-&gt;</span> <span class="n">handler</span><span class="p">.</span><span class="n">handle</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">-&gt;</span> <span class="n">ctx</span><span class="p">.</span><span class="n">status</span><span class="p">(</span><span class="m">401</span><span class="p">).</span><span class="n">header</span><span class="p">(</span><span class="n">Header</span><span class="p">.</span><span class="n">WWW_AUTHENTICATE</span><span class="p">,</span> <span class="s">"Basic"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}.</span><span class="n">start</span><span class="p">(</span><span class="m">7070</span><span class="p">)</span>

    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"hello-world"</span><span class="p">),</span> <span class="n">Role</span><span class="p">.</span><span class="n">ANYONE</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/users"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"user-overview"</span><span class="p">),</span> <span class="n">Role</span><span class="p">.</span><span class="n">ANYONE</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/users/{user-id}"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"user-profile"</span><span class="p">),</span> <span class="n">Role</span><span class="p">.</span><span class="n">LOGGED_IN</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="n">error</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="n">NOT_FOUND</span><span class="p">,</span> <span class="s">"html"</span><span class="p">,</span> <span class="n">VueComponent</span><span class="p">(</span><span class="s">"not-found"</span><span class="p">))</span>

    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/api/users"</span><span class="p">,</span> <span class="n">UserController</span><span class="o">::</span><span class="n">getAll</span><span class="p">,</span> <span class="n">Role</span><span class="p">.</span><span class="n">ANYONE</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/api/users/{user-id}"</span><span class="p">,</span> <span class="n">UserController</span><span class="o">::</span><span class="n">getOne</span><span class="p">,</span> <span class="n">Role</span><span class="p">.</span><span class="n">LOGGED_IN</span><span class="p">)</span>

<span class="p">}</span>

<span class="k">private</span> <span class="k">fun</span> <span class="nf">currentUser</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">basicAuthCredentials</span><span class="p">()</span><span class="o">?.</span><span class="n">username</span>
</code></pre>
</div>

<p>This is just an example, our authentication isn’t exactly secure. As long as the user enters
<strong>anything</strong> in the basic-auth username field, we log the user in. We completely ignore the password.</p>

<h2 id="server-side-state">Server Side State</h2>
<p>Now that we can log users in, it would be nice if the client knew the current user.
Our server knows, so we need to transfer this knowledge somehow.
This can be solved by setting a JavalinVue state function:</p>

<div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">JavalinVue</span><span class="p">.</span><span class="n">stateFunction</span> <span class="p">=</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="n">mapOf</span><span class="p">(</span><span class="s">"currentUser"</span> <span class="n">to</span> <span class="n">currentUser</span><span class="p">(</span><span class="n">ctx</span><span class="p">))</span> <span class="p">}</span>
</code></pre>
</div>

<p>This line of code sets a function that will run for every <code class="highlighter-rouge">VueComponent</code>, so all components will now
have access to the current user (if there is one). Since basic-auth works per directory, the frame will only
show the current user for <code class="highlighter-rouge">http://localhost:7070/users/</code> (the user-overview) and its subpaths (the individual profiles).
Let’s add it to <code class="highlighter-rouge">app-frame.vue</code>:</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;template</span> <span class="na">id=</span><span class="s">"app-frame"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"app-frame"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;header&gt;</span>
      <span class="nt">&lt;span&gt;</span>JavalinVue demo app<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;span</span> <span class="na">v-if=</span><span class="s">"$javalin.state.currentUser"</span><span class="nt">&gt;</span>Current user: '{{$javalin.state.currentUser}}'<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;/header&gt;</span>
    <span class="nt">&lt;slot&gt;&lt;/slot&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/template&gt;</span>
</code></pre>
</div>

<h2 id="conclusion">Conclusion</h2>
<p>We’ve created a fully working (but pretty limited) admin interface with only a few files.</p>
<ul>
  <li><code class="highlighter-rouge">JavalinVueExampleApp.kt</code> contains the server config (routes, error handlers, access management)</li>
  <li><code class="highlighter-rouge">UserController.kt</code> contains the list of fake users, and methods to get them (getAll, getOne)</li>
  <li><code class="highlighter-rouge">layout.html</code> loads the frontend dependencies and initializes Vue</li>
  <li><code class="highlighter-rouge">app-frame.vue</code> has a header and some global styling which is included in all components</li>
  <li><code class="highlighter-rouge">user-overview.vue</code> displays a list of users</li>
  <li><code class="highlighter-rouge">user-profile.vue</code> displays additional details for one user (requires login)</li>
  <li><code class="highlighter-rouge">not-found.vue</code> displays a 404 error page</li>
  <li><code class="highlighter-rouge">pom.xml</code> contains all our dependencies</li>
</ul>

<p>Since our frontend dependencies are prepacked WebJars, we don’t need NPM, and we don’t need to
manage any frontend libraries manually. The project structure is very clean:</p>

<div class="compressed-code">
  <div class="language-kotlin highlighter-rouge"><pre class="highlight"><code><span class="n">javalinvue</span><span class="p">-</span><span class="n">example</span>
<span class="err">├───</span><span class="n">src</span>
<span class="err">│</span>   <span class="err">└───</span> <span class="n">main</span>
<span class="err">│</span>       <span class="err">└───</span><span class="n">kotlin</span>
<span class="err">│</span>           <span class="err">├───</span><span class="n">javalinvue</span>
<span class="err">│</span>           <span class="err">│</span>   <span class="err">├───</span><span class="n">UserController</span><span class="p">.</span><span class="n">kt</span>
<span class="err">│</span>           <span class="err">│</span>   <span class="err">└───</span><span class="n">Main</span><span class="p">.</span><span class="n">kt</span>
<span class="err">│</span>           <span class="err">└───</span><span class="n">resources</span>
<span class="err">│</span>               <span class="err">├───</span><span class="n">components</span>
<span class="err">│</span>               <span class="err">│</span>   <span class="err">└───</span><span class="n">app</span><span class="p">-</span><span class="n">frame</span><span class="p">.</span><span class="n">vue</span>
<span class="err">│</span>               <span class="err">├───</span><span class="n">components</span>
<span class="err">│</span>               <span class="err">│</span>   <span class="err">├───</span><span class="n">not</span><span class="p">-</span><span class="n">found</span><span class="p">.</span><span class="n">vue</span>
<span class="err">│</span>               <span class="err">│</span>   <span class="err">├───</span><span class="n">user</span><span class="p">-</span><span class="n">overview</span><span class="p">.</span><span class="n">vue</span>
<span class="err">│</span>               <span class="err">│</span>   <span class="err">└───</span><span class="n">user</span><span class="p">-</span><span class="n">profile</span><span class="p">.</span><span class="n">vue</span>
<span class="err">│</span>               <span class="err">└───</span><span class="n">layout</span><span class="p">.</span><span class="n">html</span>
<span class="err">└───</span><span class="n">pom</span><span class="p">.</span><span class="n">xml</span>
</code></pre>
  </div>
  <style>.compressed-code .highlighter-rouge pre code { line-height: 1.2; }</style>

</div>

<p>That’s about it. The Afterword contains a bit more discussion about this technique,
but similarly to the Background section you can skip it if you’re not that interested. <strong>Thanks for reading</strong>!</p>

<h3 id="afterword">Afterword</h3>
<p>The architecture described in this tutorial has a lot of the benefits of a modern frontend.
We have full client side rendering, no DOM manipulation, and we’re able to use Vue fully (we even have single-file components).
We don’t have any client side routing though. We have one Vue instance per page (per server side route),
which makes state management a lot easier. Each view is responsible for its own state, and that’s it.
The app is built from scratch every time the user navigates on the website.
Shared state (signed-in-user, current-theme, etc) can be set on server side, and is included in all views.</p>

<p>We’re missing out on a few nice things. We can’t hot reload the content of a component or inject new styles, we
have to manually refresh the page to see changes. Changes are picked up instantly though, so a refresh typically takes ~10ms.</p>

<p>I’m running a couple of apps with this setup in production. The biggest one is a
customer-portal with 30 components and 25 views (pages), and the total weight of all the
components is only 20kb (100kb before GZIP). It’s been running for a year, and I’ve been
waiting for issues and flaws to present themselves, but I haven’t seen any yet.</p>

<div class="comment" style="margin-top:16px;font-size:14px;">
  <p>Update, October 2022: The app has been running for four years without
any issues. It’s now using the <code class="highlighter-rouge">JavalinVue.optimizeDependencies</code> config option, which
is enabled by default for Javalin 4+. This brings the average request size down to about 8kb gzipped.</p>
</div>

<p>Performance is pretty good. The app loads fast and never flickers. Below you see the
Chrome audit results for the 30 component + 25 view app that I mentioned earlier:</p>

<p><img src="/img/posts/javalinvue/performance.png" alt="App performance" class="bordered-image" /></p>

<h3 id="pros-and-cons">Pros and Cons</h3>

<p>Pros</p>
<ul>
  <li>Minimal prerequisites - a backend developer can be productive within minutes by just reading the Vue docs.
No knowledge of the current JavaScript ecosystem is required.</li>
  <li>No boilerplate</li>
  <li>Single file components</li>
  <li>No complex build pipelines or transitive dependencies</li>
  <li>No state management required</li>
  <li>Good performance</li>
  <li>Can easily copy-paste from docs (Vue docs use CDN in their examples, while most projects use Webpack)</li>
  <li>Server side routing</li>
</ul>

<p>Cons</p>
<ul>
  <li>Can’t run unit tests for components</li>
  <li>No transpiling (can’t use the latest JS features without code breaking in old browsers)</li>
  <li>No hot-reload or style injection</li>
  <li>You miss out on a lot of the JS ecosystem (could also be considered a pro)</li>
  <li>Need a Kotlin/Java server for your frontend</li>
  <li>Tight coupling between server and client</li>
</ul>

<p>I’ve created <a href="https://github.com/tipsy/javalinvue-example/issues/1">an issue on GitHub</a>
where you can post your pros/cons, or general comments on the tutorial.</p>

    </div>
    <h3>Thanks for reading</h3>
    If you find any errors, please <a href="https://github.com/javalin/javalin.github.io/blob/master/_posts/tutorials/2019-07-31-simple-frontends-with-javalin-and-vue.md">edit this page on GitHub</a>.
    <br>
    
        The full source code for this tutorial can also be found on <a href="https://github.com/javalin/javalin-samples/tree/main/javalin5/javalinvue-example/javalinvue3-example">GitHub</a>.
    
</article>
<style>
    .social {
        margin: 30px 0;
        display: flex;
    }
    .social-btn {
        text-align: center;
        min-width: 240px;
        padding: 10px 16px 8px;
        font-size: 14px;
        font-family: 'Roboto Slab', sans-serif;
        font-weight: 600;
        color: #fff;
        background: #000;
        border-radius: 50px;
        box-shadow: 2px 2px red, -2px -2px cyan;
    }
    .social-btn + .social-btn {
        margin-left: 24px;
    }
    .social-btn:hover {
        background: #008ab4;
    }
    .social-btn img {
        width: 24px;
        display: inline;
        vertical-align: middle;
        margin-right: 12px;
    }
    @media (max-width: 480px) {
        .social {
            justify-content: space-between;
        }
        .social-btn {
            min-width: 0;
            width: calc(50% - 12px);
            text-align: left;
            display: flex;
            align-items: center;
        }
        .social-btn + .social-btn {
            margin-left: 0;
        }
    }
</style>
<div class="social">
    <a class="social-btn" href="https://twitter.com/intent/tweet?text=Clean Vue frontends without the hassle&url=/tutorials/simple-frontends-with-javalin-and-vue&via=javalin_io&related=javalin_io"
       rel="nofollow"
       title="Share on Twitter">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAM1BMVEUAAAD///////////////////////////////////////////////////////////////+3leKCAAAAEHRSTlMA8BDQwKCAMOBwYECwUCCQ27fl2AAAAW1JREFUWMPtltuOwyAMRLG5QxL8/1+7G6lKFApMaJ5W2/NIPCPAnlL15R+xRSM7ZPMnci5yYvxrNRt3VMRtpPdBLqR9MWkhPkpI80BPUpFy2dfiUbKK9B02kjbmrCkycNAdfeCqpuOQOnrye2teRS9LrxqEjn4tQSS/io7Fxg1Kn/MWjxX7dgw30NvGNkO9CQP1O8v7oGEDq07i9Uu+YxAvs1J91GmDBtdQLVKjYz6/YINNWujiVgsMet3CqAr7yICKn3XQF4N9gizJDAsIDMSBLkIyyDzkmjqmWb0GoYUUBVKLWFUF6yk9gccDYtU7bKabWBNv9yKoDunmTcSW2Im+uwNi1cBP5+DjUSAGrzgiVcLZSBmlHjnQBv7L4AOMYEdwiAGcFgK/A5BN9/WsMCs90nsjT/SrGd0fI3UJIIIdovtlAUnWftA5KwiKakg2Y7ljfPn9tzWkUw5GsHV059UEOVpDR2wXl1l9+RP8AHA4c7ljId3mAAAAAElFTkSuQmCC">Share on Twitter
    </a>
    <a class="social-btn" href="https://facebook.com/sharer.php?u=/tutorials/simple-frontends-with-javalin-and-vue"
       rel="nofollow"
       title="Share on Facebook">
        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABABAMAAABYR2ztAAAAMFBMVEUAAAD///////////////////////////////////////////////////////////87TQQwAAAAD3RSTlMAwIDwEEDgMKBgINBwUJA4su2wAAAAy0lEQVRIx2MYJICr+T9WkOQAVTD/Pw5gDpHn/I8TXAAriMetwAqsQB63gh9gBf/xgAFT8E0QCPJxK/ixACTqj1PB5wCwKD9OBbsY8Cv4XEBAwU8GAgoECCmYABTB5QuEUI2S0n4cCn6DRBzxhORHkMh5Qgr0h7eCjw6I/BiPTcEnBgRgxKbgK5ICPkIKmGij4C+yIwn5gg2bgm9ICuIHa2SNKqCZgs9gBf2YClBTkDNuBSlgBeyYCtDKzGJcCtKhyY+lH7sCIweGwQEAY2jNUu1+zZgAAAAASUVORK5CYII=">Share on Facebook
    </a>
</div>


    </main>
    <footer>
        Javalin is a Java and Kotlin web framework, open sourced under the
        <a href="https://tldrlegal.com/license/apache-license-2.0-(apache-2.0)">Apache 2</a> license
        | <a href="/download">Download</a>
        | <a href="/about">About</a>
        | <a href="/news">News</a>
        | <a href="/about#contact">Contact</a>
        | <a href="/for-educators">For educators</a>
    </footer>
    <div id="star-begging">
    <style>
        #star-begging {
            transition: transform .25s;
            transform: scale(0);
            border-radius: 8px;
            position: fixed;
            bottom: 32px;
            right: 32px;
            padding: 20px 40px 16px 20px;
            background: #fff;
            box-shadow: 0 1px 20px rgba(0, 0, 0, 0.15);
            z-index: 9999998;
        }
        #star-begging.in {
            transform: scale(1);
        }
        #star-begging.out {
            transform: translateX(400px);
        }
        #star-begging p {
            font-size: 16px;
            margin: 0 0 15px;
        }
        #star-begging .close {
            position: absolute;
            right: 20px;
            top: 20px;
            height: 40px;
            width: 40px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-family: arial, sans-serif;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }
    </style>
    <p>
        Like Javalin?
        <br>Star us 😊
    </p>
    <span class="close">×</span>
    <iframe id="starFrame" class="githubStar" title="github-stars"
            src="https://ghbtns.com/github-btn.html?user=javalin&amp;repo=javalin&amp;type=star&amp;count=true&size=large"
            frameborder="0" scrolling="0" width="150px" height="30px">
    </iframe>
    <script>
        if (localStorage.getItem("dismissed") !== "true" && document.getElementById("notification-banner") === null) {
            setTimeout(function () {
                document.querySelector("#star-begging").classList.add("in");
            }, 15000);
            document.querySelector("#star-begging .close").addEventListener("click", function () {
                document.querySelector("#star-begging").classList.add("out");
                localStorage.setItem("dismissed", "true");
            });
        }
    </script>
</div>

    <script src="/js/scripts.js"></script>
</body>
</html>
