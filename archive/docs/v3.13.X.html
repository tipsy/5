<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-54137818-11"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'UA-54137818-11', {'anonymize_ip': true});
</script>
    <meta charset="utf-8">
    <link href="https://fonts.googleapis.com/css?family=Oxygen+Mono|Roboto+Slab:500,700&display=swap" rel="stylesheet">
    <meta property="og:title" content="Archive - v3 documentation - Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:site_name" content="Javalin">
    <meta property="og:url" content="https://javalin.io">
    <meta property="og:description" content="Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <meta property="og:image" content="https://javalin.io/img/javalin.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="liMtSlffOZROWLqoiOZdSx-luH9_Siq5-Ot6xqHZwq8">
    <title>
        Archive - v3 documentation - Javalin - A lightweight Java and Kotlin web framework
    </title>
    <meta name="description" content="Javalin - A lightweight Java and Kotlin web framework. Create REST APIs in Java or Kotlin easily.">
    <link rel="canonical" href="https://zugazagoitia.github.io/archive/docs/v3.13.X.html">
    <link rel="shortcut icon" type="image/png" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/main.css">
    <style>/* Styles that affect the length of the document */
p code,
li code {
    font-size: 90%;
    letter-spacing: -0.5px;
    border: 1px solid #ccd;
    background: #f5f5f7;
    padding: 1px 3px;
}

.multitab-code pre {
    margin-top: 0;
    border-radius: 0 0 5px 5px;
}

.multitab-code div[data-tab] {
    display: none;
}

:target {
    scroll-margin-top: 108px;
}

.anchorjs-link {
    transition: all .25s linear;
  }
  
*:hover > .anchorjs-link {
    margin-left: -1.125em !important;
 }</style>
</head>
<body>
    <a id="fork-me" href="https://github.com/javalin/javalin" target="_blank">
    <img style="position:fixed;top:0;right:0;border:0;z-index:99999" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJUAAACVCAMAAABmfEh9AAAAllBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPEhwAAAAFBgkAAAARFR8fIiwRFB4YHCUQEx0RFB4SFiERFB8QEx3s7e4eIStPUlpKTFUvMjwOEhs8P0hfYmlXWmE5PUUZHSfd3uAnKjTAwcRnanB2eH5CRU6TlZqxs7bP0NKFh4yUlpqipKiUlpujpKiipKdzB4/DAAAAFXRSTlMAAwgBDREiKBYbL5wdQBjb3ZzclY3cWcIvAAAGZ0lEQVR42u2c3W7bMAyF02bL2q5bu7WLqDhW7Si24p902/u/3EglljxXQX1jixclsIv0QvhAHvAQZLJFF8vl1dX19afn/Ub9ej+2L5ufd6v725vPn66vr66ulsvFBOGoPj/LLJHvY8kkf/j2ZTUtlqe6ed6+JCOytX/ZPCLW/aRYnur2aZeo3QisjXogrO+TYjmq1ROqZgQWlvpxaiyisljf71dP+yQfJflk8mwtfbK+/NhnmxGSx1L/nBhraZP1ySbr7sc2O4xrEIMiTpqsu6+7zWGU5PNpi0hUfaxRkl9jqR9nxZLjJJ8d5s3W/mWU5Dfq56xY4z1x3iJuxnrinFg/xnrizJLfJZeLuMboJK9mbxDyIpPjkpvD48ySz4NQLpwnzopFY2CYqfzti7ibXfLZIQQlSoBjT1sRJL8bUgmCaiyWHwOjemKXqVIWYDwWljqmJ56h6jSVfyR+YOGJlCpbvipNhXBUbgycVfKqR3UuX0JUGNE8kcZA2VEphMLyZdIYabGieeJX74mYKyNEmiYaQCuLFdMTcy8sIUSuwWT6lYpI4SUfwRM9Vk1lbLQYYO3m90TVyxa1hgqqVEmHFdkTCaLRWQVa5rrAdMla+WzNPwYeXLaUBihyVBfUUhaAVh1zDNx1yZJllpLk20IWzqjjeaJXfK5J8ghVuQYRzxNdtpoOKt0674kjeVqNdFjqBAUatLJUMT3x0GtbCFXAqymVK2GkMZA80WH9gaqFLbVSGwxWI1ZbRhSFEAGsaKsRy7GFVlgsZT8yWI1YqkKtiUrpo+sPzhPjrEYsFv4jKGiMw/JjYCxPpCCotoDSYnFYjVgqRV3eQNNhRfdEwtoSVK51A+2wiBsVbww0BAWZBC08VuTVCAkroXQl8DdFLD6eaMCmK9+bTLzxxIdonqgIqixpGJTRPdGNgYIknwG0GZT4kcW5gLBQ8g0UugRzVhaLMVCIFF5lAXq7tsHhXGCxdCNlUboJItYYSEXMlOvxJTRK9AabqOeCg+ywslbYSExyIovuiQRxnpuPAICDDY/VSId1hCKrQHVtnsVqZJ1AIdMSTJqc2zyL1YiBhBr9voLOfTisRkqoMg2mAizksEHk8TwRxU5QhdGwdZKPey6wA7PZViQurOW6i/irESEMQckGc+UjqidaAtEiVAGtEJ7KST6KJ67dDuLYdfrWyp7BamTdnqFkDRj2vMJgNbI2lDFKmW6zGtqe5OOcC7z7EFSxRbhae6r1PoviiV71BhpJh6iyPCk++oXMUmm0HwyB8bvlcC74dXJqZLLZSkD/3yDirUYkNGmaN3maJsJkwmJFXo2c+kPdApi0hDaV557K4FyATFAilM6roupafTRPlJ3eZXGCMgAVZuuo4nnifuM9UQmCkgWQY1fQSPpjrNWIz5Y6QVVlhVBaifieaLFKldZ01SeoPBVSRfXEXYclEqgt1On0oxHrwmrEUU05BjptQZNQprStZf/uIwee6F6bYwwsa0nly7UmKHHxWyOeap4x0ICmFg9WWvSX4DcpHdWUReydC2StTpe7WuZdkw+sRgYPTrcacZonKF2i2nOkCntij2omTxQERWovpNsmvfl1weC56TzR33wwS9S5ZFoqGrjK3hioHk5Yg9em9ESnLZUa6lwlNFIc7br5/3PB7c3gsUk90WurAWnNOq3cDrzvibfDxyYdAx1WDcZ0UKStwbngPvDcHOeCGk5QUGSOynviKvDaHGOgqBHKb2wGP6i5Cz43xwldpd3GJnAuWIRj+hO6MABJKvu58p4YemtiT/RYr0b3Tyte8oGX5pK8qAGg9WL3sV1cjum/NVKabjk5iMvPTbwa6e//IlBdWo14qAhU75wLkCkC1bs/qIlFFfZEBlSBMZADVcgTGVCFJM+A6o3kk5wDVWg1woAq4IkcqEKeyIAq4Ik7BlSBMZADVWgMZEAV8EQOVCFPZEAV8EQOVAFP5EAV8kQGVIHVCAeqt5LfSAZUAU/kQBX6JiUDqtBqhAFVwBM5UIU8kQHVW8krDlShcwEDqoAncqAaYqEncqAaYpEnMqD6D2v15QnHQA5Ufaz71eqJxsAFg/BY35HriXbIHMJhEdftM+6QWUSHRVw3+L+VLXhEh4VcGM8LJnHGQjCKBZcgLOKysWATiEXBjAqxiMvGglEsMfhRWS4bC3bBk+ojPuIjPiIc/wAQkAE6ZqHsywAAAABJRU5ErkJggg==" alt="Fork me on GitHub">
</a>
    <header class="top-nav-header">
        <nav class="width-limit">
            <a id="logo" href="/" aria-label="Javalin">
                <img src="/img/logo.svg" alt="Javalin">
            </a>
            <ul>
                <li><a href="/documentation">Docs</a></li>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/plugins">Plugins</a></li>
                <li><a href="/community">Community</a></li>
            </ul>
        </nav>
    </header>
    <main class="width-limit has-right-menu">
                <script>
    const notificationId = "javalin-5-released";
    const hasBeenDismissed = localStorage.getItem(notificationId + "-dismissed") === "true";
    const pageLoadCount = parseInt(localStorage.getItem(notificationId + "-count") || 0);
    localStorage.setItem(notificationId + "-count", (pageLoadCount + 1).toString());
    if (!hasBeenDismissed && pageLoadCount >= 0) {
        document.write(`
            <div id="notification-banner">
                <h1>Javalin 5 is out!</h1>
                Javalin 5 stable is finally here!
                Read more in the <a href="/news/javalin-5.0.0-stable.html">release post</a>.
            </div>
        `);
        if (pageLoadCount >= 0) {
            document.querySelector("#notification-banner").insertAdjacentHTML("beforeend", `<span class="close">×</span>`);
            document.querySelector("#notification-banner .close").addEventListener("click", () => {
                document.querySelector("#notification-banner").style.display = "none";
                localStorage.setItem(notificationId + "-dismissed", "true");
            });
        }
    }
</script>

<style>
    #notification-banner {
        line-height: 1.5;
        position: fixed;
        bottom: 32px;
        right: 32px;
        width: 360px;
        z-index: 9999999;
        background: linear-gradient(20deg, #29292d 30%, #008cbb);
        color: white;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
        font-size: 16px;
        border-radius: 8px;
        padding: 24px;
    }

    #notification-banner h1 {
        line-height: 1;
        margin: 0 0 20px 0;
        font-family: 'Encode Sans', sans-serif;
        font-weight: 400;
        font-size: 22px;
        text-decoration: underline;
    }

    #notification-banner a {
        font-weight: 700;
        border: 1px solid white;
        padding: 1px 3px;
        background: white;
        color: #333;
        border-radius: 3px;
        margin: 0 2px;
    }

    #notification-banner .close {
        position: absolute;
        right: 14px;
        top: 14px;
        height: 40px;
        width: 40px;
        line-height: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 28px;
        font-family: arial, sans-serif;
        cursor: pointer;
        background: rgba(0, 0, 0, 0.15);
        border-radius: 5px;
    }

    @media (max-width: 480px) {
        #notification-banner {
            border-radius: 0;
            width: 100%;
            right: 0;
            bottom: 0;
            font-size: 14px;
        }
    }
</style>

<div id="spy-nav" class="right-menu">
  <ul>
    <li><a href="#getting-started">Getting Started</a></li>
    <li><a href="#handlers">HTTP Handlers</a>
      <ul>
        <li><a href="#before-handlers">Before</a></li>
        <li><a href="#endpoint-handlers">Endpoint</a></li>
        <li><a href="#after-handlers">After</a></li>
        <li><a href="#context">Context (ctx)</a></li>
      </ul>
    </li>
    <li><a href="#websockets">WebSockets</a>
      <ul>
        <li><a href="#wsbefore">Before</a></li>
        <li><a href="#wsendpoint">Endpoint</a></li>
        <li><a href="#wsafter">After</a></li>
        <li><a href="#wscontext">Context (ctx)</a></li>
      </ul>
    </li>
    <li><a href="#handler-groups">Handler groups</a></li>
    <li><a href="#validation">Validation</a></li>
    <li><a href="#access-manager">Access manager</a></li>
    <li><a href="#default-responses">Default responses</a></li>
    <li><a href="#exception-mapping">Exception Mapping</a></li>
    <li><a href="#error-mapping">Error Mapping</a></li>
    <li><a href="#server-sent-events">Server-sent Events</a></li>
    <li><a href="#configuration">Configuration</a>
      <ul>
        <li><a href="#static-files">Static Files</a></li>
        <li><a href="#single-page-mode">Single page mode</a></li>
        <li><a href="#logging">Logging</a></li>
        <li><a href="#server-setup">Server setup</a></li>
      </ul>
    </li>
    <li><a href="#lifecycle-events">Lifecycle events</a></li>
    <li><a href="#plugins">Plugins</a></li>
    <li><a href="#modules">Modules</a></li>
    <li><a href="#faq">FAQ</a></li>
  </ul>
</div>

<h1 class="no-margin-top">Documentation - Javalin 3.X</h1>

<p>This page contains documentation for an older version of Javalin.
Go to <a href="/documentation">javalin.io/documentation</a> to view documentation for the newest version.</p>

<div class="star-us">
    <div>
        <span id="starUsLong">If you want to support Javalin, consider sponsoring or starring:</span>
        <span id="starUsShort">Support Javalin?</span>
    </div>
    <a class="sponsor-button" href="https://github.com/sponsors/tipsy">
    <svg width="24" height="24" viewBox="0 0 24 24">
        <path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z" />
    </svg>
    Sponsor Javalin
</a>
<style>
    .sponsor-button {
        margin: 0 12px;
        display: flex;
        align-items: center;
        color: rgba(0, 0, 0, 0.7);
        background: #ffe8e8;
        border: 1px solid #ffb5b5;
        border-radius: 30px;
        padding: 4px 12px;
        font-weight: 500;
        font-family: 'Roboto Slab', sans-serif;
        transition: all .15s ease-in-out;
    }

    .sponsor-button:hover {
        color: rgba(0, 0, 0, 0.8);
        background: #ffe0e0;
    }

    .sponsor-button svg {
        transition: all .15s ease-in-out;
        margin-right: 8px;
    }

    .sponsor-button svg path {
        fill: #ff6363;
    }

    .sponsor-button:hover svg {
        transform: scale(1.15);
    }
</style>

    <iframe id="starFrame" class="githubStar" src="https://ghbtns.com/github-btn.html?user=javalin&amp;repo=javalin&amp;type=star&amp;count=true&amp;size=large" frameborder="0" scrolling="0" width="150px" height="35px">
    </iframe>
</div>
<style>
    .star-us {
        display: flex;
        align-items: center;
        padding: 24px;
        margin: 40px 0;
        font-family: 'Roboto Slab', sans-serif;
        font-weight: 500;
        background: white;
        border-radius: 24px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.1);
        border-bottom: 2px solid #ff6363;
    }

    #starUsShort {
        font-size: 15px;
        letter-spacing: -0.5px;
        font-weight: bold;
        display: none;
    }

    @media (max-width: 700px) {
        #starUsLong {
            display: none;
        }

        #starUsShort {
            display: block;
        }
    }

    @media (max-width: 480px) {
        .star-us {
            flex-direction: column;
        }
        .star-us * + * {
            margin-top: 12px;
        }
        .star-us #starUsShort {
            font-size: 20px;
        }
    }
</style>

<h2 id="getting-started">Getting started</h2>

<p>Add the dependency:</p>
<div class="multitab-code dependencies" data-tab="1">
<ul>
    <li data-tab="1">Maven</li>
    <li data-tab="2">Gradle</li>
    <li data-tab="3">SBT</li>
    <li data-tab="4">Grape</li>
    <li data-tab="5">Leiningen</li>
    <li data-tab="6">Buildr</li>
    <li data-tab="7">Ivy</li>
</ul>

<div data-tab="1">
    <pre><code class="language-markup">&lt;dependency&gt;
    &lt;groupId&gt;io.javalin&lt;/groupId&gt;
    &lt;artifactId&gt;javalin&lt;/artifactId&gt;
    &lt;version&gt;5.0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
    <p>Not familiar with Maven? Read our <a href="/tutorials/maven-setup">Maven tutorial</a>.</p>
  </div>

<div data-tab="2">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">implementation</span><span class="o">(</span><span class="s">"io.javalin:javalin:5.0.1"</span><span class="o">)</span>
</code></pre></div>    </div>
    <p>Not familiar with Gradle? Read our <a href="/tutorials/gradle-setup">Gradle tutorial</a>.</p>
  </div>

<div data-tab="3">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"io.javalin"</span> <span class="o">%</span> <span class="s">"javalin"</span> <span class="o">%</span> <span class="s">"5.0.1"</span>
</code></pre></div>    </div>
  </div>

<div data-tab="4">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Grab</span><span class="o">(</span><span class="n">group</span><span class="o">=</span><span class="err">'</span><span class="n">io</span><span class="o">.</span><span class="na">javalin</span><span class="err">'</span><span class="o">,</span> <span class="n">module</span><span class="o">=</span><span class="err">'</span><span class="n">javalin</span><span class="err">'</span><span class="o">,</span> <span class="n">version</span><span class="o">=</span><span class="err">'</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">1</span><span class="err">'</span><span class="o">)</span>
</code></pre></div>    </div>
  </div>

<div data-tab="5">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span><span class="n">io</span><span class="o">.</span><span class="na">javalin</span><span class="o">/</span><span class="n">javalin</span> <span class="s">"5.0.1"</span><span class="o">]</span>
</code></pre></div>    </div>
  </div>

<div data-tab="6">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">'</span><span class="n">io</span><span class="o">.</span><span class="na">javalin</span><span class="o">:</span><span class="nl">javalin:jar:</span><span class="mf">5.0</span><span class="o">.</span><span class="mi">1</span><span class="err">'</span>
</code></pre></div>    </div>
  </div>

<div data-tab="7">
    <pre><code class="language-markup">&lt;dependency org="io.javalin" name="javalin" rev="5.0.1" /&gt;
</code></pre>
  </div>
</div>

<div class="bundle-hint">
  <p>If you want Javalin with testing tools, Jackson and Logback,
you can use the artifact id <code class="language-plaintext highlighter-rouge">javalin-bundle</code> instead of <code class="language-plaintext highlighter-rouge">javalin</code>.</p>
</div>
<style>
.bundle-hint p {
    margin-top: 8px;
    font-size: 14px;
}
</style>

<p>Start coding:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">io.javalin.Javalin</span><span class="o">;</span>

<span class="no">THIS</span> <span class="no">STILL</span> <span class="no">DOES</span> <span class="no">NOT</span> <span class="no">COMPILE</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloWorld</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="cm">/*config*/</span><span class="o">)</span>
            <span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">))</span>
            <span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="mi">7070</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.Javalin</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="cm">/*config*/</span><span class="p">)</span>
        <span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Hello World"</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">.</span><span class="nf">start</span><span class="p">(</span><span class="mi">7070</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h2 id="handlers">Handlers</h2>
<p>Javalin has three main handler types: before-handlers, endpoint-handlers, and after-handlers.
(There are also exception-handlers and error-handlers, but we’ll get to them later).
The before-, endpoint- and after-handlers require three parts:</p>

<ul>
  <li>A verb, one of: <code class="language-plaintext highlighter-rouge">before</code>, <code class="language-plaintext highlighter-rouge">get</code>, <code class="language-plaintext highlighter-rouge">post</code>, <code class="language-plaintext highlighter-rouge">put</code>, <code class="language-plaintext highlighter-rouge">patch</code>, <code class="language-plaintext highlighter-rouge">delete</code>, <code class="language-plaintext highlighter-rouge">after</code> <small>(… <code class="language-plaintext highlighter-rouge">head</code>, <code class="language-plaintext highlighter-rouge">options</code>, <code class="language-plaintext highlighter-rouge">trace</code>, <code class="language-plaintext highlighter-rouge">connect</code>)</small></li>
  <li>A path, ex: <code class="language-plaintext highlighter-rouge">/</code>, <code class="language-plaintext highlighter-rouge">/hello-world</code>, <code class="language-plaintext highlighter-rouge">/hello/:name</code></li>
  <li>A handler implementation <code class="language-plaintext highlighter-rouge">ctx -&gt; { ... }</code></li>
</ul>

<p>The <code class="language-plaintext highlighter-rouge">Handler</code> interface has a void return type. You use <code class="language-plaintext highlighter-rouge">ctx.result()</code> to set the response which will be returned to the user.</p>

<p>You can learn more about how Javalin handles concurrency in <a href="#concurrency">FAQ - Concurrency</a>.</p>

<h3 id="before-handlers">Before handlers</h3>
<p>Before-handlers are matched before every request (including static files, if you enable those).</p>
<div class="comment">You might know before-handlers as filters, interceptors, or middleware from other libraries.</div>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">before</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs before all requests</span>
<span class="o">});</span>
<span class="n">app</span><span class="o">.</span><span class="na">before</span><span class="o">(</span><span class="s">"/path/*"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs before request to /path/*</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">before</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// runs before all requests</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="s">"/path/*"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// runs before request to /path/*</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="endpoint-handlers">Endpoint handlers</h3>
<p>Endpoint-handlers are matched in the order they are defined.</p>
<div class="comment">You might know endpoint-handlers as routes or middleware from other libraries.</div>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// some code</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">json</span><span class="o">(</span><span class="n">object</span><span class="o">);</span>
<span class="o">});</span>

<span class="n">app</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// some code</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="mi">201</span><span class="o">);</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// some code</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">json</span><span class="p">(</span><span class="k">object</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// some code</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">201</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Handler paths can include path-parameters. These are available via <code class="language-plaintext highlighter-rouge">ctx.pathParam("key")</code>:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/hello/:name"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Hello: "</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="s">"name"</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/hello/:name"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Hello: "</span> <span class="p">+</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">pathParam</span><span class="p">(</span><span class="s">"name"</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Handler-paths can also include wildcard parameters (splats). These are available via <code class="language-plaintext highlighter-rouge">Context.splat()</code></p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/hello/*/and/*"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Hello: "</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">.</span><span class="na">splat</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">+</span> <span class="s">" and "</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">.</span><span class="na">splat</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/hello/*/and/*"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Hello: "</span> <span class="p">+</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">splat</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">+</span> <span class="s">" and "</span> <span class="p">+</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">splat</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="after-handlers">After handlers</h3>
<p>After-handlers run after every request (even if an exception occurred)</p>
<div class="comment">You might know after-handlers as filters, interceptors, or middleware from other libraries.</div>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">after</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// run after all requests</span>
<span class="o">});</span>
<span class="n">app</span><span class="o">.</span><span class="na">after</span><span class="o">(</span><span class="s">"/path/*"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs after request to /path/*</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">after</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// run after all requests</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="nf">after</span><span class="p">(</span><span class="s">"/path/*"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// runs after request to /path/*</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="context">Context</h3>
<p>The <code class="language-plaintext highlighter-rouge">Context</code> object provides you with everything you need to handle a http-request.
It contains the underlying servlet-request and servlet-response, and a bunch of getters
and setters. The getters operate mostly on the request-object, while the setters operate exclusively on
the response object.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">appAttribute</span><span class="o">(</span><span class="kd">class</span><span class="err">)</span>                 <span class="err">//</span> <span class="nc">get</span> <span class="n">an</span> <span class="n">attribute</span> <span class="n">set</span> <span class="n">on</span> <span class="n">the</span> <span class="n">app</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="kd">class</span><span class="err">,</span> <span class="nc">object</span><span class="o">)</span>             <span class="c1">// register an extension on the context</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">use</span><span class="o">(</span><span class="kd">class</span><span class="err">)</span>                          <span class="err">//</span> <span class="nc">use</span> <span class="n">an</span> <span class="n">extension</span> <span class="n">on</span> <span class="n">the</span> <span class="n">context</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                    <span class="c1">// get cookie store value</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>             <span class="c1">// set a cookie store value</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">clearCookieStore</span><span class="o">()</span>                  <span class="c1">// clear the cookie store</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">matchedPath</span><span class="o">()</span>                       <span class="c1">// path that was used to match request (also includes before/after paths)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">endpointHandlerPath</span><span class="o">()</span>               <span class="c1">// endpoint path that was used to match request (null in before, available in after)</span>

<span class="c1">// Request methods</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">body</span><span class="o">()</span>                              <span class="c1">// get body as string (consumes underlying request body if not cached)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">bodyAsBytes</span><span class="o">()</span>                       <span class="c1">// get body as bytes (consumes underlying request body if not cached)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">bodyAsClass</span><span class="o">(</span><span class="kd">class</span><span class="err">)</span>                  <span class="err">//</span> <span class="nc">get</span> <span class="n">body</span> <span class="n">as</span> <span class="nf">class</span> <span class="o">(</span><span class="n">consumes</span> <span class="n">underlying</span> <span class="n">request</span> <span class="n">body</span> <span class="k">if</span> <span class="n">not</span> <span class="n">cached</span><span class="o">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">bodyValidator</span><span class="o">(</span><span class="kd">class</span><span class="err">)</span>                <span class="err">//</span> <span class="nc">get</span> <span class="n">typed</span> <span class="n">validator</span> <span class="k">for</span> <span class="nf">body</span> <span class="o">(</span><span class="n">consumes</span> <span class="n">underlying</span> <span class="n">body</span> <span class="n">request</span> <span class="k">if</span> <span class="n">not</span> <span class="n">cached</span><span class="o">)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">uploadedFile</span><span class="o">(</span><span class="n">name</span><span class="o">)</span>                  <span class="c1">// get uploaded file by name</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">uploadedFiles</span><span class="o">(</span><span class="n">name</span><span class="o">)</span>                 <span class="c1">// get uploaded file(s) by name</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                      <span class="c1">// get form parameter</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">default</span><span class="o">)</span>             <span class="c1">// get form parameter (or default value)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">)</span>               <span class="err">//</span> <span class="nc">get</span> <span class="n">form</span> <span class="n">parameter</span> <span class="n">as</span> <span class="kd">class</span>
<span class="nc">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">,</span> <span class="nc">default</span><span class="o">)</span>      <span class="c1">// get form parameter (or default value) as class</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">formParams</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                     <span class="c1">// get form parameters (multiple)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">formParamMap</span><span class="o">()</span>                      <span class="c1">// get form parameter map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                      <span class="c1">// get path parameter</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">)</span>               <span class="err">//</span> <span class="nc">get</span> <span class="n">path</span> <span class="n">as</span> <span class="kd">class</span>
<span class="nc">ctx</span><span class="o">.</span><span class="na">pathParamMap</span><span class="o">()</span>                      <span class="c1">// get path parameter map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">splat</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>                           <span class="c1">// get splat by index, ex "/*" -&gt; splat(0)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">splats</span><span class="o">();</span>                           <span class="c1">// get array of splat-values</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">basicAuthCredentials</span><span class="o">()</span>              <span class="c1">// get basic auth credentials (username/pwd)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">basicAuthCredentialsExist</span><span class="o">()</span>         <span class="c1">// check if proper basic auth credentials exist</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">attribute</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>               <span class="c1">// set request attribute</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">attribute</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                      <span class="c1">// get request attribute</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">attributeMap</span><span class="o">()</span>                      <span class="c1">// get request attribute map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">contentLength</span><span class="o">()</span>                     <span class="c1">// get request content length</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">contentType</span><span class="o">()</span>                       <span class="c1">// get request content type</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookie</span><span class="o">(</span><span class="n">name</span><span class="o">)</span>                        <span class="c1">// get request cookie</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookieMap</span><span class="o">()</span>                         <span class="c1">// get request cookie map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="n">header</span><span class="o">)</span>                      <span class="c1">// get request header</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">headerMap</span><span class="o">()</span>                         <span class="c1">// get request header map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">host</span><span class="o">()</span>                              <span class="c1">// get request host</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">ip</span><span class="o">()</span>                                <span class="c1">// get request ip address</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">isMultipart</span><span class="o">()</span>                       <span class="c1">// check if request is multipart</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">isMultipartFormData</span><span class="o">()</span>               <span class="c1">// check if request is multipart/form data</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">method</span><span class="o">()</span>                            <span class="c1">// get request method</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">path</span><span class="o">()</span>                              <span class="c1">// get request path</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">port</span><span class="o">()</span>                              <span class="c1">// get request port</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">protocol</span><span class="o">()</span>                          <span class="c1">// get request protocol</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                     <span class="c1">// get query parameter</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">default</span><span class="o">)</span>            <span class="c1">// get query parameter (or default value)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">)</span>              <span class="err">//</span> <span class="nc">get</span> <span class="n">query</span> <span class="n">parameter</span> <span class="n">as</span> <span class="kd">class</span>
<span class="nc">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">,</span> <span class="nc">default</span><span class="o">)</span>     <span class="c1">// get query parameter (or default value) as class</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParams</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>                    <span class="c1">// get query parameters (multiple)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParamMap</span><span class="o">()</span>                     <span class="c1">// get query parameter map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryString</span><span class="o">()</span>                       <span class="c1">// get query string</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">scheme</span><span class="o">()</span>                            <span class="c1">// get request scheme</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>        <span class="c1">// set session attribute (server side attribute)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>               <span class="c1">// get session attribute</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttributeMap</span><span class="o">()</span>               <span class="c1">// get attribute map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">url</span><span class="o">()</span>                               <span class="c1">// get request url</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">fullUrl</span><span class="o">()</span>                           <span class="c1">// get request url + query param</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">contextPath</span><span class="o">()</span>                       <span class="c1">// get request context path</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">userAgent</span><span class="o">()</span>                         <span class="c1">// get request user agent</span>

<span class="c1">// Response methods</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="n">resultString</span><span class="o">)</span>                <span class="c1">// set a string result that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">resultString</span><span class="o">()</span>                      <span class="c1">// get the string result that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="n">resultStream</span><span class="o">)</span>                <span class="c1">// set a stream result that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="n">byteArray</span><span class="o">)</span>                   <span class="c1">// set a byte[] result that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">resultStream</span><span class="o">()</span>                      <span class="c1">// get the stream that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="n">future</span><span class="o">)</span>                      <span class="c1">// set a future result that will be sent to the client (async)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">resultFuture</span><span class="o">()</span>                      <span class="c1">// get the future result that will be sent to the client</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">seekableStream</span><span class="o">(</span><span class="n">resultStream</span><span class="o">)</span>        <span class="c1">// set a stream that will be sent to the client in byte ranges</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">contentType</span><span class="o">(</span><span class="n">contentType</span><span class="o">)</span>            <span class="c1">// set the response content type</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>                 <span class="c1">// set a response header</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">redirect</span><span class="o">(</span><span class="n">location</span><span class="o">)</span>                  <span class="c1">// send a redirect response to location</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">redirect</span><span class="o">(</span><span class="n">location</span><span class="o">,</span> <span class="n">httpStatusCode</span><span class="o">)</span>  <span class="c1">// send a redirect response to location with status code</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="n">statusCode</span><span class="o">)</span>                  <span class="c1">// set response status</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">()</span>                            <span class="c1">// get response status</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookie</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>                 <span class="c1">// set cookie by name and value</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">)</span>                      <span class="c1">// set cookie</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">removeCookie</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">path</span><span class="o">)</span>            <span class="c1">// remove a cookie</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">html</span><span class="o">(</span><span class="n">html</span><span class="o">)</span>                          <span class="c1">// call result(string).contentType("text/html")</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">json</span><span class="o">(</span><span class="n">obj</span><span class="o">)</span>                           <span class="c1">// call result(JavalinJson.toJson(obj)).contentType("application/json")</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">json</span><span class="o">(</span><span class="n">future</span><span class="o">)</span>                        <span class="c1">// call result(future(JavalinJson.toJson(future))).contentType("application/json")</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">model</span><span class="o">)</span>             <span class="c1">// call html(JavalinRenderer.render(filePath, model)</span>
</code></pre></div></div>

<h4 id="cookie-store">Cookie Store</h4>

<p>The <code class="language-plaintext highlighter-rouge">ctx.cookieStore()</code> functions provide a convenient way for sharing information between handlers, request, or even servers:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span> <span class="c1">// store any type of value</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="n">key</span><span class="o">);</span> <span class="c1">// read any type of value</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">clearCookieStore</span><span class="o">();</span> <span class="c1">// clear the cookie-store</span>
</code></pre></div></div>
<p>The cookieStore works like this:</p>
<ol>
  <li>The first handler that matches the incoming request will populate the cookie-store-map with the data currently stored in the cookie (if any).</li>
  <li>This map can now be used as a state between handlers on the same request-cycle, pretty much in the same way as <code class="language-plaintext highlighter-rouge">ctx.attribute()</code></li>
  <li>At the end of the request-cycle, the cookie-store-map is serialized, base64-encoded and written to the response as a cookie.
This allows you to share the map between requests and servers (in case you are running multiple servers behind a load-balancer)</li>
</ol>

<h5 id="example">Example:</h5>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serverOneApp</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/cookie-storer"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"string"</span><span class="o">,</span> <span class="s">"Hello world!"</span><span class="o">);</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"i"</span><span class="o">,</span> <span class="mi">42</span><span class="o">);</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"list"</span><span class="o">,</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"One"</span><span class="o">,</span> <span class="s">"Two"</span><span class="o">,</span> <span class="s">"Three"</span><span class="o">));</span>
<span class="o">});</span>
<span class="n">serverTwoApp</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/cookie-reader"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="c1">// runs on a different server than serverOneApp</span>
    <span class="nc">String</span> <span class="n">string</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"string"</span><span class="o">)</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"i"</span><span class="o">)</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">cookieStore</span><span class="o">(</span><span class="s">"list"</span><span class="o">)</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">serverOneApp</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s">"/cookie-storer"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">cookieStore</span><span class="p">(</span><span class="s">"string"</span><span class="p">,</span> <span class="s">"Hello world!"</span><span class="p">)</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">cookieStore</span><span class="p">(</span><span class="s">"i"</span><span class="p">,</span> <span class="mi">42</span><span class="p">)</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">cookieStore</span><span class="p">(</span><span class="s">"list"</span><span class="p">,</span> <span class="nf">listOf</span><span class="p">(</span><span class="s">"One"</span><span class="p">,</span> <span class="s">"Two"</span><span class="p">,</span> <span class="s">"Three"</span><span class="p">))</span>
<span class="p">}</span>
<span class="n">serverTwoApp</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/cookie-reader"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="c1">// runs on a different server than serverOneApp</span>
    <span class="kd">val</span> <span class="py">string</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">cookieStore</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;(</span><span class="s">"string"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">i</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">cookieStore</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"i"</span><span class="p">)</span>
    <span class="kd">val</span> <span class="py">list</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">cookieStore</span><span class="p">&lt;</span><span class="nc">List</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;&gt;(</span><span class="s">"list"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Since the client stores the cookie, the <code class="language-plaintext highlighter-rouge">get</code> request to <code class="language-plaintext highlighter-rouge">serverTwoApp</code>
will be able to retrieve the information that was passed in the <code class="language-plaintext highlighter-rouge">post</code> to <code class="language-plaintext highlighter-rouge">serverOneApp</code>.</p>

<p>Please note that cookies have a max-size of 4kb.</p>

<h4 id="context-extensions">Context extensions</h4>
<p>Context extensions give Java developers a way of extending the <code class="language-plaintext highlighter-rouge">Context</code> object.</p>

<p>One of the most popular features of Kotlin is <a href="https://kotlinlang.org/docs/reference/extensions.html">extension functions</a>.
When working with an object you don’t own in Java, you often end up making <code class="language-plaintext highlighter-rouge">MyUtil.action(object, ...)</code>.
If you, for example, want to serialize an object and set it as the result on the <code class="language-plaintext highlighter-rouge">Context</code>, you might do:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">MyMapperUtil</span><span class="o">.</span><span class="na">serialize</span><span class="o">(</span><span class="n">ctx</span><span class="o">,</span> <span class="n">myMapper</span><span class="o">,</span> <span class="n">myObject</span><span class="o">));</span> <span class="c1">// three args, what happens where?</span>
</code></pre></div></div>

<p>With context extensions you can add custom extensions on the context:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">use</span><span class="o">(</span><span class="nc">MyMapper</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">serialize</span><span class="o">(</span><span class="n">object</span><span class="o">));</span> <span class="c1">// use MyMapper to serialize object</span>
</code></pre></div></div>

<p>Context extensions have to be added before you can use them, this would typically be done in the first <code class="language-plaintext highlighter-rouge">before</code> filter of your app:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">before</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="nc">MyMapper</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="nc">MyMapper</span><span class="o">(</span><span class="n">ctx</span><span class="o">,</span> <span class="n">otherDependency</span><span class="o">));</span>
</code></pre></div></div>

<h2 id="websockets">WebSockets</h2>

<p>Javalin has a very intuitive way of handling WebSockets. You declare an endpoint
with a path and configure the different event handlers in a lambda:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">ws</span><span class="o">(</span><span class="s">"/websocket/:path"</span><span class="o">,</span> <span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onConnect</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Connected"</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">ws</span><span class="p">(</span><span class="s">"/websocket/:path"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onConnect</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Connected"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>There are a total of five events supported:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ws</span><span class="o">.</span><span class="na">onConnect</span><span class="o">(</span><span class="nc">WsConnectContext</span><span class="o">)</span>
<span class="n">ws</span><span class="o">.</span><span class="na">onError</span><span class="o">(</span><span class="nc">WsErrorContext</span><span class="o">)</span>
<span class="n">ws</span><span class="o">.</span><span class="na">onClose</span><span class="o">(</span><span class="nc">WsCloseContext</span><span class="o">)</span>
<span class="n">ws</span><span class="o">.</span><span class="na">onMessage</span><span class="o">(</span><span class="nc">WsMessageContext</span><span class="o">)</span>
<span class="n">ws</span><span class="o">.</span><span class="na">onBinaryMessage</span><span class="o">(</span><span class="nc">WsBinaryMessageContext</span><span class="o">)</span>
</code></pre></div></div>

<p>The different flavors of <code class="language-plaintext highlighter-rouge">WsContext</code> expose different things, for example,
<code class="language-plaintext highlighter-rouge">WsMessageContext</code> has the method <code class="language-plaintext highlighter-rouge">.message()</code> which gives you the message that the client sent.
The differences between the different contexts is small, and a full overview can be seen in the <a href="#wscontext">WsContext</a> section.</p>

<p>You can learn more about how Javalin handles WebSocket concurrency in <a href="#concurrency">FAQ - Concurrency</a>.</p>

<h3 id="wsbefore">WsBefore</h3>
<p>The <code class="language-plaintext highlighter-rouge">app.wsBefore</code> adds a handler that runs before a WebSocket handler.
You can have as many before-handlers as you want per WebSocket endpoint, and all events are supported.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">wsBefore</span><span class="o">(</span><span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs before all WebSocket requests</span>
<span class="o">});</span>
<span class="n">app</span><span class="o">.</span><span class="na">wsBefore</span><span class="o">(</span><span class="s">"/path/*"</span><span class="o">,</span> <span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs before websocket requests to /path/*</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">wsBefore</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="c1">// runs before all WebSocket requests</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="nf">wsBefore</span><span class="p">(</span><span class="s">"/path/*"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="c1">// runs before websocket requests to /path/*</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="wsendpoint">WsEndpoint</h3>
<p>A WebSocket endpoint is declared with <code class="language-plaintext highlighter-rouge">app.ws(path, handler)</code>. WebSocket handlers require unique paths.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">ws</span><span class="o">(</span><span class="s">"/websocket/:path"</span><span class="o">,</span> <span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onConnect</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Connected"</span><span class="o">));</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onMessage</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="nc">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span> <span class="c1">// convert from json</span>
        <span class="n">ctx</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">user</span><span class="o">);</span> <span class="c1">// convert to json and send back</span>
    <span class="o">});</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onBinaryMessage</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Message"</span><span class="o">))</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onClose</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Closed"</span><span class="o">));</span>
    <span class="n">ws</span><span class="o">.</span><span class="na">onError</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Errored"</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">ws</span><span class="p">(</span><span class="s">"/websocket/:path"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onConnect</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Connected"</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onMessage</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
        <span class="kd">val</span> <span class="py">user</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">message</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;();</span> <span class="c1">// convert from json</span>
        <span class="n">ctx</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">user</span><span class="p">);</span> <span class="c1">// convert to json and send back</span>
    <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onBinaryMessage</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Message"</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onClose</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Closed"</span><span class="p">)</span> <span class="p">}</span>
    <span class="n">ws</span><span class="p">.</span><span class="nf">onError</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Errored"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="wsafter">WsAfter</h3>
<p>The <code class="language-plaintext highlighter-rouge">app.wsAfter</code> adds a handler that runs after a WebSocket handler.
You can have as many after-handlers as you want per WebSocket endpoint, and all events are supported.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">wsAfter</span><span class="o">(</span><span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs after all WebSocket requests</span>
<span class="o">});</span>
<span class="n">app</span><span class="o">.</span><span class="na">wsAfter</span><span class="o">(</span><span class="s">"/path/*"</span><span class="o">,</span> <span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// runs after websocket requests to /path/*</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">wsAfter</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="c1">// runs after all WebSocket requests</span>
<span class="p">}</span>
<span class="n">app</span><span class="p">.</span><span class="nf">wsAfter</span><span class="p">(</span><span class="s">"/path/:path"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ws</span> <span class="p">-&gt;</span>
    <span class="c1">// runs after websocket requests to /path/*</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h2 id="wscontext">WsContext</h2>
<p>The <code class="language-plaintext highlighter-rouge">WsContext</code> object provides you with everything you need to handle a websocket-request.
It contains the underlying websocket session and servlet-request, and convenience methods for sending
messages to the client.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">matchedPath</span><span class="o">()</span>            <span class="c1">// get the path used to match this request, ex "/path/:param"</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">object</span><span class="o">)</span>             <span class="c1">// send an object as JSON (string message)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">string</span><span class="o">)</span>             <span class="c1">// send a string message</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="n">byteBuffer</span><span class="o">)</span>         <span class="c1">// send a bytebuffer message</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">queryString</span><span class="o">()</span>            <span class="c1">// get the query string</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParamMap</span><span class="o">()</span>          <span class="c1">// get a map of the query parameters</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParams</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>         <span class="c1">// get query parameters by key</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>          <span class="c1">// get query parameter by key</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="k">default</span><span class="o">)</span> <span class="c1">// get query parameter (or default value)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">)</span>   <span class="err">//</span> <span class="nc">get</span> <span class="n">query</span> <span class="n">parameter</span> <span class="n">as</span> <span class="kd">class</span>

<span class="nc">ctx</span><span class="o">.</span><span class="na">pathParamMap</span><span class="o">()</span>           <span class="c1">// get path parameter map</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>           <span class="c1">// get path parameter</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="kd">class</span><span class="err">)</span>    <span class="err">//</span> <span class="nc">get</span> <span class="n">path</span> <span class="n">parameter</span> <span class="n">as</span> <span class="kd">class</span>

<span class="nc">ctx</span><span class="o">.</span><span class="na">host</span><span class="o">()</span>                   <span class="c1">// get the host</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>              <span class="c1">// get request header</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">headerMap</span><span class="o">()</span>              <span class="c1">// get a map of the request headers</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">cookie</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>              <span class="c1">// get request cookie</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">cookieMap</span><span class="o">()</span>              <span class="c1">// get a map of all request cookies</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">attribute</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">)</span>    <span class="c1">// set request attribute</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">attribute</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>           <span class="c1">// get request attribute</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">attributeMap</span><span class="o">()</span>           <span class="c1">// get a map of request attributes</span>

<span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttribute</span><span class="o">(</span><span class="n">key</span><span class="o">)</span>    <span class="c1">// get request session attribute (from when WebSocket upgrade was performed)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">sessionAttributeMap</span><span class="o">()</span>    <span class="c1">// get a map of session attributes (from when WebSocket upgrade was performed)</span>
</code></pre></div></div>

<h3 id="wsmessagecontext">WsMessageContext</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">()</span> <span class="c1">// String (String)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="nc">MyObject</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="c1">// T (T)</span>
</code></pre></div></div>

<h3 id="wsbinarymessagecontext">WsBinaryMessageContext</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">data</span><span class="o">()</span> <span class="c1">// Byte[] (Array&lt;Byte&gt;)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">offset</span><span class="o">()</span> <span class="c1">// int (Int)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="c1">// int (Int)</span>
</code></pre></div></div>

<h3 id="wsclosecontext">WsCloseContext</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">()</span> <span class="c1">// int (Int)</span>
<span class="n">ctx</span><span class="o">.</span><span class="na">reason</span><span class="o">()</span> <span class="c1">// String or null (String?)</span>
</code></pre></div></div>

<h3 id="wserrorcontext">WsErrorContext</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">error</span><span class="o">()</span> <span class="c1">// Throwable or null (Throwable?)</span>
</code></pre></div></div>

<h3 id="wsconnectcontext">WsConnectContext</h3>
<p>Doesn’t add anything to the base WsContext</p>

<h2 id="handler-groups">Handler groups</h2>
<p>You can group your endpoints by using the <code class="language-plaintext highlighter-rouge">routes()</code> and <code class="language-plaintext highlighter-rouge">path()</code> methods. <code class="language-plaintext highlighter-rouge">routes()</code> creates
a temporary static instance of Javalin so you can skip the <code class="language-plaintext highlighter-rouge">app.</code> prefix before your handlers.</p>

<p>You can import all the HTTP methods with <code class="language-plaintext highlighter-rouge">import static io.javalin.apibuilder.ApiBuilder.*</code>.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">routes</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">path</span><span class="o">(</span><span class="s">"users"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">get</span><span class="o">(</span><span class="nl">UserController:</span><span class="o">:</span><span class="n">getAllUsers</span><span class="o">);</span>
        <span class="n">post</span><span class="o">(</span><span class="nl">UserController:</span><span class="o">:</span><span class="n">createUser</span><span class="o">);</span>
        <span class="n">path</span><span class="o">(</span><span class="s">":id"</span><span class="o">,</span> <span class="o">()</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="n">get</span><span class="o">(</span><span class="nl">UserController:</span><span class="o">:</span><span class="n">getUser</span><span class="o">);</span>
            <span class="n">patch</span><span class="o">(</span><span class="nl">UserController:</span><span class="o">:</span><span class="n">updateUser</span><span class="o">);</span>
            <span class="n">delete</span><span class="o">(</span><span class="nl">UserController:</span><span class="o">:</span><span class="n">deleteUser</span><span class="o">);</span>
        <span class="o">});</span>
        <span class="n">ws</span><span class="o">(</span><span class="s">"events"</span><span class="o">,</span> <span class="nl">userController:</span><span class="o">:</span><span class="n">webSocketEvents</span><span class="o">);</span>
    <span class="o">});</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">routes</span> <span class="p">{</span>
    <span class="nf">path</span><span class="p">(</span><span class="s">"users"</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">get</span><span class="p">(</span><span class="nc">UserController</span><span class="o">::</span><span class="n">getAllUsers</span><span class="p">)</span>
        <span class="nf">post</span><span class="p">(</span><span class="nc">UserController</span><span class="o">::</span><span class="n">createUser</span><span class="p">)</span>
        <span class="nf">path</span><span class="p">(</span><span class="s">":id"</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">get</span><span class="p">(</span><span class="nc">UserController</span><span class="o">::</span><span class="n">getUser</span><span class="p">)</span>
            <span class="nf">patch</span><span class="p">(</span><span class="nc">UserController</span><span class="o">::</span><span class="n">updateUser</span><span class="p">)</span>
            <span class="nf">delete</span><span class="p">(</span><span class="nc">UserController</span><span class="o">::</span><span class="n">deleteUser</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="nf">ws</span><span class="p">(</span><span class="s">"events"</span><span class="p">,</span> <span class="nc">UserController</span><span class="o">::</span><span class="n">webSocketEvents</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Note that <code class="language-plaintext highlighter-rouge">path()</code> prefixes your paths with <code class="language-plaintext highlighter-rouge">/</code> (if you don’t add it yourself).<br />
This means that <code class="language-plaintext highlighter-rouge">path("api", ...)</code> and <code class="language-plaintext highlighter-rouge">path("/api", ...)</code> are equivalent.</p>

<h3 id="crudhandler">CrudHandler</h3>
<p>The <code class="language-plaintext highlighter-rouge">CrudHandler</code> is an interface that can be used within a <code class="language-plaintext highlighter-rouge">routes()</code> call:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">routes</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">crud</span><span class="o">(</span><span class="s">"users/:user-id"</span><span class="o">,</span> <span class="k">new</span> <span class="nc">UserController</span><span class="o">());</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">routes</span> <span class="p">{</span>
    <span class="nf">crud</span><span class="p">(</span><span class="s">"users/:user-id"</span><span class="p">,</span> <span class="nc">UserController</span><span class="p">())</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>It implements the five most common crud operations:</p>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">CrudHandler</span> <span class="p">{</span>
    <span class="nf">getAll</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="nf">getOne</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">)</span>
    <span class="nf">create</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="nf">update</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">)</span>
    <span class="nf">delete</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">resourceId</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="validation">Validation</h2>
<p>You can access Javalin’s <code class="language-plaintext highlighter-rouge">Validator</code> class through the query parameter, path parameter, header, and
body methods. Query parameters and form parameters can be given a default value for the case when a
parameter is not present. Path parameters and headers cannot have default values.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Query Parameters</span>
<span class="c1">// example url: /example?exampleId=123&amp;color=blue&amp;size=1&amp;ts=1584647077000</span>
<span class="nc">String</span> <span class="n">color</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"color"</span><span class="o">);</span> <span class="c1">// blue</span>
<span class="kt">int</span> <span class="n">exampleId</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"exampleId"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span> <span class="c1">// 123</span>
<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"size"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">check</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">();</span> <span class="c1">// exception</span>
<span class="kt">int</span> <span class="n">qty</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"qty"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"12"</span><span class="o">).</span><span class="na">get</span><span class="o">();</span> <span class="c1">// uses default value 12</span>
<span class="nc">Instant</span> <span class="n">instant</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"ts"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// Path Parameters</span>
<span class="c1">// example url: /example/:exampleId/:name/:quantity/:timestamp-ms</span>
<span class="nc">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="s">"name"</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">exampleId</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="s">"exampleId"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">quantity</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="s">"quantity"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">check</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="nc">Instant</span> <span class="n">instant</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">pathParam</span><span class="o">(</span><span class="s">"timestamp-ms"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// Form Parameters</span>
<span class="nc">String</span> <span class="n">color</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="s">"color"</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">exampleId</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="s">"exampleId"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">size</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="s">"size"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">check</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">qty</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">formParam</span><span class="o">(</span><span class="s">"qty"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="s">"12"</span><span class="o">).</span><span class="na">get</span><span class="o">();</span> <span class="c1">// may default to value 12</span>
<span class="nc">Instant</span> <span class="n">instant</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"ts"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// Headers</span>
<span class="nc">String</span> <span class="n">exampleHeaderStr</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Example"</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">version</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Version"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="kt">int</span> <span class="n">version</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"Version"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">check</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="nc">MyValue</span> <span class="n">myValue</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">header</span><span class="o">(</span><span class="s">"X-My-Header"</span><span class="o">,</span> <span class="nc">MyValue</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// Body Validation</span>
<span class="nc">MyObject</span> <span class="n">myObject</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">bodyValidator</span><span class="o">(</span><span class="nc">MyObject</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>

</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Query Parameters</span>
<span class="c1">// example url: /example?exampleId=123&amp;color=blue&amp;size=1&amp;ts=1584647077000</span>
<span class="kd">val</span> <span class="py">color</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">queryParam</span><span class="p">(</span><span class="s">"color"</span><span class="p">)</span> <span class="c1">// blue</span>
<span class="kd">val</span> <span class="py">exampleId</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"exampleId"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span> <span class="c1">// 123</span>
<span class="kd">val</span> <span class="py">size</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"size"</span><span class="p">).</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span> <span class="p">&gt;</span> <span class="mi">4</span> <span class="p">}).</span><span class="k">get</span><span class="p">();</span> <span class="c1">// exception</span>
<span class="kd">val</span> <span class="py">qty</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"qty"</span><span class="p">,</span> <span class="s">"12"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span> <span class="c1">// uses default value 12</span>
<span class="kd">val</span> <span class="py">instant</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Instant</span><span class="p">&gt;(</span><span class="s">"ts"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>

<span class="c1">// Path Parameters</span>
<span class="c1">// example url: /example/:exampleId/:name/:quantity/:timestamp-ms</span>
<span class="kd">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">pathParam</span><span class="p">(</span><span class="s">"name"</span><span class="p">)</span>
<span class="kd">val</span> <span class="py">exampleId</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">pathParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"exampleId"</span><span class="p">).</span><span class="k">get</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">quantity</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">pathParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"quantity"</span><span class="p">).</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span> <span class="p">&gt;</span> <span class="mi">4</span> <span class="p">}).</span><span class="k">get</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">instant</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">pathParam</span><span class="p">&lt;</span><span class="nc">Instant</span><span class="p">&gt;(</span><span class="s">"timestamp-ms"</span><span class="p">).</span><span class="k">get</span><span class="p">()</span>

<span class="c1">// Form Parameters</span>
<span class="kd">val</span> <span class="py">color</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">formParam</span><span class="p">(</span><span class="s">"color"</span><span class="p">);</span>
<span class="kd">val</span> <span class="py">exampleId</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">formParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"exampleId"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>
<span class="kd">val</span> <span class="py">size</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">formParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"size"</span><span class="p">).</span><span class="nf">check</span><span class="p">(</span><span class="n">i</span> <span class="p">-&gt;</span> <span class="n">i</span> <span class="p">&gt;</span> <span class="mi">4</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>
<span class="kd">val</span> <span class="py">qty</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">formParam</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"qty"</span><span class="p">,</span> <span class="s">"12"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span> <span class="c1">// may default to value 12</span>
<span class="kd">val</span> <span class="py">instant</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Instant</span><span class="p">&gt;(</span><span class="s">"ts"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>

<span class="c1">// Headers</span>
<span class="kd">val</span> <span class="py">exampleHeaderStr</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">header</span><span class="p">(</span><span class="s">"Example"</span><span class="p">);</span>
<span class="kd">val</span> <span class="py">version</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">header</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"Version"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>
<span class="kd">val</span> <span class="py">version</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">header</span><span class="p">&lt;</span><span class="nc">Int</span><span class="p">&gt;(</span><span class="s">"Version"</span><span class="p">).</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span> <span class="p">&gt;</span> <span class="mi">4</span> <span class="p">}).</span><span class="k">get</span><span class="p">();</span>
<span class="kd">val</span> <span class="py">myValue</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">header</span><span class="p">&lt;</span><span class="nc">MyValue</span><span class="p">&gt;(</span><span class="s">"X-My-Header"</span><span class="p">).</span><span class="k">get</span><span class="p">();</span>

<span class="c1">// Body Validation</span>
<span class="kd">val</span> <span class="py">myObject</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">bodyValidator</span><span class="p">&lt;</span><span class="nc">MyObject</span><span class="p">&gt;();</span>

</code></pre></div>    </div>
  </div>
</div>

<h3 id="validator-nullability">Validator Nullability</h3>
<p>If null is a valid value for your parameter, you can use <code class="language-plaintext highlighter-rouge">getOrNull()</code> instead of <code class="language-plaintext highlighter-rouge">get()</code>.</p>

<h3 id="validator-error-collection">Validator Error Collection</h3>
<p>By default when accessing a value that has failed checks it will throw an exception on the first failed check.
If you instead want to collect all failures (such as to return errors to be displayed on a form) you can
access them with <code class="language-plaintext highlighter-rouge">errors()</code> which returns a map where the key is the value being checked (the param value in
the case of headers, query params and path values) and the value is a list of error messages.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Validator</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">stringValidator</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"first_name"</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">n</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="s">"-"</span><span class="o">),</span> <span class="s">"cannot contain hyphens."</span><span class="o">)</span>
    <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">,</span> <span class="s">"cannot be longer than 10 characters."</span><span class="o">);</span>

<span class="c1">//Empty map if no errors, otherwise a map with the key "first_name" and failed check messages in the list.</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">errors</span> <span class="o">=</span> <span class="n">stringValidator</span><span class="o">.</span><span class="na">errors</span><span class="o">();</span>

<span class="c1">// Merges all errors from all validators in the list. Empty map if no errors exist.</span>
<span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">manyErrors</span> <span class="o">=</span> <span class="nc">Validator</span><span class="o">.</span><span class="na">collectErrors</span><span class="o">(</span><span class="n">stringValidator</span><span class="o">,</span> <span class="n">otherValidator</span><span class="o">,</span> <span class="n">etc</span><span class="o">)</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">stringValidator</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;(</span><span class="s">"first_name"</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">check</span><span class="p">({</span> <span class="p">!</span><span class="n">it</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="s">"-"</span><span class="p">)</span> <span class="p">},</span> <span class="s">"cannot contain hyphens."</span><span class="p">)</span>
    <span class="p">.</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span><span class="p">.</span><span class="n">length</span> <span class="p">&lt;</span> <span class="mi">10</span> <span class="p">},</span> <span class="s">"cannot be longer than 10 characters."</span><span class="p">)</span>

<span class="c1">//Empty map if no errors, otherwise a map with the key "first_name" and failed check messages in the list.</span>
<span class="kd">val</span> <span class="py">errors</span> <span class="p">=</span> <span class="n">stringValidator</span><span class="p">.</span><span class="nf">errors</span><span class="p">()</span>

<span class="c1">// Merges all errors from all validators in the list. Empty map if no errors exist.</span>
<span class="kd">val</span> <span class="py">manyErrors</span> <span class="p">=</span> <span class="nf">listOf</span><span class="p">(</span><span class="n">stringValidator</span><span class="p">,</span> <span class="n">otherValidator</span><span class="p">,</span> <span class="n">etc</span><span class="p">)</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="custom-converters">Custom converters</h3>
<p>If you need to convert non-included class, you have to register a custom converter:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinValidation</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">v</span> <span class="o">-&gt;</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">ofEpochMilli</span><span class="o">(</span><span class="n">v</span><span class="o">.</span><span class="na">toLong</span><span class="o">());</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinValidation</span><span class="p">.</span><span class="nf">register</span><span class="p">(</span><span class="nc">Instant</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="nc">Instant</span><span class="p">.</span><span class="nf">ofEpochMilli</span><span class="p">(</span><span class="n">it</span><span class="p">.</span><span class="nf">toLong</span><span class="p">())</span> <span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="validation-examples">Validation examples</h3>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// validate two dependent query parameters:</span>
<span class="nc">Instant</span> <span class="n">fromDate</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"from"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">get</span><span class="o">();</span>
<span class="nc">Instant</span> <span class="n">toDate</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">queryParam</span><span class="o">(</span><span class="s">"to"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">it</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="o">.</span><span class="na">isAfter</span><span class="o">(</span><span class="n">fromDate</span><span class="o">),</span> <span class="s">"'to' has to be after 'from'"</span><span class="o">)</span>
        <span class="o">.</span><span class="na">get</span><span class="o">();</span>

<span class="c1">// validate a json body:</span>
<span class="nc">MyObject</span> <span class="n">myObject</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="na">bodyValidator</span><span class="o">(</span><span class="nc">MyObject</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
        <span class="o">.</span><span class="na">check</span><span class="o">(</span><span class="n">obj</span> <span class="o">-&gt;</span> <span class="n">obj</span><span class="o">.</span><span class="na">myObjectProperty</span> <span class="o">==</span> <span class="n">someValue</span><span class="o">)</span>
        <span class="o">.</span><span class="na">get</span><span class="o">();</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// validate two dependent query parameters:</span>
<span class="kd">val</span> <span class="py">fromDate</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Instant</span><span class="p">&gt;(</span><span class="s">"from"</span><span class="p">).</span><span class="k">get</span><span class="p">()</span>
<span class="kd">val</span> <span class="py">toDate</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">queryParam</span><span class="p">&lt;</span><span class="nc">Instant</span><span class="p">&gt;(</span><span class="s">"to"</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span><span class="p">.</span><span class="nf">isAfter</span><span class="p">(</span><span class="n">fromDate</span><span class="p">)</span> <span class="p">},</span> <span class="s">"'to' has to be after 'from'"</span><span class="p">)</span>
        <span class="p">.</span><span class="k">get</span><span class="p">()</span>

<span class="c1">// validate a json body:</span>
<span class="kd">val</span> <span class="py">myObject</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">bodyValidator</span><span class="p">&lt;</span><span class="nc">MyObject</span><span class="p">&gt;()</span>
        <span class="p">.</span><span class="nf">check</span><span class="p">({</span> <span class="n">it</span><span class="p">.</span><span class="n">myObjectProperty</span> <span class="p">==</span> <span class="n">someValue</span> <span class="p">})</span>
        <span class="p">.</span><span class="k">get</span><span class="p">()</span>
</code></pre></div>    </div>
  </div>
</div>

<p>If any of the validators find errors, a <code class="language-plaintext highlighter-rouge">BadRequestResponse</code> is thrown:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">"Query parameter 'from' with value 'TEST' is not a valid Instant"</span>
<span class="s">"Query parameter 'to' with value '1262347000000' invalid - 'to' has to be after 'from'"</span>
<span class="s">"Request body as MyObject invalid - Check failed"</span> <span class="c1">// can set custom error message in check()</span>
</code></pre></div></div>

<h2 id="access-manager">Access manager</h2>
<p>Javalin has a functional interface <code class="language-plaintext highlighter-rouge">AccessManager</code>, which let’s you
set per-endpoint authentication and/or authorization. It’s common to use before-handlers for this,
but per-endpoint security handlers give you much more explicit and readable code. You can implement your
access-manager however you want. Here is an example implementation:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Set the access-manager that Javalin should use</span>
<span class="n">config</span><span class="o">.</span><span class="na">accessManager</span><span class="o">((</span><span class="n">handler</span><span class="o">,</span> <span class="n">ctx</span><span class="o">,</span> <span class="n">permittedRoles</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">MyRole</span> <span class="n">userRole</span> <span class="o">=</span> <span class="n">getUserRole</span><span class="o">(</span><span class="n">ctx</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">permittedRoles</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">userRole</span><span class="o">))</span> <span class="o">{</span>
        <span class="n">handler</span><span class="o">.</span><span class="na">handle</span><span class="o">(</span><span class="n">ctx</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="mi">401</span><span class="o">).</span><span class="na">result</span><span class="o">(</span><span class="s">"Unauthorized"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>

<span class="nc">Role</span> <span class="nf">getUserRole</span><span class="o">(</span><span class="nc">Context</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// determine user role based on request</span>
    <span class="c1">// typically done by inspecting headers</span>
<span class="o">}</span>

<span class="kd">enum</span> <span class="nc">MyRole</span> <span class="kd">implements</span> <span class="nc">Role</span> <span class="o">{</span>
    <span class="no">ANYONE</span><span class="o">,</span> <span class="no">ROLE_ONE</span><span class="o">,</span> <span class="no">ROLE_TWO</span><span class="o">,</span> <span class="no">ROLE_THREE</span><span class="o">;</span>
<span class="o">}</span>

<span class="n">app</span><span class="o">.</span><span class="na">routes</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">get</span><span class="o">(</span><span class="s">"/un-secured"</span><span class="o">,</span>   <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">),</span>   <span class="n">roles</span><span class="o">(</span><span class="no">ANYONE</span><span class="o">));</span>
    <span class="n">get</span><span class="o">(</span><span class="s">"/secured"</span><span class="o">,</span>      <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">),</span>   <span class="n">roles</span><span class="o">(</span><span class="no">ROLE_ONE</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Set the access-manager that Javalin should use</span>
<span class="n">config</span><span class="p">.</span><span class="nf">accessManager</span> <span class="p">{</span> <span class="n">handler</span><span class="p">,</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">permittedRoles</span> <span class="p">-&gt;</span>
    <span class="kd">val</span> <span class="py">userRole</span> <span class="p">=</span> <span class="nf">getUserRole</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span> <span class="c1">// determine user role based on request</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">permittedRoles</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="n">userRole</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">handler</span><span class="p">.</span><span class="nf">handle</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">401</span><span class="p">).</span><span class="nf">result</span><span class="p">(</span><span class="s">"Unauthorized"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fun</span> <span class="nf">getUserRole</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="nc">Context</span><span class="p">)</span> <span class="p">:</span> <span class="nc">Role</span> <span class="p">{</span>
    <span class="c1">// determine user role based on request</span>
    <span class="c1">// typically done by inspecting headers</span>
<span class="p">}</span>

<span class="k">internal</span> <span class="k">enum</span> <span class="kd">class</span> <span class="nc">MyRole</span> <span class="p">:</span> <span class="nc">Role</span> <span class="p">{</span>
    <span class="nc">ANYONE</span><span class="p">,</span> <span class="nc">ROLE_ONE</span><span class="p">,</span> <span class="nc">ROLE_TWO</span><span class="p">,</span> <span class="nc">ROLE_THREE</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">routes</span> <span class="p">{</span>
    <span class="k">get</span><span class="p">(</span><span class="s">"/un-secured"</span><span class="p">,</span>   <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)},</span>   <span class="nf">roles</span><span class="p">(</span><span class="nc">MyRole</span><span class="p">.</span><span class="nc">ANYONE</span><span class="p">));</span>
    <span class="k">get</span><span class="p">(</span><span class="s">"/secured"</span><span class="p">,</span>      <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">)},</span>   <span class="nf">roles</span><span class="p">(</span><span class="nc">MyRole</span><span class="p">.</span><span class="nc">ROLE_ONE</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>The <code class="language-plaintext highlighter-rouge">AccessManager</code> will also run before your WebSocket upgrade request
(if you have added roles to the endpoint), but keep in mind that WebSockets are long lived,
so it might be wise to perform a check in <code class="language-plaintext highlighter-rouge">wsBefore</code> too/instead.</p>

<p>If you want to perform less restricted access management, you should consider using a <code class="language-plaintext highlighter-rouge">before</code> filter.</p>

<h2 id="default-responses">Default responses</h2>

<p>Javalin comes with a built in class called <code class="language-plaintext highlighter-rouge">HttpResponseException</code>, which can be used for default responses.<br />
If the client accepts JSON, a JSON object is returned. Otherwise a plain text response is returned.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span> <span class="o">{</span> <span class="k">throw</span> <span class="k">new</span> <span class="nc">ForbiddenResponse</span><span class="o">(</span><span class="s">"Off limits!"</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div></div>
<p>If client accepts JSON:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span>
    <span class="s">"title"</span><span class="o">:</span> <span class="s">"Off limits!"</span><span class="o">,</span>
    <span class="s">"status"</span><span class="o">:</span> <span class="mi">403</span><span class="o">,</span>
    <span class="s">"type"</span><span class="o">:</span> <span class="s">"https://javalin.io/documentation#forbiddenresponse"</span><span class="o">,</span>
    <span class="s">"details"</span><span class="o">:</span> <span class="o">[]</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Otherwise:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Forbidden
</code></pre></div></div>

<p>You can include a <code class="language-plaintext highlighter-rouge">Map&lt;String, String&gt;</code> of details if you wish.</p>

<h3 id="redirectresponse">RedirectResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/302">302 Found</a> response with the default title <code class="language-plaintext highlighter-rouge">Redirected</code>.</p>

<h3 id="badrequestresponse">BadRequestResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/400">400 Bad Request</a> response with the default title <code class="language-plaintext highlighter-rouge">Bad request</code>.</p>

<h3 id="unauthorizedresponse">UnauthorizedResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/401">401 Unauthorized</a> response with the default title <code class="language-plaintext highlighter-rouge">Unauthorized</code>.</p>

<h3 id="forbiddenresponse">ForbiddenResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/403">403 Forbidden</a> response with the default title <code class="language-plaintext highlighter-rouge">Forbidden</code>.</p>

<h3 id="notfoundresponse">NotFoundResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404">404 Not Found</a> response with the default title <code class="language-plaintext highlighter-rouge">Not found</code>.</p>

<h3 id="methodnotallowedresponse">MethodNotAllowedResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/405">405 Method Not Allowed</a> response with the default title <code class="language-plaintext highlighter-rouge">Method not allowed</code>.</p>

<h3 id="conflictresponse">ConflictResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/409">409 Conflict</a> response with the default title <code class="language-plaintext highlighter-rouge">Conflict</code>.</p>

<h3 id="goneresponse">GoneResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/410">410 Gone</a> response with the default title <code class="language-plaintext highlighter-rouge">Gone</code>.</p>

<h3 id="internalservererrorresponse">InternalServerErrorResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/500">500 Internal Server Error</a> response with the default title <code class="language-plaintext highlighter-rouge">Internal server error</code>.</p>

<h3 id="badgatewayresponse">BadGatewayResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/502">502 Bad Gateway</a> response with the default title <code class="language-plaintext highlighter-rouge">Bad gateway</code>.</p>

<h3 id="serviceunavailableresponse">ServiceUnavailableResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/503">503 Service Unavailable</a> response with the default title <code class="language-plaintext highlighter-rouge">Service unavailable</code>.</p>

<h3 id="gatewaytimeoutresponse">GatewayTimeoutResponse</h3>
<p>Returns a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/504">504 Gateway Timeout</a> response with the default title <code class="language-plaintext highlighter-rouge">Gateway timeout</code>.</p>

<h2 id="exception-mapping">Exception Mapping</h2>
<p>All handlers (before, endpoint, after) can throw <code class="language-plaintext highlighter-rouge">Exception</code>
(and any subclass of <code class="language-plaintext highlighter-rouge">Exception</code>)
The <code class="language-plaintext highlighter-rouge">app.exception()</code> method gives you a way of handling these exceptions:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">exception</span><span class="o">(</span><span class="nc">NullPointerException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// handle nullpointers here</span>
<span class="o">});</span>

<span class="n">app</span><span class="o">.</span><span class="na">exception</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// handle general exceptions here</span>
    <span class="c1">// will not trigger if more specific exception-mapper found</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="nc">NullPointerException</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="n">e</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// handle nullpointers here</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="nc">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="n">e</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// handle general exceptions here</span>
    <span class="c1">// will not trigger if more specific exception-mapper found</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h2 id="websocket-exception-mapping">WebSocket Exception Mapping</h2>
<p>The different WebSocket handlers throw exceptions. The <code class="language-plaintext highlighter-rouge">app.wsException()</code> method gives you a way of handling these exceptions:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">wsException</span><span class="o">(</span><span class="nc">NullPointerException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// handle nullpointers here</span>
<span class="o">});</span>

<span class="n">app</span><span class="o">.</span><span class="na">wsException</span><span class="o">(</span><span class="nc">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// handle general exceptions here</span>
    <span class="c1">// will not trigger if more specific exception-mapper found</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">wsException</span><span class="p">(</span><span class="nc">NullPointerException</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="n">e</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// handle nullpointers here</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">wsException</span><span class="p">(</span><span class="nc">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="n">e</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="c1">// handle general exceptions here</span>
    <span class="c1">// will not trigger if more specific exception-mapper found</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h2 id="error-mapping">Error Mapping</h2>
<p>HTTP Error mapping is similar to exception mapping, but it operates on HTTP status codes instead of Exceptions:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="mi">404</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Generic 404 message"</span><span class="o">)</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Generic 404 message"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>It can make sense to use them together:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">exception</span><span class="o">(</span><span class="nc">FileNotFoundException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="o">(</span><span class="n">e</span><span class="o">,</span> <span class="n">ctx</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="mi">404</span><span class="o">);</span>
<span class="o">}).</span><span class="na">error</span><span class="o">(</span><span class="mi">404</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">result</span><span class="o">(</span><span class="s">"Generic 404 message"</span><span class="o">)</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">exception</span><span class="p">(</span><span class="nc">FileNotFoundException</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span> <span class="p">{</span> <span class="n">e</span><span class="p">,</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<span class="p">}.</span><span class="nf">error</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="s">"Generic 404 message"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>You can also include the content type when declaring your error mappers:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="mi">404</span><span class="o">,</span> <span class="s">"html"</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">html</span><span class="o">(</span><span class="s">"Generic 404 message"</span><span class="o">)</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="mi">404</span><span class="p">,</span> <span class="s">"html"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">html</span><span class="p">(</span><span class="s">"Generic 404 message"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>This can be useful if you, for example, want one set of error handlers for HTML, and one for JSON.</p>

<h2 id="server-sent-events">Server-sent Events</h2>
<p>Server-sent events (often also called event source) are very simple in Javalin.
You call <code class="language-plaintext highlighter-rouge">app.sse()</code>, which gives you access to the connected <code class="language-plaintext highlighter-rouge">SseClient</code>:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">sse</span><span class="o">(</span><span class="s">"/sse"</span><span class="o">,</span> <span class="n">client</span> <span class="o">-&gt;</span>
    <span class="n">client</span><span class="o">.</span><span class="na">sendEvent</span><span class="o">(</span><span class="s">"connected"</span><span class="o">,</span> <span class="s">"Hello, SSE"</span><span class="o">);</span>
    <span class="n">client</span><span class="o">.</span><span class="na">onClose</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Client disconnected"</span><span class="o">));</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">sse</span><span class="p">(</span><span class="s">"/sse"</span><span class="p">)</span> <span class="p">{</span> <span class="n">client</span> <span class="p">-&gt;</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">sendEvent</span><span class="p">(</span><span class="s">"connected"</span><span class="p">,</span> <span class="s">"Hello, SSE"</span><span class="p">)</span>
    <span class="n">client</span><span class="p">.</span><span class="nf">onClose</span> <span class="p">{</span> <span class="nf">println</span><span class="p">(</span><span class="s">"Client disconnected"</span><span class="p">)</span> <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>The <code class="language-plaintext highlighter-rouge">SseClient</code> has access to three things:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">client</span><span class="o">.</span><span class="na">sendEvent</span><span class="o">()</span> <span class="c1">// method(s) for sending events to client</span>
<span class="n">client</span><span class="o">.</span><span class="na">onClose</span><span class="o">(</span><span class="n">runnable</span><span class="o">)</span> <span class="c1">// callback which runs when a client closes its connection</span>
<span class="n">client</span><span class="o">.</span><span class="na">ctx</span> <span class="c1">// the Context for when the client connected (to fetch query-params, etc)</span>
</code></pre></div></div>

<h2 id="configuration">Configuration</h2>

<p>You can pass a config object when creating a new instance of Javalin.
The below snippets shows all the available config options:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>

    <span class="c1">// JavalinServlet</span>
    <span class="n">config</span><span class="o">.</span><span class="na">addSinglePageRoot</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">file</span><span class="o">)</span>            <span class="c1">// ex ("/", "/index.html")</span>
    <span class="n">config</span><span class="o">.</span><span class="na">addSinglePageRoot</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">file</span><span class="o">,</span> <span class="n">location</span><span class="o">)</span>  <span class="c1">// ex ("/", "src/file.html", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">addStaticFiles</span><span class="o">(</span><span class="n">directory</span><span class="o">)</span>                <span class="c1">// ex ("/public")</span>
    <span class="n">config</span><span class="o">.</span><span class="na">addStaticFiles</span><span class="o">(</span><span class="n">directory</span><span class="o">,</span> <span class="n">location</span><span class="o">)</span>      <span class="c1">// ex ("src/folder", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">addStaticFiles</span><span class="o">(</span><span class="n">prefix</span><span class="o">,</span> <span class="n">dir</span><span class="o">,</span> <span class="n">location</span><span class="o">)</span>    <span class="c1">// ex ("/assets", "src/folder", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">aliasCheckForStaticFiles</span> <span class="o">=</span> <span class="nc">AliasCheck</span>    <span class="c1">// symlink config, ex new ContextHandler.ApproveAliases();</span>
    <span class="n">config</span><span class="o">.</span><span class="na">asyncRequestTimeout</span> <span class="o">=</span> <span class="n">timeoutInMs</span>        <span class="c1">// timeout for async requests (default is 0, no timeout)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">autogenerateEtags</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>           <span class="c1">// auto generate etags (default is false)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">compressionStrategy</span><span class="o">(</span><span class="nc">Brotli</span><span class="o">(</span><span class="mi">4</span><span class="o">),</span> <span class="nc">Gzip</span><span class="o">(</span><span class="mi">6</span><span class="o">))</span>  <span class="c1">// set the compression strategy and levels - since 3.2.0</span>
    <span class="n">config</span><span class="o">.</span><span class="na">contextPath</span> <span class="o">=</span> <span class="n">contextPath</span>                <span class="c1">// context path for the http servlet (default is "/")</span>
    <span class="n">config</span><span class="o">.</span><span class="na">defaultContentType</span> <span class="o">=</span> <span class="n">contentType</span>         <span class="c1">// content type to use if no content type is set (default is "text/plain")</span>
    <span class="n">config</span><span class="o">.</span><span class="na">dynamicGzip</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>                 <span class="c1">// dynamically gzip http responses (default is true)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enableCorsForAllOrigins</span><span class="o">()</span>                <span class="c1">// enable cors for all origins</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enableCorsForOrigin</span><span class="o">(</span><span class="n">origins</span><span class="o">)</span>             <span class="c1">// enable cors for specific origins</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enableDevLogging</span><span class="o">()</span>                       <span class="c1">// enable extensive development logging for http and websocket</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enableWebjars</span><span class="o">()</span>                          <span class="c1">// enable webjars (static files)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enforceSsl</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>                  <span class="c1">// redirect http traffic to https (default is false)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">ignoreTrailingSlashes</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>       <span class="c1">// default is true</span>
    <span class="n">config</span><span class="o">.</span><span class="na">logIfServerNotStarted</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>       <span class="c1">// log a warning if user doesn't start javalin instance (default is true)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">precompressStaticFiles</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>      <span class="c1">// store compressed files in memory (avoid recompression and ensure content-length is set)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">prefer405over404</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>            <span class="c1">// send a 405 if handlers exist for different verb on the same path (default is false)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">requestCacheSize</span> <span class="o">=</span> <span class="n">sizeInBytes</span>           <span class="c1">// set the request cache size, used for reading request body multiple times (default is 4kb)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">requestLogger</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                    <span class="c1">// set a request logger</span>
    <span class="n">config</span><span class="o">.</span><span class="na">sessionHandler</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                   <span class="c1">// set a SessionHandler</span>

    <span class="c1">// WsServlet</span>
    <span class="n">config</span><span class="o">.</span><span class="na">wsContextPath</span> <span class="o">=</span> <span class="n">contextPath</span>              <span class="c1">// context path for the websocket servlet (default is "/")</span>
    <span class="n">config</span><span class="o">.</span><span class="na">wsFactoryConfig</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                  <span class="c1">// set a websocket factory config</span>
    <span class="n">config</span><span class="o">.</span><span class="na">wsLogger</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                         <span class="c1">// set a websocket logger</span>

    <span class="c1">// Server</span>
    <span class="n">config</span><span class="o">.</span><span class="na">server</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                           <span class="c1">// set a Jetty server for Javalin to run on</span>

    <span class="c1">// Misc</span>
    <span class="n">config</span><span class="o">.</span><span class="na">accessManager</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>                    <span class="c1">// set an access manager (affects both http and websockets)</span>
    <span class="n">config</span><span class="o">.</span><span class="na">showJavalinBanner</span> <span class="o">=</span> <span class="kc">true</span><span class="o">/</span><span class="kc">false</span>           <span class="c1">// show the Javalin banner when starting the instance</span>
<span class="o">}).</span><span class="na">start</span><span class="o">()</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>

    <span class="c1">// JavalinServlet</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">addSinglePageRoot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>            <span class="c1">// ex ("/", "/index.html")</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">addSinglePageRoot</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>  <span class="c1">// ex ("/", "src/file.html", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">addStaticFiles</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>                <span class="c1">// ex ("/public")</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">addStaticFiles</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>      <span class="c1">// ex ("src/folder", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">addStaticFiles</span><span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">dir</span><span class="p">,</span> <span class="n">location</span><span class="p">)</span>    <span class="c1">// ex ("/assets", "src/folder", Location.EXTERNAL)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">aliasCheckForStaticFiles</span> <span class="p">=</span> <span class="nc">AliasCheck</span>    <span class="c1">// symlink config, ex ContextHandler.ApproveAliases();</span>
    <span class="n">config</span><span class="p">.</span><span class="n">asyncRequestTimeout</span> <span class="p">=</span> <span class="n">timeoutInMs</span>        <span class="c1">// timeout for async requests (default is 0, no timeout)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">autogenerateEtags</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>           <span class="c1">// auto generate etags (default is false)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">compressionStrategy</span><span class="p">(</span><span class="nc">Brotli</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="nc">Gzip</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>  <span class="c1">// set the compression strategy and levels - since 3.2.0</span>
    <span class="n">config</span><span class="p">.</span><span class="n">contextPath</span> <span class="p">=</span> <span class="n">contextPath</span>                <span class="c1">// context path for the http servlet (default is "/")</span>
    <span class="n">config</span><span class="p">.</span><span class="n">defaultContentType</span> <span class="p">=</span> <span class="n">contentType</span>         <span class="c1">// content type to use if no content type is set (default is "text/plain")</span>
    <span class="n">config</span><span class="p">.</span><span class="n">dynamicGzip</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>                 <span class="c1">// dynamically gzip http responses (default is true)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">enableCorsForAllOrigins</span><span class="p">()</span>                <span class="c1">// enable cors for all origins</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">enableCorsForOrigin</span><span class="p">(</span><span class="n">origins</span><span class="p">)</span>             <span class="c1">// enable cors for specific origins</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">enableDevLogging</span><span class="p">()</span>                       <span class="c1">// enable extensive development logging for http and websocket</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">enableWebjars</span><span class="p">()</span>                          <span class="c1">// enable webjars (static files)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">enforceSsl</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>                  <span class="c1">// redirect http traffic to https (default is false)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">ignoreTrailingSlashes</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>       <span class="c1">// default is true</span>
    <span class="n">config</span><span class="p">.</span><span class="n">logIfServerNotStarted</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>       <span class="c1">// log a warning if user doesn't start javalin instance (default is true)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">precompressStaticFiles</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>      <span class="c1">// store compressed files in memory (avoid recompression and ensure content-length is set)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">prefer405over404</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>            <span class="c1">// send a 405 if handlers exist for different verb on the same path (default is false)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">requestCacheSize</span> <span class="p">=</span> <span class="n">sizeInBytes</span>           <span class="c1">// set the request cache size, used for reading request body multiple times (default is 4kb)</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">requestLogger</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                    <span class="c1">// set a request logger</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">sessionHandler</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                   <span class="c1">// set a SessionHandler</span>

    <span class="c1">// WsServlet</span>
    <span class="n">config</span><span class="p">.</span><span class="n">wsContextPath</span> <span class="p">=</span> <span class="n">contextPath</span>              <span class="c1">// context path for the websocket servlet (default is "/")</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">wsFactoryConfig</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                  <span class="c1">// set a websocket factory config</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">wsLogger</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                         <span class="c1">// set a websocket logger</span>

    <span class="c1">// Server</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">server</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                           <span class="c1">// set a Jetty server for Javalin to run on</span>

    <span class="c1">// Misc</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">accessManager</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>                    <span class="c1">// set an access manager (affects both http and websockets)</span>
    <span class="n">config</span><span class="p">.</span><span class="n">showJavalinBanner</span> <span class="p">=</span> <span class="k">true</span><span class="p">/</span><span class="k">false</span>           <span class="c1">// show the Javalin banner when starting the instance</span>
<span class="p">}.</span><span class="nf">start</span><span class="p">()</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="static-files">Static Files</h3>
<p>You can enabled static file serving by doing <code class="language-plaintext highlighter-rouge">config.addStaticFiles("/classpath-folder")</code>, and/or
<code class="language-plaintext highlighter-rouge">config.addStaticFiles("/folder", Location.EXTERNAL)</code>.
Static resource handling is done <strong>after</strong> endpoint matching,
meaning your self-defined endpoints have higher priority. The process looks like this:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>before-handlers
endpoint-handlers
<span class="k">if </span>no-endpoint-handler-found
    static-file-handler
    <span class="k">if </span>static-file-found
        static-file-handler send response
    <span class="k">else
        </span>response is 404
after-handlers
</code></pre></div></div>
<p>If you do <code class="language-plaintext highlighter-rouge">config.addStaticFiles("/classpath-folder")</code>.
Your <code class="language-plaintext highlighter-rouge">index.html</code> file at <code class="language-plaintext highlighter-rouge">/classpath-folder/index.html</code> will be available
at <code class="language-plaintext highlighter-rouge">http://{host}:{port}/index.html</code> and <code class="language-plaintext highlighter-rouge">http://{host}:{port}/</code>.</p>

<p>You can call <code class="language-plaintext highlighter-rouge">addStaticFiles</code> multiple times to set up multiple handlers.</p>

<p>WebJars can be enabled by calling <code class="language-plaintext highlighter-rouge">enableWebJars()</code>, they will be available at <code class="language-plaintext highlighter-rouge">/webjars/name/version/file.ext</code>.</p>

<p>WebJars can be found on <a href="https://www.webjars.org/">https://www.webjars.org/</a>.
Everything available through NPM is also available through WebJars.</p>

<h4 id="path-prefix">Path prefix</h4>
<p>As of <code class="language-plaintext highlighter-rouge">3.9.0</code>, you can call <code class="language-plaintext highlighter-rouge">config.addStaticFiles("/hosting-path", "/dir-path")</code>, which will make the
files available on <code class="language-plaintext highlighter-rouge">http://{host}:{port}/hosting-path/...</code></p>

<h4 id="caching">Caching</h4>
<p>Javalin serves static files with the <code class="language-plaintext highlighter-rouge">Cache-Control</code> header set to <code class="language-plaintext highlighter-rouge">max-age=0</code>. This means
that browsers will always ask if the file is still valid. If the version the browser has in cache
is the same as the version on the server, Javalin will respond with a <code class="language-plaintext highlighter-rouge">304 Not modified</code> status,
and no response body. This tells the browser that it’s okay to keep using the cached version.
If you want to skip this check, you can put files in a dir called <code class="language-plaintext highlighter-rouge">immutable</code>,
and Javalin will set <code class="language-plaintext highlighter-rouge">max-age=31622400</code>, which means that the browser will wait
one year before checking if the file is still valid.
This should only be used for versioned library files, like <code class="language-plaintext highlighter-rouge">vue-2.4.2.min.js</code>, to avoid
the browser ending up with an outdated version if you change the file content.
WebJars also use <code class="language-plaintext highlighter-rouge">max-age=31622400</code>, as the version number is always part of the path.</p>

<h3 id="single-page-mode">Single page mode</h3>
<p>Single page mode is similar to static file handling. It runs after endpoint matching and after static file handling.
It’s basically a very fancy 404 mapper, which converts any 404’s into a specified page.
You can define multiple single page handlers for your application by specifying different root paths.</p>

<p>You can enabled single page mode by doing <code class="language-plaintext highlighter-rouge">config.addSinglePageRoot("/root", "/path/to/file.html")</code>, and/or
<code class="language-plaintext highlighter-rouge">config.addSinglePageRoot("/root", "/path/to/file.html", Location.EXTERNAL)</code>.</p>

<h4 id="dynamic-single-page-handler">Dynamic single page handler</h4>
<p>You can also use a <code class="language-plaintext highlighter-rouge">Handler</code> to serve your single page root (as opposed to a static file):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">config</span><span class="o">.</span><span class="na">addSinglePageHandler</span><span class="o">(</span><span class="s">"/root"</span><span class="o">,</span>  <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">html</span><span class="o">(...);</span>
<span class="o">});</span>
</code></pre></div></div>

<h3 id="logging">Logging</h3>

<h4 id="adding-a-logger">Adding a logger</h4>

<p>Javalin does not have a logger included,
which means that you have to add your own logger. If you don’t know/care
a lot about Java loggers, the easiest way to fix this is to add the following
dependency to your project:</p>

<pre><code class="language-markup">&lt;dependency&gt;
    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
    &lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;
    &lt;version&gt;1.7.36&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h4 id="request-logging">Request logging</h4>
<p>You can add a HTTP request logger by calling <code class="language-plaintext highlighter-rouge">config.requestLogger()</code>.
The method takes a <code class="language-plaintext highlighter-rouge">Context</code> and the time in milliseconds it took to finish the request:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">requestLogger</span><span class="o">((</span><span class="n">ctx</span><span class="o">,</span> <span class="n">ms</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="c1">// log things here</span>
    <span class="o">});</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">requestLogger</span> <span class="p">{</span> <span class="n">ctx</span><span class="p">,</span> <span class="n">ms</span> <span class="p">-&gt;</span>
        <span class="c1">// log things here</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h4 id="websocket-logging">WebSocket logging</h4>
<p>You can add a WebSocket logger by calling <code class="language-plaintext highlighter-rouge">config.wsLogger()</code>. The method takes a <code class="language-plaintext highlighter-rouge">WsHandler</code>,
(the same interface as a normal <code class="language-plaintext highlighter-rouge">app.ws()</code> call), and can be used to log events of all types.
The following example just shows <code class="language-plaintext highlighter-rouge">onMessage</code>, but <code class="language-plaintext highlighter-rouge">onConnect</code>, <code class="language-plaintext highlighter-rouge">onError</code> and <code class="language-plaintext highlighter-rouge">onClose</code> are all available:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">wsLogger</span><span class="o">(</span><span class="n">ws</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">ws</span><span class="o">.</span><span class="na">onMessage</span><span class="o">(</span><span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Received: "</span> <span class="o">+</span> <span class="n">ctx</span><span class="o">.</span><span class="na">message</span><span class="o">());</span>
        <span class="o">});</span>
    <span class="o">});</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">wsLogger</span><span class="p">(</span><span class="n">ws</span> <span class="p">-&gt;</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="nf">onMessage</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
            <span class="nf">println</span><span class="p">(</span><span class="s">"Received: "</span> <span class="p">+</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">message</span><span class="p">());</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>The logger runs after the WebSocket handler for the endpoint.</p>

<h4 id="dev-logging">Dev logging</h4>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">enableDevLogging</span><span class="o">();</span> <span class="c1">// enable extensive development logging for http and websocket</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">enableDevLogging</span><span class="p">()</span> <span class="c1">// enable extensive development logging for http and websocket</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h3 id="server-setup">Server setup</h3>

<p>Javalin runs on an embedded <a href="http://eclipse.org/jetty/">Jetty</a>. To start and stop the server,
use <code class="language-plaintext highlighter-rouge">start()</code> and <code class="language-plaintext highlighter-rouge">stop</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">()</span>
    <span class="o">.</span><span class="na">start</span><span class="o">()</span> <span class="c1">// start server (sync/blocking)</span>
    <span class="o">.</span><span class="na">stop</span><span class="o">()</span> <span class="c1">// stop server (sync/blocking)</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">app.start()</code> method spawns a user thread, starts the server, and then returns.
Your program will not exit until this thread is terminated by calling <code class="language-plaintext highlighter-rouge">app.stop()</code>.</p>

<p>If you want to do a clean shutdown when the program is exiting, you could use:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Runtime</span><span class="o">.</span><span class="na">getRuntime</span><span class="o">().</span><span class="na">addShutdownHook</span><span class="o">(</span><span class="k">new</span> <span class="nc">Thread</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
	<span class="n">app</span><span class="o">.</span><span class="na">stop</span><span class="o">();</span>
<span class="o">}));</span>

<span class="n">app</span><span class="o">.</span><span class="na">events</span><span class="o">(</span><span class="n">event</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStopping</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="cm">/* Your code here */</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStopped</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="cm">/* Your code here */</span> <span class="o">});</span>
<span class="o">});</span>
</code></pre></div></div>

<h4 id="setting-the-host">Setting the Host</h4>

<p>The <code class="language-plaintext highlighter-rouge">Javalin#start</code> method is overloaded to accept the Host (IP) as the first argument:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">().</span><span class="na">start</span><span class="o">(</span><span class="s">"127.0.0.1"</span><span class="o">,</span> <span class="mi">1235</span><span class="o">)</span>
</code></pre></div></div>

<h4 id="custom-server">Custom server</h4>
<p>If you need to customize the embedded server, you can call the <code class="language-plaintext highlighter-rouge">server()</code> method:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">server</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">Server</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Server</span><span class="o">();</span> <span class="c1">// configure this however you want</span>
        <span class="k">return</span> <span class="n">server</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">server</span> <span class="p">{</span>
        <span class="kd">val</span> <span class="py">server</span> <span class="p">=</span> <span class="nc">Server</span><span class="p">()</span> <span class="c1">// configure this however you want</span>
        <span class="n">server</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<h4 id="custom-sessionhandler">Custom SessionHandler</h4>

<p>You can configure the <code class="language-plaintext highlighter-rouge">SessionHandler</code> by calling the <code class="language-plaintext highlighter-rouge">sessionHandler(...)</code> method.</p>

<p>If you want to persist sessions to the file system, you can use a <code class="language-plaintext highlighter-rouge">FileSessionDataStore</code>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">private</span> <span class="k">fun</span> <span class="nf">fileSessionHandler</span><span class="p">()</span> <span class="p">=</span> <span class="nc">SessionHandler</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
    <span class="n">httpOnly</span> <span class="p">=</span> <span class="k">true</span>
    <span class="n">sessionCache</span> <span class="p">=</span> <span class="nc">DefaultSessionCache</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span>
        <span class="n">sessionDataStore</span> <span class="p">=</span> <span class="nc">FileSessionDataStore</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
            <span class="kd">val</span> <span class="py">baseDir</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="nc">System</span><span class="p">.</span><span class="nf">getProperty</span><span class="p">(</span><span class="s">"java.io.tmpdir"</span><span class="p">))</span>
            <span class="n">storeDir</span> <span class="p">=</span> <span class="nc">File</span><span class="p">(</span><span class="n">baseDir</span><span class="p">,</span> <span class="s">"javalin-session-store"</span><span class="p">).</span><span class="nf">apply</span> <span class="p">{</span> <span class="nf">mkdir</span><span class="p">()</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Read more about how to configure sessions in our
<a href="https://javalin.io/tutorials/jetty-session-handling-kotlin">session tutorial</a>.</p>

<h4 id="custom-jetty-handlers">Custom jetty handlers</h4>
<p>You can configure your embedded jetty-server with a handler-chain
(<a href="https://github.com/tipsy/javalin/blob/master/javalin/src/test/java/io/javalin/TestCustomJetty.kt#L71-L87">example</a>),
and Javalin will attach it’s own handlers to the end of this chain.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">StatisticsHandler</span> <span class="n">statisticsHandler</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StatisticsHandler</span><span class="o">();</span>

<span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">config</span><span class="o">.</span><span class="na">server</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">Server</span> <span class="n">server</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Server</span><span class="o">();</span>
        <span class="n">server</span><span class="o">.</span><span class="na">setHandler</span><span class="o">(</span><span class="n">statisticsHandler</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">server</span><span class="o">;</span>
    <span class="o">})</span>
<span class="o">}).</span><span class="na">start</span><span class="o">();</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">statisticsHandler</span> <span class="p">=</span> <span class="nc">StatisticsHandler</span><span class="p">()</span>

<span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span> <span class="n">config</span> <span class="p">-&gt;</span>
    <span class="n">config</span><span class="p">.</span><span class="nf">server</span> <span class="p">{</span>
        <span class="nc">Server</span><span class="p">().</span><span class="nf">apply</span> <span class="p">{</span>
            <span class="n">handler</span> <span class="p">=</span> <span class="n">statisticsHandler</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="nf">start</span><span class="p">();</span>
</code></pre></div>    </div>
  </div>
</div>

<h4 id="sslhttp2">SSL/HTTP2</h4>

<p>To configure SSL or HTTP2 you need to use a custom server (see previous section).<br />
An example of a custom server with SSL can be found in the examples,
<a href="https://github.com/tipsy/javalin/blob/master/javalin/src/test/java/io/javalin/examples/HelloWorldSecure.java#L22-L30">HelloWorldSecure</a>.</p>

<p>A custom HTTP2 server is a bit more work to set up, but we have a repo with a
fully functioning example server in both Kotlin and Java: <a href="https://github.com/tipsy/javalin-http2-example">javalin-http2-example</a></p>

<h2 id="lifecycle-events">Lifecycle events</h2>
<p>Javalin has events for server start/stop, as well as for when handlers are added.
The snippet below shows all of them in action:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span> <span class="n">app</span> <span class="o">=</span> <span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">().</span><span class="na">events</span><span class="o">(</span><span class="n">event</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStarting</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStarted</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStartFailed</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStopping</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">serverStopped</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">handlerAdded</span><span class="o">(</span><span class="n">handlerMetaInfo</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
    <span class="n">event</span><span class="o">.</span><span class="na">wsHandlerAdded</span><span class="o">(</span><span class="n">wsHandlerMetaInfo</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="o">...</span> <span class="o">});</span>
<span class="o">});</span>

<span class="n">app</span><span class="o">.</span><span class="na">start</span><span class="o">()</span> <span class="c1">// serverStarting -&gt; (serverStarted || serverStartFailed)</span>
<span class="n">app</span><span class="o">.</span><span class="na">stop</span><span class="o">()</span> <span class="c1">// serverStopping -&gt; serverStopped</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span> <span class="n">app</span> <span class="p">=</span> <span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span><span class="p">().</span><span class="nf">events</span> <span class="p">{</span> <span class="n">event</span> <span class="p">-&gt;</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">serverStarting</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">serverStarted</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">serverStartFailed</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">serverStopping</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">serverStopped</span> <span class="p">{</span> <span class="o">..</span><span class="p">.</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">handlerAdded</span> <span class="p">{</span> <span class="n">handlerMetaInfo</span> <span class="p">-&gt;</span> <span class="p">}</span>
    <span class="n">event</span><span class="p">.</span><span class="nf">wsHandlerAdded</span> <span class="p">{</span> <span class="n">wsHandlerMetaInfo</span> <span class="p">-&gt;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span> <span class="c1">// serverStarting -&gt; (serverStarted || serverStartFailed)</span>
<span class="n">app</span><span class="p">.</span><span class="nf">stop</span><span class="p">()</span> <span class="c1">// serverStopping -&gt; serverStopped</span>
</code></pre></div>    </div>
  </div>
</div>

<h2 id="plugins">Plugins</h2>
<p>Javalin 3 introduced a new plugin system with two interfaces, <code class="language-plaintext highlighter-rouge">Plugin</code> and <code class="language-plaintext highlighter-rouge">PluginLifecycleInit</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">interface</span> <span class="nc">Plugin</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">apply</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="nc">Javalin</span> <span class="n">app</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">interface</span> <span class="nc">PluginLifecycleInit</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">init</span><span class="o">(</span><span class="nd">@NotNull</span> <span class="nc">Javalin</span> <span class="n">app</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>When implementing <code class="language-plaintext highlighter-rouge">PluginLifecycleInit#init</code>, you are not allowed to add <code class="language-plaintext highlighter-rouge">Handler</code> instances to the app.<br />
The two interface methods are called like this during setup:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initPlugins</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">plugin</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">plugin</span><span class="o">.</span><span class="na">init</span><span class="o">(</span><span class="n">app</span><span class="o">);</span>
    <span class="c1">// will throw exception if `init` adds Handler</span>
<span class="o">});</span>

<span class="n">plugins</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">plugin</span> <span class="o">-&gt;</span> <span class="n">plugin</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">app</span><span class="o">));</span>
</code></pre></div></div>

<p>This is mainly so each plugin has a chance to add <code class="language-plaintext highlighter-rouge">handlerAdded</code> listeners before other plugins
add <em>their</em> handlers, so that each plugin has a complete overview of all handlers.</p>

<h3 id="route-overview-plugin">Route overview plugin</h3>

<p>You can enable a HTML page showing all the routes of your application by registering it on the config:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span>
    <span class="n">config</span><span class="o">.</span><span class="na">registerPlugin</span><span class="o">(</span><span class="k">new</span> <span class="nc">RouteOverviewPlugin</span><span class="o">(</span><span class="n">path</span><span class="o">));</span>        <span class="c1">// show all routes on specified path</span>
    <span class="n">config</span><span class="o">.</span><span class="na">registerPlugin</span><span class="o">(</span><span class="k">new</span> <span class="nc">RouteOverviewPlugin</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">roles</span><span class="o">));</span> <span class="c1">// show all routes on specified path (with auth)</span>
<span class="o">)</span>
</code></pre></div></div>

<h3 id="micrometer-plugin">Micrometer Plugin</h3>

<p>You can enable the Micrometer plugin by registering it on the <code class="language-plaintext highlighter-rouge">config</code>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span>
    <span class="n">config</span><span class="o">.</span><span class="na">registerPlugin</span><span class="o">(</span><span class="k">new</span> <span class="nc">MicrometerPlugin</span><span class="o">());</span>
<span class="o">)</span>
</code></pre></div></div>

<p>Additional documentation for the plugin can be found <a href="/plugins/micrometer">here</a>.</p>

<h3 id="openapi-plugin">OpenAPI Plugin</h3>

<p>Javalin has an OpenAPI (Swagger) plugin. Full documentation for the plugin can be found <a href="/plugins/openapi">here</a>,
below are a few examples:</p>

<h4 id="openapi-dsl">OpenAPI DSL</h4>
<p>When using the OpenAPI DSL you define an <code class="language-plaintext highlighter-rouge">OpenApiDocumentation</code> object to pair with your <code class="language-plaintext highlighter-rouge">Handler</code>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">addUserDocs</span> <span class="p">=</span> <span class="nf">document</span><span class="p">()</span>
        <span class="p">.</span><span class="n">body</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;()</span>
        <span class="p">.</span><span class="n">result</span><span class="p">&lt;</span><span class="nc">Unit</span><span class="p">&gt;(</span><span class="s">"400"</span><span class="p">)</span>
        <span class="p">.</span><span class="n">result</span><span class="p">&lt;</span><span class="nc">Unit</span><span class="p">&gt;(</span><span class="s">"204"</span><span class="p">)</span>

<span class="k">fun</span> <span class="nf">addUserHandler</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="nc">Context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">user</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">body</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;()</span>
    <span class="nc">UserRepository</span><span class="p">.</span><span class="nf">addUser</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">204</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You then combine these when you add your routes:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">post</span><span class="p">(</span><span class="s">"/users"</span><span class="p">,</span> <span class="nf">documented</span><span class="p">(</span><span class="n">addUserDocs</span><span class="p">,</span> <span class="o">::</span><span class="n">addUserHandler</span><span class="p">))</span>
</code></pre></div></div>

<h4 id="openapi-annotations">OpenAPI annotations</h4>

<p>If you prefer to keep your documentation separate from your code, you can use annotations instead:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@OpenApi</span><span class="p">(</span>
    <span class="n">requestBody</span> <span class="p">=</span> <span class="nc">OpenApiRequestBody</span><span class="p">(</span><span class="nc">User</span><span class="o">::</span><span class="k">class</span><span class="p">),</span>
    <span class="n">responses</span> <span class="p">=</span> <span class="p">[</span>
        <span class="nc">OpenApiResponse</span><span class="p">(</span><span class="s">"400"</span><span class="p">,</span> <span class="nc">Unit</span><span class="o">::</span><span class="k">class</span><span class="p">),</span>
        <span class="nc">OpenApiResponse</span><span class="p">(</span><span class="s">"201"</span><span class="p">,</span> <span class="nc">Unit</span><span class="o">::</span><span class="k">class</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="k">fun</span> <span class="nf">createUser</span><span class="p">(</span><span class="n">ctx</span><span class="p">:</span> <span class="nc">Context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">user</span> <span class="p">=</span> <span class="n">ctx</span><span class="p">.</span><span class="n">body</span><span class="p">&lt;</span><span class="nc">User</span><span class="p">&gt;()</span>
    <span class="nc">UserRepository</span><span class="p">.</span><span class="nf">createUser</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="mi">201</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If you use the annotation API you don’t need to connect the documentation and the handler manually,
you just reference your handler as normal:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">post</span><span class="p">(</span><span class="s">"/users"</span><span class="p">,</span> <span class="o">::</span><span class="n">addUserHandler</span><span class="p">)</span>
</code></pre></div></div>

<p>Javalin will then extract the information from the annotation and build the documentation automatically.</p>

<p>To enable hosted docs you have to specify some paths in your Javalin config:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span> <span class="p">{</span>
    <span class="n">it</span><span class="p">.</span><span class="nf">enableOpenApi</span><span class="p">(</span>
            <span class="nc">OpenApiOptions</span><span class="p">(</span><span class="nc">Info</span><span class="p">().</span><span class="nf">version</span><span class="p">(</span><span class="s">"1.0"</span><span class="p">).</span><span class="nf">description</span><span class="p">(</span><span class="s">"My Application"</span><span class="p">))</span>
                    <span class="p">.</span><span class="nf">path</span><span class="p">(</span><span class="s">"/swagger-json"</span><span class="p">)</span>
                    <span class="p">.</span><span class="nf">swagger</span><span class="p">(</span><span class="nc">SwaggerOptions</span><span class="p">(</span><span class="s">"/swagger"</span><span class="p">).</span><span class="nf">title</span><span class="p">(</span><span class="s">"My Swagger Documentation"</span><span class="p">))</span>
                    <span class="p">.</span><span class="nf">reDoc</span><span class="p">(</span><span class="nc">ReDocOptions</span><span class="p">(</span><span class="s">"/redoc"</span><span class="p">).</span><span class="nf">title</span><span class="p">(</span><span class="s">"My ReDoc Documentation"</span><span class="p">))</span>
    <span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Full documentation for the OpenAPI plugin can be found at <a href="/plugins/openapi">/plugins/openapi</a>.</p>

<h3 id="graphql-plugin">GraphQL plugin</h3>
<p>Javalin has an GraphQL plugin. You can see its documentation at <a href="/plugins/graphql">/plugins/graphql</a>.</p>

<h3 id="redirect-to-lowercase-path-plugin">Redirect-to-lowercase-path plugin</h3>

<p>This plugin redirects requests with uppercase/mixcase paths to lowercase paths.
For example, <code class="language-plaintext highlighter-rouge">/Users/John</code> redirects to <code class="language-plaintext highlighter-rouge">/users/John</code> (if endpoint is <code class="language-plaintext highlighter-rouge">/users/:userId</code>).
It does not affect the casing of path-params and query-params, only static
URL fragments (<code class="language-plaintext highlighter-rouge">Users</code> becomes <code class="language-plaintext highlighter-rouge">users</code> above, but <code class="language-plaintext highlighter-rouge">John</code> remains <code class="language-plaintext highlighter-rouge">John</code>).<br />
When using this plugin, you can only add paths with lowercase URL fragments.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Javalin</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">config</span> <span class="o">-&gt;</span>
    <span class="n">config</span><span class="o">.</span><span class="na">registerPlugin</span><span class="o">(</span><span class="k">new</span> <span class="nc">RedirectToLowercasePathPlugin</span><span class="o">());</span>
<span class="o">)</span>
</code></pre></div></div>

<h3 id="rate-limiting">Rate limiting</h3>

<p>There is a very simple rate-limited included in Javalin <code class="language-plaintext highlighter-rouge">3.7.0</code> and newer.
You can call it in the beginning of your endpoint <code class="language-plaintext highlighter-rouge">Handler</code> functions:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"/"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">new</span> <span class="nf">RateLimit</span><span class="o">(</span><span class="n">ctx</span><span class="o">).</span><span class="na">requestPerTimeUnit</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">);</span> <span class="c1">// throws if rate limit is exceeded</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">status</span><span class="o">(</span><span class="s">"Hello, rate-limited World!"</span><span class="o">);</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="nc">RateLimit</span><span class="p">(</span><span class="n">ctx</span><span class="p">).</span><span class="nf">requestPerTimeUnit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="nc">TimeUnit</span><span class="p">.</span><span class="nc">MINUTES</span><span class="p">)</span> <span class="c1">// throws if rate limit is exceeded</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">status</span><span class="p">(</span><span class="s">"Hello, rate-limited World!"</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Every rate limiter is independent (IP and <code class="language-plaintext highlighter-rouge">Handler</code> based), so different endpoints can have different rate limits. It works as follows:</p>

<ul>
  <li>A map of maps holds one IP/counter map per method/path combination (<code class="language-plaintext highlighter-rouge">Handler</code>).</li>
  <li>On each request the counter for that IP is incremented.</li>
  <li>If the counter exceeds the number of requests specified, an exception is thrown.</li>
  <li>All counters are cleared periodically on every timeunit that you specified.</li>
</ul>

<h2 id="modules">Modules</h2>

<p>As of <code class="language-plaintext highlighter-rouge">3.9.0</code>, Javalin is a multi-module project. The current modules (for <code class="language-plaintext highlighter-rouge">5.0.1</code>)  are:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">javalin</code> - the standard Javalin dependency, just as before</li>
  <li><code class="language-plaintext highlighter-rouge">javalin-bundle</code> - <code class="language-plaintext highlighter-rouge">javalin</code>, <code class="language-plaintext highlighter-rouge">javalin-openapi</code>, <code class="language-plaintext highlighter-rouge">jackson</code> and <code class="language-plaintext highlighter-rouge">logback</code></li>
  <li><code class="language-plaintext highlighter-rouge">javalin-openapi</code> - the OpenAPI plugin and all required dependencies</li>
  <li><code class="language-plaintext highlighter-rouge">javalin-graphql</code> - the new GraphQL plugin (thanks to <a href="https://github.com/7agustibm">7agustibm</a>)</li>
  <li><code class="language-plaintext highlighter-rouge">javalin-without-jetty</code> - <code class="language-plaintext highlighter-rouge">javalin</code> with all <code class="language-plaintext highlighter-rouge">jetty</code> dependencies excluded
and Jetty specific methods removed (useful for running on e.g. Tomcat)</li>
</ul>

<h2 id="faq">FAQ</h2>
<p>Frequently asked questions.</p>

<h3 id="android">Android</h3>
<p>To use Javalin in an Android project, you will need to:</p>

<p><em>1: Target the Android SDK 26 and higher:</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>defaultconfig {
  minSdkVersion 26
  targetSdkVersion 28
}
</code></pre></div></div>

<p><em>2: Target Java 8:</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
}
</code></pre></div></div>

<p><em>3: Insert this in your build.gradle file:</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>packagingOptions {
  exclude 'org/eclipse/jetty/http/encoding.properties'
}
</code></pre></div></div>

<p><em>4: Specify <code class="language-plaintext highlighter-rouge">android.enableD8=true</code> in your <code class="language-plaintext highlighter-rouge">gradle.properties</code> file.</em></p>

<hr />

<h3 id="concurrency">Concurrency</h3>

<p>By default, Javalin serves requests using a Jetty <code class="language-plaintext highlighter-rouge">QueuedThreadPool</code> with 250 threads.
Handlers are invoked in parallel on multiple threads, so all handler implementations should be thread-safe.</p>

<p>The default configuration adds a very thin abstraction layer on top of Jetty. It has similar performance to raw
Jetty, which is able to handle
<a href="https://www.techempower.com/benchmarks/#section=data-r20&amp;hw=ph&amp;test=plaintext&amp;l=zik0vz-sf&amp;p=ziimf3-zik0zj-zik0zj-zik0zj-1ekf">over a million plaintext requests per second</a>.</p>

<p>If you have <em>a lot</em> of long running requests, it might be worth looking into <a href="#asynchronous-requests">Asynchronous requests</a>,
or <a href="https://github.com/tipsy/loomylin">setting up Javalin with project Loom</a>.</p>

<p>If you’re not sure if you need async requests, you probably don’t.</p>

<h4 id="websocket-message-ordering">WebSocket Message Ordering</h4>

<p>WebSocket operates over TCP, so messages will arrive at the server in the order that they were sent
by the client. Javalin then handles the messages from a given WebSocket connection sequentially.
Therefore, the order that messages are handled is guaranteed to be the same as the order the client
sent them in.</p>

<p>However, different connections will be handled in parallel on multiple threads, so the WebSocket
event handlers should be thread-safe.</p>

<hr />

<h3 id="testing">Testing</h3>
<p>People often ask how to test Javalin apps. Since Javalin is just a library, you can
instantiate and start the server programmatically. This means testing is really up to you.
There is a tutorial at <a href="/tutorials/testing">/tutorials/testing</a> which goes through
some different types of tests (unit tests, functional/integration tests, ui/end-to-end tests).
You can read it to get some ideas for how to test your app.</p>

<hr />

<h3 id="javadoc">Javadoc</h3>
<p>There is a Javadoc available at <a href="http://javadoc.io/doc/io.javalin/javalin">javadoc.io</a>.
Please contribute to the Javadoc if you can.</p>

<hr />

<h3 id="deploying">Deploying</h3>
<p>To deploy Javalin, simply create a <a href="https://maven.apache.org/plugins/maven-assembly-plugin/usage.html">jar with dependencies</a>,
then launch the jar with <code class="language-plaintext highlighter-rouge">java -jar filename.jar</code>. That’s it.
Javalin has an embedded server, so you don’t need an application server.
There is also a tutorial on <a href="/tutorials/heroku">deploying Javalin to Heroku</a>.</p>

<hr />

<h3 id="other-web-servers">Other web servers</h3>
<div class="comment"><strong>Ctrl+f</strong>: "without jetty", "tomcat", "standalone", "servlet container", "war".</div>

<p>Javalin is primarily meant to be used with the embedded Jetty server, but if you want to run Javalin
on another web server (such as Tomcat), you can use the <code class="language-plaintext highlighter-rouge">Javalin.createStandalone()</code> factory method.</p>

<p>This method will create a Javalin instance, which exposes the <code class="language-plaintext highlighter-rouge">HttpServlet</code> that
Javalin uses to handle HTTP requests (via <code class="language-plaintext highlighter-rouge">app.servlet()</code>). Please note that Javalin’s WebSockets
functionality has a hard dependency on Jetty, and will not work in standalone mode.</p>

<p>Remember to exclude Jetty when setting this up. If you need more instructions, follow the
<a href="https://javalin.io/2018/11/15/javalin-embedded-example.html">tutorial</a>.</p>

<hr />

<h3 id="uploads">Uploads</h3>
<p>Uploaded files are easily accessible via <code class="language-plaintext highlighter-rouge">ctx.uploadedFiles()</code>:</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="o">.</span><span class="na">post</span><span class="o">(</span><span class="s">"/upload"</span><span class="o">,</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">ctx</span><span class="o">.</span><span class="na">uploadedFiles</span><span class="o">(</span><span class="s">"files"</span><span class="o">).</span><span class="na">forEach</span><span class="o">(</span><span class="n">uploadedFile</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="nc">FileUtil</span><span class="o">.</span><span class="na">streamToFile</span><span class="o">(</span><span class="n">uploadedFile</span><span class="o">.</span><span class="na">getContent</span><span class="o">(),</span> <span class="s">"upload/"</span> <span class="o">+</span> <span class="n">uploadedFile</span><span class="o">.</span><span class="na">getFilename</span><span class="o">())</span>
    <span class="o">});</span>
<span class="o">});</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">app</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="s">"/upload"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span>
    <span class="n">ctx</span><span class="p">.</span><span class="nf">uploadedFiles</span><span class="p">(</span><span class="s">"files"</span><span class="p">).</span><span class="nf">forEach</span> <span class="p">{</span> <span class="n">uploadedFile</span> <span class="p">-&gt;</span>
        <span class="nc">FileUtil</span><span class="p">.</span><span class="nf">streamToFile</span><span class="p">(</span><span class="n">uploadedFile</span><span class="p">.</span><span class="n">content</span><span class="p">,</span> <span class="s">"upload/${uploadedFile.filename}"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </div>
</div>

<p>The corresponding HTML might look something like this:</p>
<pre><code class="language-markup">&lt;form method="post" action="/upload" enctype="multipart/form-data"&gt;
    &lt;input type="file" name="files" multiple&gt;
    &lt;button&gt;Submit&lt;/button&gt;
&lt;/form&gt;
</code></pre>

<hr />

<h3 id="asynchronous-requests">Asynchronous requests</h3>
<p>While the default threadpool (200 threads) is enough for most use cases,
sometimes slow operations should be run asynchronously. Luckily it’s very easy in Javalin, just
pass a <code class="language-plaintext highlighter-rouge">CompletableFuture</code> to <code class="language-plaintext highlighter-rouge">ctx.result()</code>:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">io.javalin.Javalin</span>

<span class="k">fun</span> <span class="nf">main</span><span class="p">(</span><span class="n">args</span><span class="p">:</span> <span class="nc">Array</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">app</span> <span class="p">=</span> <span class="nc">Javalin</span><span class="p">.</span><span class="nf">create</span><span class="p">().</span><span class="nf">start</span><span class="p">(</span><span class="mi">7000</span><span class="p">)</span>
    <span class="n">app</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">ctx</span> <span class="p">-&gt;</span> <span class="n">ctx</span><span class="p">.</span><span class="nf">result</span><span class="p">(</span><span class="nf">getFuture</span><span class="p">())</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// hopefully your future is less pointless than this:</span>
<span class="k">private</span> <span class="k">fun</span> <span class="nf">getFuture</span><span class="p">()</span> <span class="p">=</span> <span class="nc">CompletableFuture</span><span class="p">&lt;</span><span class="nc">String</span><span class="p">&gt;().</span><span class="nf">apply</span> <span class="p">{</span>
    <span class="nc">Executors</span><span class="p">.</span><span class="nf">newSingleThreadScheduledExecutor</span><span class="p">().</span><span class="nf">schedule</span><span class="p">({</span> <span class="k">this</span><span class="p">.</span><span class="nf">complete</span><span class="p">(</span><span class="s">"Hello World!"</span><span class="p">)</span> <span class="p">},</span> <span class="mi">1</span><span class="p">,</span> <span class="nc">TimeUnit</span><span class="p">.</span><span class="nc">SECONDS</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="comment">Synonyms for ctrl+f: Async, CompletableFuture, Future, Concurrent, Concurrency</div>

<p>You can only set future results in endpoint handlers (get/post/put/etc).<br />
After-handlers, exception-handlers and error-handlers run like you’d expect them to after
the future has been resolved or rejected.</p>

<h4 id="async-timeout-settings">Async timeout settings</h4>
<p>Jetty has a default timeout of 30 seconds for async requests (this is not related to the <code class="language-plaintext highlighter-rouge">idleTimeout</code> of a connector).
If you wait for processes that run for longer than this, you can configure the async request manually by calling <code class="language-plaintext highlighter-rouge">ctx.req.startAsync()</code>.
For more information, see <a href="https://github.com/tipsy/javalin/issues/448">issue 448</a>.</p>

<hr />

<h3 id="configuring-the-json-mapper">Configuring the JSON mapper</h3>

<p>Note that these are global settings, and can’t be configured per instance of Javalin.</p>

<h4 id="configuring-jackson">Configuring Jackson</h4>
<p>The JSON mapper uses Jackson by default, which can be configured by calling:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinJackson</span><span class="o">.</span><span class="na">configure</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">)</span>
</code></pre></div></div>

<h4 id="using-gson">Using Gson</h4>
<p>Javalin can be configured to use <a href="https://github.com/google/gson">Gson</a> instead of Jackson. In Java:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GsonBuilder</span><span class="o">().</span><span class="na">create</span><span class="o">();</span>
<span class="nc">JavalinJson</span><span class="o">.</span><span class="na">setFromJsonMapper</span><span class="o">(</span><span class="nl">gson:</span><span class="o">:</span><span class="n">fromJson</span><span class="o">);</span>
<span class="nc">JavalinJson</span><span class="o">.</span><span class="na">setToJsonMapper</span><span class="o">(</span><span class="nl">gson:</span><span class="o">:</span><span class="n">toJson</span><span class="o">);</span>
</code></pre></div></div>

<p>In Kotlin:</p>

<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">val</span> <span class="py">gson</span> <span class="p">=</span> <span class="nc">GsonBuilder</span><span class="p">().</span><span class="nf">create</span><span class="p">()</span>

<span class="nc">JavalinJson</span><span class="p">.</span><span class="n">fromJsonMapper</span> <span class="p">=</span> <span class="kd">object</span> <span class="err">: </span><span class="nc">FromJsonMapper</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;</span> <span class="nf">map</span><span class="p">(</span><span class="n">json</span><span class="p">:</span> <span class="nc">String</span><span class="p">,</span> <span class="n">targetClass</span><span class="p">:</span> <span class="nc">Class</span><span class="p">&lt;</span><span class="nc">T</span><span class="p">&gt;)</span> <span class="p">=</span> <span class="n">gson</span><span class="p">.</span><span class="nf">fromJson</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">targetClass</span><span class="p">)</span>
<span class="p">}</span>

<span class="nc">JavalinJson</span><span class="p">.</span><span class="n">toJsonMapper</span> <span class="p">=</span> <span class="kd">object</span> <span class="err">: </span><span class="nc">ToJsonMapper</span> <span class="p">{</span>
    <span class="k">override</span> <span class="k">fun</span> <span class="nf">map</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="nc">Any</span><span class="p">):</span> <span class="nc">String</span> <span class="p">=</span> <span class="n">gson</span><span class="p">.</span><span class="nf">toJson</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h3 id="adding-other-servlets-and-filters-to-javalin">Adding other Servlets and Filters to Javalin</h3>
<p>Javalin is designed to work with other <code class="language-plaintext highlighter-rouge">Servlet</code> and <code class="language-plaintext highlighter-rouge">Filter</code> instances running on the Jetty Server.
Filters are pretty straighforward to add, since they don’t finish the request. If you need to add a serlvet
there’s an example in the repo:
<a href="https://github.com/tipsy/javalin/blob/master/javalin/src/test/java/io/javalin/examples/HelloWorldServlet.java#L21-L29">/src/test/java/io/javalin/examples/HelloWorldServlet.java#L21-L29</a></p>

<hr />

<h3 id="views-and-templates">Views and Templates</h3>
<p>Javalin looks for templates/markdown files in <code class="language-plaintext highlighter-rouge">src/resources</code>,
and uses the correct rendering engine based on the extension of your template.
Javalin currently supports six template engines (see below), as well as markdown.
You can also register your own rendering engine.</p>

<div class="multitab-code" data-tab="1">
<ul>
    <li data-tab="1">Java</li>
    <li data-tab="2">Kotlin</li>
</ul>
<div data-tab="1">
    <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="s">"/templateFile.ext"</span><span class="o">,</span> <span class="n">model</span><span class="o">(</span><span class="s">"firstName"</span><span class="o">,</span> <span class="s">"John"</span><span class="o">,</span> <span class="s">"lastName"</span><span class="o">,</span> <span class="s">"Doe"</span><span class="o">))</span>
</code></pre></div>    </div>
  </div>
<div data-tab="2">
    <div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ctx</span><span class="p">.</span><span class="nf">render</span><span class="p">(</span><span class="s">"/templateFile.ext"</span><span class="p">,</span> <span class="nf">mapOf</span><span class="p">(</span><span class="s">"firstName"</span> <span class="n">to</span> <span class="s">"John"</span><span class="p">,</span> <span class="s">"lastName"</span> <span class="n">to</span> <span class="s">"Doe"</span><span class="p">))</span>
</code></pre></div>    </div>
  </div>
</div>

<p>Register:</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinRenderer</span><span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="nc">JavalinPebble</span><span class="o">.</span><span class="na">INSTANCE</span><span class="o">,</span> <span class="s">".peb"</span><span class="o">,</span> <span class="s">".pebble"</span><span class="o">);</span>

<span class="nc">JavalinRenderer</span><span class="o">.</span><span class="na">register</span><span class="o">((</span><span class="n">filePath</span><span class="o">,</span> <span class="n">model</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">return</span> <span class="nc">MyRenderer</span><span class="o">.</span><span class="na">render</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
<span class="o">},</span> <span class="s">".ext"</span><span class="o">);</span>
</code></pre></div></div>

<p>Configure:</p>
<div class="language-kotlin highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinThymeleaf</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">templateEngine</span><span class="p">)</span>
<span class="nc">JavalinVelocity</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">velocityEngine</span><span class="p">)</span>
<span class="nc">JavalinFreemarker</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
<span class="nc">JavalinMustache</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">mustacheFactory</span><span class="p">)</span>
<span class="nc">JavalinJtwig</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
<span class="nc">JavalinPebble</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">configuration</span><span class="p">)</span>
<span class="nc">JavalinCommonmark</span><span class="p">.</span><span class="nf">configure</span><span class="p">(</span><span class="n">htmlRenderer</span><span class="p">,</span> <span class="n">markdownParser</span><span class="p">)</span>
</code></pre></div></div>
<p>Note that these are global settings, and can’t be configured per instance of Javalin.</p>

<hr />

<h3 id="vue-support-javalinvue">Vue support (JavalinVue)</h3>
<p>If you don’t want to deal with NPM and frontend builds, Javalin has support for simplified Vue.js development.
This requires you to make a layout template, <code class="language-plaintext highlighter-rouge">src/main/resources/vue/layout.html</code>:</p>

<pre><code class="language-markup">&lt;head&gt;
    &lt;script src="/webjars/vue/2.6.10/dist/vue.min.js"&gt;&lt;/script&gt;
    @componentRegistration
&lt;/head&gt;
&lt;body&gt;
&lt;main id="main-vue" v-cloak&gt;
    @routeComponent
&lt;/main&gt;
&lt;script&gt;
    new Vue({el: "#main-vue"});
&lt;/script&gt;
&lt;/body&gt;
</code></pre>

<p>When you put <code class="language-plaintext highlighter-rouge">.vue</code> files in <code class="language-plaintext highlighter-rouge">src/main/resources/vue</code>, Javalin will scan
the folder and register the components in your <code class="language-plaintext highlighter-rouge">&lt;head&gt;</code> tag.</p>

<p>Javalin will also put path-parameters and query-parameters in the Vue instance,
which you can access:</p>

<pre><code class="language-markup">&lt;template id="thread-view"&gt;
    &lt;div&gt;{{ $javalin.pathParams["user"] }}&lt;/div&gt;
&lt;/template&gt;
&lt;script&gt;
    Vue.component("thread-view", {
        template: "#thread-view"
    });
&lt;/script&gt;
</code></pre>

<p>To map a path to a Vue component you use the <code class="language-plaintext highlighter-rouge">VueComponent</code> class:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">get</span><span class="o">(</span><span class="s">"/messages"</span><span class="o">,</span> <span class="nc">VueComponent</span><span class="o">(</span><span class="s">"inbox-view"</span><span class="o">))</span>
<span class="n">get</span><span class="o">(</span><span class="s">"/messages/:user"</span><span class="o">,</span> <span class="nc">VueComponent</span><span class="o">(</span><span class="s">"thread-view"</span><span class="o">))</span>
</code></pre></div></div>

<p>This will give you a lot of the benefits of a modern frontend architecture,
with very few of the downsides.</p>

<p>There’s a tutorial explaining the concepts: <a href="/tutorials/simple-frontends-with-javalin-and-vue">/tutorials/simple-frontends-with-javalin-and-vue</a></p>

<h4 id="shared-state">Shared state</h4>
<p>If you want to share state from your server with Vue, you can provide <code class="language-plaintext highlighter-rouge">JavalinVue</code> with a state function:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">stateFunction</span> <span class="o">=</span> <span class="o">{</span> <span class="n">ctx</span> <span class="o">-&gt;</span> <span class="n">mapOf</span><span class="o">(</span><span class="s">"user"</span> <span class="n">to</span> <span class="nf">getUser</span><span class="o">(</span><span class="n">ctx</span><span class="o">))</span> <span class="o">}</span>
</code></pre></div></div>

<p>This can then be accessed from the <code class="language-plaintext highlighter-rouge">state</code> variable:</p>

<pre><code class="language-markup">&lt;template id="user-template"&gt;
    &lt;div&gt;{{ $javalin.state.user }}&lt;/div&gt;
&lt;/template&gt;
</code></pre>

<p>The function runs for every request, so the state is always up to
date when the user navigates or refreshes the page.</p>

<h4 id="inline-files">Inline files</h4>
<p>You can inline files into your layout template by using the following functions:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;style&gt;</span><span class="k">@inlineFile</span><span class="p">(</span><span class="s1">"/vue/styles.css"</span><span class="p">)</span><span class="nt">&lt;/style&gt;</span> <span class="c">&lt;!-- always included --&gt;</span>
    <span class="nt">&lt;script&gt;</span><span class="p">@</span><span class="nd">inlineFileDev</span><span class="p">(</span><span class="dl">"</span><span class="s2">/vue/scripts-dev.js</span><span class="dl">"</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span> <span class="c">&lt;!-- only included in dev --&gt;</span>
    <span class="nt">&lt;script&gt;</span><span class="p">@</span><span class="nd">inlineFileNotDev</span><span class="p">(</span><span class="dl">"</span><span class="s2">/vue/scripts-not-dev.js</span><span class="dl">"</span><span class="p">)</span><span class="nt">&lt;/script&gt;</span> <span class="c">&lt;!-- only included in not dev --&gt;</span>
<span class="nt">&lt;/head&gt;</span>
</code></pre></div></div>

<h4 id="cdn-webjars">CDN WebJars</h4>
<p>You can reference your WebJars with <code class="language-plaintext highlighter-rouge">@cdnWebjar/</code> instead of the normal <code class="language-plaintext highlighter-rouge">/webjars/</code>.
If you do this, the path will resolve to <code class="language-plaintext highlighter-rouge">/webjars/</code> on when <code class="language-plaintext highlighter-rouge">isDevFunction</code> returns true, and <code class="language-plaintext highlighter-rouge">https//cdn.jsdelivr.net/.../</code>
on non-localhost. <strong>Note that this only works with NPM webjars.</strong></p>

<h4 id="vue-directory-location">Vue directory location</h4>

<p>By default, JavalinVue will set the vue root directory based on the first request it serves.</p>

<ul>
  <li>On localhost, the root dir will be set to the <code class="language-plaintext highlighter-rouge">src/main/resources/vue</code> (external location)</li>
  <li>On non-localhost, the root dir will be set to <code class="language-plaintext highlighter-rouge">/vue</code> (classpath location)</li>
</ul>

<p>This can cause issues when running a jar locally or in docker. You can override the default dir:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">path</span><span class="o">,</span> <span class="n">location</span><span class="o">);</span> <span class="c1">// String path, String location</span>
<span class="nc">JavalinVue</span><span class="o">.</span><span class="na">rootDirectory</span><span class="o">(</span><span class="n">path</span><span class="o">);</span> <span class="c1">// java.nio.Path path</span>
</code></pre></div></div>

<h4 id="isdevfunction">isDevFunction</h4>
<p>You can override the <code class="language-plaintext highlighter-rouge">JavalinVue.isDevFunction</code> to let <code class="language-plaintext highlighter-rouge">JavalinVue</code> know if the environment is develop or not.
This is used to disable caching on dev to speed up development. The default function returns true if the request is on localhost.</p>

<h4 id="optimize-dependencies">Optimize dependencies</h4>
<p>If you set <code class="language-plaintext highlighter-rouge">JavalinVue.optimizeDependencies</code> to true, <code class="language-plaintext highlighter-rouge">JavalinVue</code> will only load the required dependencies for your route component.
This is set to false by default.</p>

<hr />

<h3 id="timeoutexceptions-and-closedchannelexceptions">TimeoutExceptions and ClosedChannelExceptions</h3>
<p>If you encounter <code class="language-plaintext highlighter-rouge">TimeoutExceptions</code> and <code class="language-plaintext highlighter-rouge">ClosedChannelExceptions</code> in your DEBUG logs,
this is nothing to worry about. Typically, a browser will keep the HTTP connection open until the
server terminates it. When this happens is decided by the server’s <code class="language-plaintext highlighter-rouge">idleTimeout</code> setting,
which is 30 seconds by default in Jetty/Javalin. This is not a bug.</p>

<h3 id="documentation-for-previous-versions">Documentation for previous versions</h3>
<p>Docs for 2.8.0 (last 2.X version) can be found <a href="/archive/docs/v2.8.0.html">here</a>.<br />
Docs for 1.7.0 (last 1.X version) can be found <a href="/archive/docs/v1.7.0.html">here</a>.</p>

        <script src="/js/anchor.min.js"></script>
        <script>
            anchors.options.placement = 'left';
            anchors.add();
        </script>

    </main>
    <footer>
        Javalin is a Java and Kotlin web framework, open sourced under the
        <a href="https://tldrlegal.com/license/apache-license-2.0-(apache-2.0)">Apache 2</a> license
        | <a href="/download">Download</a>
        | <a href="/about">About</a>
        | <a href="/news">News</a>
        | <a href="/about#contact">Contact</a>
        | <a href="/for-educators">For educators</a>
    </footer>
    <div id="star-begging">
    <style>
        #star-begging {
            transition: transform .25s;
            transform: scale(0);
            border-radius: 8px;
            position: fixed;
            bottom: 32px;
            right: 32px;
            padding: 20px 40px 16px 20px;
            background: #fff;
            box-shadow: 0 1px 20px rgba(0, 0, 0, 0.15);
            z-index: 9999998;
        }
        #star-begging.in {
            transform: scale(1);
        }
        #star-begging.out {
            transform: translateX(400px);
        }
        #star-begging p {
            font-size: 16px;
            margin: 0 0 15px;
        }
        #star-begging .close {
            position: absolute;
            right: 20px;
            top: 20px;
            height: 40px;
            width: 40px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-family: arial, sans-serif;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 5px;
        }
    </style>
    <p>
        Like Javalin?
        <br>Star us 😊
    </p>
    <span class="close">×</span>
    <iframe id="starFrame" class="githubStar" title="github-stars"
            src="https://ghbtns.com/github-btn.html?user=javalin&amp;repo=javalin&amp;type=star&amp;count=true&size=large"
            frameborder="0" scrolling="0" width="150px" height="30px">
    </iframe>
    <script>
        if (localStorage.getItem("dismissed") !== "true" && document.getElementById("notification-banner") === null) {
            setTimeout(function () {
                document.querySelector("#star-begging").classList.add("in");
            }, 15000);
            document.querySelector("#star-begging .close").addEventListener("click", function () {
                document.querySelector("#star-begging").classList.add("out");
                localStorage.setItem("dismissed", "true");
            });
        }
    </script>
</div>

    <script src="/js/scripts.js"></script>
</body>
</html>
